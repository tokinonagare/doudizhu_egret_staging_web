var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),__awaiter=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function s(e){try{d(a.next(e))}catch(t){o(t)}}function i(e){try{d(a["throw"](e))}catch(t){o(t)}}function d(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,i)}d((a=a.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return a([e,t])}}function a(n){if(r)throw new TypeError("Generator is already executing.");for(;d;)try{if(r=1,o&&(s=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return d.label++,{value:n[1],done:!1};case 5:d.label++,o=n[1],n=[0];continue;case 7:n=d.ops.pop(),d.trys.pop();continue;default:if(s=d.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){d=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){d.label=n[1];break}if(6===n[0]&&d.label<s[1]){d.label=s[1],s=n;break}if(s&&d.label<s[2]){d.label=s[2],d.ops.push(n);break}s[2]&&d.ops.pop(),d.trys.pop();continue}n=t.call(e,d)}catch(a){n=[6,a],o=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,o,s,i,d={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i},DDZBaseComponent=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(eui.Component);__reflect(DDZBaseComponent.prototype,"DDZBaseComponent");var DDZGameServiceMessageBaseData=function(){function e(e){this.action=e.action,e.room&&(this.roomId=e.room.id)}return e}();__reflect(DDZGameServiceMessageBaseData.prototype,"DDZGameServiceMessageBaseData");var DDZPlayCardSet=function(){function e(e){this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND,this.singles=[],this.pairs=[],this.trioes=[],this.bombs=[],this.attachedBombs=[],this.cards=e}return e.prototype.reset=function(){this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND},e.prototype.isEmpty=function(){return 1===this.cardTypeName},e.prototype.isBomb=function(){return 14===this.cardTypeName},e.prototype.isHuoJian=function(){return 15===this.cardTypeName},e.prototype.isFourTakes=function(){return 12===this.cardTypeName||13===this.cardTypeName?!0:!1},e.prototype.canBeBiggerConsetutive=function(e,t,n){return t.value-e.value===n-1&&this.value<e.value},e.prototype.isLegal=function(){return 0!==this.cardTypeName&&1!==this.cardTypeName},e.prototype.isTypeEqualTo=function(e){return e?this.cardTypeName===e.cardTypeName&&this.countCards()===e.countCards():!1},e.prototype.setPlayerId=function(e){this.playerId=e},e.prototype.countCards=function(){return this.cards.length},e.prototype.isBiggerThan=function(e){if(!e)throw new Error("用于比较的cardSet不能为空");return this.isHuoJian()?!0:e.isHuoJian()?!1:this.isTypeEqualTo(e)?this.value>e.value:this.isBomb()?!0:e.isBomb()?!1:!1},e.prototype.isEqualTo=function(e){if(!e)throw new Error("用于比较的cardSet不能为空");return this.isTypeEqualTo(e)&&this.value===e.value?!0:!1},e.prototype.listBiggerLegalCardSet=function(e){throw new Error("需要子类重写实现此方法")},e.prototype.getSoundEffectName=function(){throw new Error("需要子类重写此方法获取音效名字")},e.prototype.classifyCards=function(e){this.cleanCards();for(var t=0,n=Object.keys(e);t<n.length;t++){var a=n[t],r=e[a];r.isSingle()?this.singles.push(r):r.isPair()?this.pairs.push(r):r.isTrio()?this.trioes.push(r):r.isBomb()&&this.bombs.push(r)}},e.prototype.cleanCards=function(){this.singles=[],this.pairs=[],this.trioes=[],this.bombs=[],this.attachedBombs=[]},e}();__reflect(DDZPlayCardSet.prototype,"DDZPlayCardSet");var DDZBaseCardView=function(e){function t(){var t=e.call(this)||this;return t.skinName="",t}return __extends(t,e),t.prototype.setImage=function(e){this.image.source=e},t.prototype.dataChanged=function(){this.setImage(this.data.getImageName())},t}(eui.ItemRenderer);__reflect(DDZBaseCardView.prototype,"DDZBaseCardView");var QPLayer=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onEnter=function(){for(var e=this.numChildren,n=0;e>n;n+=1){var a=this.getChildAt(n);a instanceof t&&a.onEnter()}},t.prototype.onExit=function(){for(var e=this.numChildren,n=0;e>n;n+=1){var a=this.getChildAt(n);a instanceof t&&a.onExit()}},t}(DDZBaseComponent);__reflect(QPLayer.prototype,"QPLayer");var DDZBaseButtons=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setVisible=function(e){this.visible=e},t}(QPLayer);__reflect(DDZBaseButtons.prototype,"DDZBaseButtons");var QPNetworkApi=function(){function e(){}return e.prototype.fetchJson=function(e,t,n){var a=this,r=new egret.HttpRequest;r.responseType=egret.HttpResponseType.TEXT,r.open(e.url,egret.HttpMethod.GET),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("Access-Control-Allow-Origin","*");for(var o=0,s=Object.keys(e.header);o<s.length;o++){var i=s[o];r.setRequestHeader(i,e.header[i])}r.send(),r.addEventListener(egret.Event.COMPLETE,function(e){var r=e.currentTarget.response;if(!r)return void n(new QPNetworkError({message:"HTTP GET response is null"}));var o=JSON.parse(r);o.ok?t(o.result):n(a.getResponseError(o))},this),r.addEventListener(egret.IOErrorEvent.IO_ERROR,function(e){n(new QPNetworkError({message:"无法连接到服务器"}))},this)},e.prototype.postReturnJson=function(e,t,n){var a=this,r=e.url+this.buildParams(e.parameters),o=new egret.HttpRequest;o.responseType=egret.HttpResponseType.TEXT,o.open(r,egret.HttpMethod.POST);for(var s=0,i=Object.keys(e.header);s<i.length;s++){var d=i[s];o.setRequestHeader(d,e.header[d])}if(o.addEventListener(egret.Event.COMPLETE,function(e){var r=e.currentTarget.response;if(!r)return void n(new QPNetworkError({message:"HTTP POST response is null"}));var o=JSON.parse(r);o.ok?t(o.result):n(a.getResponseError(o))},this),o.addEventListener(egret.IOErrorEvent.IO_ERROR,function(e){n(new QPNetworkError({message:"无法连接到服务器"}))},this),e.body){var l=this.buildBody(e.body);o.send(l)}else o.send()},e.prototype.headerWithoutAuthorization=function(){return{Accept:"application/json","Access-Control-Allow-Origin":"*","Content-Type":"application/json"}},e.prototype.headerWithAuthorization=function(){var e=this.headerWithoutAuthorization();return e.Authorization="Bearer "+UserModel.sharedInstance().attributeModel.getAccessToken(),e},e.prototype.getResponseError=function(e){if(e.errors){if(e.errors.length<=0)return new QPNetworkError({message:"服务器请求错误返回格式不对。"});var t=e.errors[0],n=t.message;return t.field&&(n=n+" ("+t.field+")"),new QPNetworkError({message:n,error_type:e.errors[0].error_type})}return new QPNetworkError({message:e.message,error_type:e.error_type})},e.prototype.buildParams=function(e){if(!e)return"";var t="?";for(var n in e)n&&(t=t+n+"="+e[n]+"&");return t=t.slice(0,-1)},e.prototype.buildBody=function(e){return JSON.stringify(e)},e}();__reflect(QPNetworkApi.prototype,"QPNetworkApi");var BaseUserAttributeModel=function(){function e(){}return e.prototype.setId=function(e){this.id=e},e.prototype.getDisplayId=function(){return this.serviceId},e.prototype.setBalanceAmount=function(e){this.balanceAmount=e},e.prototype.getBalanceAmount=function(){return this.balanceAmount},e.prototype.deleteAccount=function(){this.id=void 0},e.prototype.setHasSignUp=function(e){this.hasSignUp=e},e.prototype.getHasSignUp=function(){return this.hasSignUp},e.prototype.setHasBindPhoneNumber=function(e){this.hasBindPhoneNumber=e},e.prototype.getHasBindPhoneNumber=function(){return this.hasBindPhoneNumber},e.prototype.setAccessToken=function(e){this.accessToken=e},e.prototype.getAccessToken=function(){return this.accessToken},e.prototype.setChannel=function(e){this.channel=e},e.prototype.getChannel=function(){return this.channel},e.prototype.setTimestamp=function(e){this.timestamp=e},e.prototype.getTimestamp=function(){return this.timestamp},e.prototype.setInfo=function(e){this.info=e},e.prototype.getInfo=function(){return this.info},e.prototype.setToken=function(e){this.token=e},e.prototype.getToken=function(){return this.token},e.prototype.setHashDigest=function(e){this.hashDigest=e},e.prototype.getHashDigest=function(){return this.hashDigest},e.prototype.setExpireISOTime=function(e){this.expireISOTime=e},e.prototype.getExpireISOTime=function(){return this.expireISOTime},e.prototype.setIsAnonymous=function(e){this.isAnonymous=e},e.prototype.getIsAnonymous=function(){return this.isAnonymous},e.prototype.cleanCommunicationAttribute=function(){this.accessToken=void 0,this.channel=void 0,this.timestamp=void 0,this.info=void 0,this.token=void 0,this.hashDigest=void 0,this.expireISOTime=void 0},e}();__reflect(BaseUserAttributeModel.prototype,"BaseUserAttributeModel",["IUserAttribute","IUserCacheAttribute","ICommunicationAttribute"]);var BLACK_JOKER_CODE="bw",RED_JOKER_CODE="rw",DDZCard=function(){function e(e){this.shouldShowLandlordTag=!1,this.isLastOne=!1,this.code=e,this.setImageNameByCode(e),this.decode(e),this.calculateIndex(),this.isSelect=!1}return e.prototype.showLandlordTag=function(e){this.shouldShowLandlordTag=e},e.prototype.getImageName=function(){return this.imageName},e.prototype.isValueEqualTo=function(e){return this.value===e.value},e.prototype.isExactlySameTo=function(e){return this.index===e.index},e.prototype.setImageNameByCode=function(e){this.imageName="poker_"+e+"@2x_png"},e.prototype.calculateIndex=function(){var e=4*(this.value-3);1===this.suit?e+=3:2===this.suit?e+=2:3===this.suit?e+=1:4===this.suit&&(e+=0),this.code===BLACK_JOKER_CODE?e=52:this.code===RED_JOKER_CODE&&(e=53),this.index=e},e.prototype.decode=function(e){if(e===BLACK_JOKER_CODE)return void(this.value=16);if(e===RED_JOKER_CODE)return void(this.value=17);var t=e.charAt(0),n=e.slice(-1);this.decodeSuit(n),this.decodeValue(t)},e.prototype.decodeValue=function(e){switch(e){case"3":this.value=3;break;case"4":this.value=4;break;case"5":this.value=5;break;case"6":this.value=6;break;case"7":this.value=7;break;case"8":this.value=8;break;case"9":this.value=9;break;case"t":this.value=10;break;case"j":this.value=11;break;case"q":this.value=12;break;case"k":this.value=13;break;case"a":this.value=14;break;case"2":this.value=15;break;default:this.value=18}},e.prototype.decodeSuit=function(e){switch(e){case"s":this.suit=1;break;case"h":this.suit=2;break;case"c":this.suit=3;break;case"d":this.suit=4;break;default:this.suit=0}},e}();__reflect(DDZCard.prototype,"DDZCard");var DDZPlayCardFourTakes=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.findBiggerBombCards=function(e){this.classifyCards(e);var t=this.bombs.length;if(0===t)return[];if(1===t){var n=this.bombs[0];return n.value<this.value?[]:n.cards}for(var a,r=0;t>r;r+=1){var n=this.bombs[r];this.lastFoundIndex===DDZConstant.INDEX_NOT_FOUND&&this.value<n.value?(this.lastFoundIndex=r,a=n):!a&&this.lastFoundIndex<r&&this.value<n.value?(this.lastFoundIndex=r,this.lastFoundIndex===t-1&&(this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND),a=n):this.attachedBombs.push(n)}return a?a.cards:[]},t}(DDZPlayCardSet);__reflect(DDZPlayCardFourTakes.prototype,"DDZPlayCardFourTakes");var DDZBaseWarehouse=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this),DDZEventCenter.sharedInstance().addEventListener(DDZDataEvent.UPDATE,this.setBalance,this)},t.prototype.onExit=function(){e.prototype.onExit.call(this),DDZEventCenter.sharedInstance().removeEventListener(DDZDataEvent.UPDATE,this.setBalance,this)},t.prototype.setAmount=function(e){this.amountLabel.text=String(e)},t.prototype.hideAddImage=function(){this.addImage.visible=!1},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressAddButton,this)},t.prototype.setBalance=function(){this.setAmount(UserModel.sharedInstance().attributeModel.getBalanceAmount())},t.prototype.onPressAddButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressAddButtonHandler&&this.pressAddButtonHandler()},t}(QPLayer);__reflect(DDZBaseWarehouse.prototype,"DDZBaseWarehouse");var DDZPlayCardTrioTakes=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.findBiggerTrioCards=function(e){this.classifyCards(e);var t=this.trioes.concat(this.bombs).sort(function(e,t){return e.value-t.value}),n=t.length;if(1===n){var a=t[0];return a.value<this.value?[]:[a.cards[0],a.cards[1],a.cards[2]]}for(var r=0;n>r;r+=1){var a=t[r];if(this.lastFoundIndex===DDZConstant.INDEX_NOT_FOUND&&this.value<a.value)return this.lastFoundIndex=r,[a.cards[0],a.cards[1],a.cards[2]];if(this.lastFoundIndex<r&&this.value<a.value)return this.lastFoundIndex=r,r===n-1&&(this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND),[a.cards[0],a.cards[1],a.cards[2]]}if(this.lastFoundIndex!==DDZConstant.INDEX_NOT_FOUND){var a=t[this.lastFoundIndex];return[a.cards[0],a.cards[1],a.cards[2]]}return[]},t}(DDZPlayCardSet);__reflect(DDZPlayCardTrioTakes.prototype,"DDZPlayCardTrioTakes");var DDZBaseProgressBar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setProgress=function(e,t){this.value=Math.floor(e/t*100),this.finishedAmountLabel.text=String(e),this.totalAmountLabel.text=String(t)},t}(eui.ProgressBar);__reflect(DDZBaseProgressBar.prototype,"DDZBaseProgressBar");var DDZCardListView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZCardListUI",t}return __extends(t,e),t.prototype.setAnimation=function(e){this.animation=e},t.prototype.playAnimation=function(){this.animation.play()},t.prototype.setCards=function(e){this.cardList.dataProvider=new eui.ArrayCollection(e),this.width=e.length<=14?65+25*(e.length-1):400},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.setupCardList()},t.prototype.setupCardList=function(){this.cardList.itemRenderer=DDZCardView,this.cardList.allowMultipleSelection=!0,this.height=177},t}(QPLayer);__reflect(DDZCardListView.prototype,"DDZCardListView");var DDZPlayCardAirplaneTakes=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.findBiggerAirplaneCards=function(e,t){this.classifyCards(e);var n=this.trioes.concat(this.bombs).sort(function(e,t){return e.value-t.value}),a=n.length;if(t>a)return[];for(var r=0;a>r;r+=1){var o=r+t-1;if(o>a-1)return[];var s=n[o];if(15<=s.value)return[];var i=n[r];if(this.canBeBiggerConsetutive(i,s,t)){if(this.lastFoundIndex!==DDZConstant.INDEX_NOT_FOUND&&r<=this.lastFoundIndex)continue;if(this.lastFoundIndex=r,a-1>o){var d=n[o+1];(d.value-s.value!==1||15<=d.value)&&(this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND)}else o===a-1&&(this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND);for(var l=n.slice(r,o+1),c=[],u=0,h=l;u<h.length;u++){var p=h[u];c=c.concat([p.cards[0],p.cards[1],p.cards[2]])}return c}}if(this.lastFoundIndex!==DDZConstant.INDEX_NOT_FOUND){var y=this.lastFoundIndex,i=n[y],f=this.lastFoundIndex+t-1,s=n[f];if(f>=a)return[];if(15<=s.value)return[];if(s.value-i.value!==t-1)return[];for(var g=n.slice(y,f+1),c=[],m=0,D=g;m<D.length;m++){var v=D[m];c=c.concat([v.cards[0],v.cards[1],v.cards[2]])}return c}return[]},t}(DDZPlayCardSet);__reflect(DDZPlayCardAirplaneTakes.prototype,"DDZPlayCardAirplaneTakes");var DDZCardView=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.landlordSignImage.visible=!1},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.data.isLastOne&&(this.landlordSignImage.visible=this.data.shouldShowLandlordTag)},t}(DDZBaseCardView);__reflect(DDZCardView.prototype,"DDZCardView");var DDZPlayerGameInfoBaseView=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.showActiveSign=function(){this.playerStateView.hideAllState()},t.prototype.hideActiveSign=function(){this.playerStateView.hideAllState()},t.prototype.setRemainCardsCount=function(e){this.remainCardView.visible=!0,this.remainCardView.setAmount(e)},t.prototype.showWarningLightView=function(){this.warningLightView.show()},t.prototype.hideWarningLightView=function(){this.warningLightView.hide()},t.prototype.reset=function(){this.hideWarningLightView(),this.playerStateView.hideAllState()},t.prototype.hideRemainCardsView=function(){this.remainCardView.visible=!1},t.prototype.setCallLandlordPoint=function(e){1===e?this.playerStateView.setState(1):2===e?this.playerStateView.setState(2):3===e&&this.playerStateView.setState(3)},t.prototype.showNotPlayCard=function(){this.playerStateView.setState(8)},t.prototype.showNotCallLandlord=function(){this.playerStateView.setState(4)},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.remainCardView.visible=!1},t}(QPLayer);__reflect(DDZPlayerGameInfoBaseView.prototype,"DDZPlayerGameInfoBaseView");var DDZAppleIAPModel=function(){function e(){}return e.sharedInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.purchaseDiamondByProductId=function(e,t,n){egret.ExternalInterface.addCallback("transaction",function(e){var a=JSON.parse(e);if("failed"===a.type){var r=new Error(a.message);return void n(r)}var o;"purchasing"===a.type?o=new DDZIAPResponse({message:a.message,type:DDZIAPResponseType.Purchasing}):"complete"===a.type&&(o=new DDZIAPResponse({message:a.message,type:DDZIAPResponseType.PurchasedSuccessfully,receipt:a.receipt})),t(o)}),egret.ExternalInterface.call("transaction",e)},e.PRODUCT_10_DIAMONDS_ID="org.egret.doudizhu_ios.10diamonds",e.PRODUCT_20_DIAMONDS_ID="org.egret.doudizhu_ios.20diamonds",e.PRODUCT_30_DIAMONDS_ID="org.egret.doudizhu_ios.30diamonds",e.PRODUCT_40_DIAMONDS_ID="org.egret.doudizhu_ios.40diamonds",e.PRODUCT_50_DIAMONDS_ID="org.egret.doudizhu_ios.50diamonds",e}();__reflect(DDZAppleIAPModel.prototype,"DDZAppleIAPModel");var DDZStoreGoodView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZStoreGoodUI",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.purchaseButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPurchaseButtonPressed,this)},t.prototype.dataChanged=function(){this.goodsImage.source=this.data.image,this.quantityLabel.text=String(this.data.quantity)},t.prototype.onPurchaseButtonPressed=function(){egret.log("子类实现")},t}(eui.ItemRenderer);__reflect(DDZStoreGoodView.prototype,"DDZStoreGoodView");var QPTestCase=function(){function e(e){this.name=e}return e.prototype.startTest=function(){throw new Error("需要子类实现")},e.prototype.assertEquals=function(e,t,n){return t===n?void this.testSuccessLog(e):void egret.log("❌ "+e+": expectValue "+t+" not equals to subject "+n)},e.prototype.assert=function(e,t){return t?void this.testSuccessLog(e):void egret.log("❌ "+e)},e.prototype.testSuccessLog=function(e){egret.log("✅  SUCCESS : "+e)},e}();__reflect(QPTestCase.prototype,"QPTestCase");var DDZGameServiceMessageStartGameData=function(e){function t(t){var n=e.call(this,t)||this;return n.playerIds=[],n.playerIds=t.player_ids,n.startedAt=t.started_at,n.gameMatchId=t.game_match_id,n.initLandlord=t.init_landlord,n}return __extends(t,e),t}(DDZGameServiceMessageBaseData);__reflect(DDZGameServiceMessageStartGameData.prototype,"DDZGameServiceMessageStartGameData");var HttpActionData=function(){function e(e){this.body={application:"doudizhu"},this.validate(e)}return e.prototype.validate=function(e){throw new Error("需要子类实现")},e}();__reflect(HttpActionData.prototype,"HttpActionData",["IHttpActionData"]);var QPPopupLayer=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(QPLayer);__reflect(QPPopupLayer.prototype,"QPPopupLayer");var QPScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onEnter=function(){for(var e=this.numChildren,t=0;e>t;t+=1){var n=this.getChildAt(t);n instanceof QPLayer&&n.onEnter()}this.addRealtimeConnetListeners()},t.prototype.onExit=function(){for(var e=this.numChildren,t=0;e>t;t+=1){var n=this.getChildAt(t);n instanceof QPLayer&&n.onExit()}this.hideLostRealtimeServiceConnetInfo(),this.removeRealtimeConnetListeners()},t.prototype.addRealtimeConnetListeners=function(){DDZEventCenter.sharedInstance().addEventListener(DDZNetworkEvent.CONNECT_TO_SERVER_EVENT,this.hideLostRealtimeServiceConnetInfo,this),DDZEventCenter.sharedInstance().addEventListener(DDZNetworkEvent.DISCONNECT_SERVER_EVENT,this.showLostRealtimeServiceConnectInfo,this)},t.prototype.removeRealtimeConnetListeners=function(){DDZEventCenter.sharedInstance().removeEventListener(DDZNetworkEvent.CONNECT_TO_SERVER_EVENT,this.hideLostRealtimeServiceConnetInfo,this),DDZEventCenter.sharedInstance().removeEventListener(DDZNetworkEvent.DISCONNECT_SERVER_EVENT,this.showLostRealtimeServiceConnectInfo,this)},t.prototype.hideLostRealtimeServiceConnetInfo=function(){this.loadingScene&&(this.loadingScene.hide(),this.loadingScene=void 0)},t.prototype.showLostRealtimeServiceConnectInfo=function(){this.loadingScene||(this.loadingScene=new QPLoadingScene),this.loadingScene.show("网络连接不稳定，正在努力重连中...")},t}(DDZBaseComponent);__reflect(QPScene.prototype,"QPScene");var DDZUserCoinInfoView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZUserCoinInfoUI",t}return __extends(t,e),t.prototype.setCoin=function(e){this.coinLabel.text=String(e)},t}(QPLayer);__reflect(DDZUserCoinInfoView.prototype,"DDZUserCoinInfoView");var DDZUserDiamondInfoView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZUserDiamondInfoUI",t}return __extends(t,e),t.prototype.setDiamond=function(e){this.diamondLabel.text=e},t}(QPLayer);__reflect(DDZUserDiamondInfoView.prototype,"DDZUserDiamondInfoView");var DDZEntryScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZEntrySceneUI",t.signInButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressSignInButton,t),t.registerButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressRegisterButton,t),t.initUserModel(),t}return __extends(t,e),t.prototype.initUserModel=function(){UserModel.sharedInstance().setInputtedAttributeModel(new InputtedAttributeModel),UserModel.sharedInstance().setActionDataFactory(new PhoneUserActionDataFactory),UserModel.sharedInstance().setAttributeModel(new PhoneUserAttributeModel),UserModel.sharedInstance().setPersonalRoomModel(new PersonalRoomModel)},t.prototype.onPressSignInButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().pushScene(new SignInScene)},t.prototype.onPressRegisterButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().pushScene(new NicknameScene)},t}(QPScene);__reflect(DDZEntryScene.prototype,"DDZEntryScene");var DDZButtonEvent=function(e){function t(t,n,a){return void 0===n&&(n=!1),void 0===a&&(a=!1),e.call(this,t,n,a)||this}return __extends(t,e),t.ENABLE_PLAY_CARD_BUTTON="event.enable.play.card.button",t.DISABLE_PLAY_CARD_BUTTON="event.disable.play.card.button",t.NOT_CALL_LANDLORD="event.press.not.call.landlord.button",t.CALL_ONE_POINT="event.press.call.one.point.button",t.CALL_TWO_POINT="event.press.call.two.point.button",t.CALL_THREE_POINT="event.press.call.three.point.button",t.NOT_PLAY_CARD="event.not.play.card",t.PLAY_CARD="event.must.play.card",t.HINT="event.hint",t.SHOW_CARDS_START_PLAY="event.show.cards.start.play",t.GAME_OVER_SHARE="event.game.over.share.button",t.CONTINUE_PLAY="event.continue.play",t.START_GAME="event.press.start.game.button",t.PURCHASE_DIAMOND="event.press.purchase.diamond.button",t.PURCHASE_COIN="event.press.purchase.coin.button",t}(egret.Event);__reflect(DDZButtonEvent.prototype,"DDZButtonEvent");var DDZDataEvent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.UPDATE="ddz.data.event.update",t}(egret.Event);__reflect(DDZDataEvent.prototype,"DDZDataEvent");var DDZDebugEvent=function(e){function t(t,n,a){return void 0===n&&(n=!1),void 0===a&&(a=!1),e.call(this,t,n,a)||this}return __extends(t,e),t.DEBUG_ROOM_CHANNEL="event.debug.room.channel",t}(egret.Event);__reflect(DDZDebugEvent.prototype,"DDZDebugEvent");var DDZEventCenter=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.sharedInstance=function(){return t.instance||(t.instance=new t),t.instance},t.instance=void 0,t}(egret.DisplayObjectContainer);__reflect(DDZEventCenter.prototype,"DDZEventCenter");var DDZHandCardEvent=function(e){function t(t,n,a){return void 0===n&&(n=!1),void 0===a&&(a=!1),e.call(this,t,n,a)||this}return __extends(t,e),t.TOUCHED="event.hand.card.touched",t.TOUCH_END="event.hand.card.touch.end",t}(egret.Event);__reflect(DDZHandCardEvent.prototype,"DDZHandCardEvent");var DDZMusicEvent=function(e){function t(t,n,a){return void 0===n&&(n=!1),void 0===a&&(a=!1),e.call(this,t,n,a)||this}return __extends(t,e),t.PLAY_MUSIC_EVENT="event.play.game.music",t.STOP_MUSIC_EVENT="event.stop.game.music",t}(egret.Event);__reflect(DDZMusicEvent.prototype,"DDZMusicEvent");var DDZNetworkEvent=function(e){function t(t,n,a){return void 0===n&&(n=!1),void 0===a&&(a=!1),e.call(this,t,n,a)||this}return __extends(t,e),t.DISCONNECT_SERVER_EVENT="event.disconnect.with.server",t.CONNECT_TO_SERVER_EVENT="event.connect.to.server",t}(egret.Event);__reflect(DDZNetworkEvent.prototype,"DDZNetworkEvent");var DDZWebsocketEvent=function(e){function t(t,n,a){return void 0===n&&(n=!1),void 0===a&&(a=!1),e.call(this,t,n,a)||this}return __extends(t,e),t.MISS_MESSAGE_EVENT="event.miss.websocket.message",t}(egret.Event);__reflect(DDZWebsocketEvent.prototype,"DDZWebsocketEvent");var FriendsSearchScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="FriendsSearchUI",t.skipLable.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressSkipLable,t),t}return __extends(t,e),t.prototype.onPressSkipLable=function(){qp.SceneManager.sharedInstance().replaceScene(new DDZHomeScene)},t}(QPScene);__reflect(FriendsSearchScene.prototype,"FriendsSearchScene");var DDZGameOverScene=function(e){function t(t,n){var a=e.call(this)||this;a.gameModel=void 0,a.skinName="DDZGameOverSceneUI",a.background.source=t;var r=new egret.BlurFilter(3,3);return a.background.filters=[r],a.gameModel=n,a.addListeners(),a}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this),this.addListeners()},t.prototype.onExit=function(){e.prototype.onExit.call(this),this.removeListeners()},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.gameModel.bottomPlayerModel.attribute.isWinner?(this.successView.visible=!0,this.successView.setGameData(this.gameModel),this.failedView.visible=!1):(this.successView.visible=!1,this.failedView.visible=!0,this.failedView.setGameData(this.gameModel)),this.toolbar.pressBackHandler=this.back.bind(this)},t.prototype.addListeners=function(){DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.SHOW_CARDS_START_PLAY,this.showCardsStartPlay,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.GAME_OVER_SHARE,this.share,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.CONTINUE_PLAY,this.continuePlay,this)},t.prototype.removeListeners=function(){DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.SHOW_CARDS_START_PLAY,this.showCardsStartPlay,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.GAME_OVER_SHARE,this.share,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.CONTINUE_PLAY,this.continuePlay,this)},t.prototype.showCardsStartPlay=function(){QPAlert.sharedInstance().showAt(this,"暂未开放此功能，敬请期待")},t.prototype.share=function(){QPAlert.sharedInstance().showAt(this,"暂未开放此功能，敬请期待")},t.prototype.continuePlay=function(){var e=this,t=new QPLoadingScene;t.show(),UserModel.sharedInstance().joinGame(function(e){t.hide();var n=new DDZGameModel(e.roomId);n.addPlayers(e.playerInformations),n.setBaseScore(e.baseScore),qp.SceneManager.sharedInstance().replaceScene(new DDZPlayGameScene(n))},function(n){t.hide(),QPAlert.sharedInstance().showAt(e,n.message)})},t.prototype.back=function(){qp.SceneManager.sharedInstance().replaceScene(new DDZHomeScene)},t}(QPScene);__reflect(DDZGameOverScene.prototype,"DDZGameOverScene");var DDZGameOverFailedView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZGameOverFailedUI",t}return __extends(t,e),t.prototype.setGameData=function(e){this.bottomPlayerInfo.setPlayerInfo({name:e.bottomPlayerModel.attribute.name,baseScore:e.game.baseScore,multiple:e.game.getMultiple(),coin:e.bottomPlayerModel.attribute.score}),this.leftPlayerInfo.setPlayerInfo({name:e.leftPlayerModel.attribute.name,baseScore:e.game.baseScore,multiple:e.game.getMultiple(),coin:e.leftPlayerModel.attribute.score}),this.rightPlayerInfo.setPlayerInfo({name:e.rightPlayerModel.attribute.name,baseScore:e.game.baseScore,multiple:e.game.getMultiple(),coin:e.rightPlayerModel.attribute.score}),this.characterImage.source=e.bottomPlayerModel.getGameOverCharacterSource()},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.continueButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressContinue,this)},t.prototype.onPressShowCardsStart=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZButtonEvent(DDZButtonEvent.SHOW_CARDS_START_PLAY);DDZEventCenter.sharedInstance().dispatchEvent(e)},t.prototype.onPressContinue=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZButtonEvent(DDZButtonEvent.CONTINUE_PLAY);DDZEventCenter.sharedInstance().dispatchEvent(e)},t}(QPLayer);__reflect(DDZGameOverFailedView.prototype,"DDZGameOverFailedView");var DDZGameOverPlayerInfo=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZGameOverPlayerInfoUI",t}return __extends(t,e),t.prototype.setPlayerInfo=function(e){this.setNameText(e.name),this.setBaseScoreText(e.baseScore),this.setMultipleText(e.multiple),this.setCoinText(e.coin)},t.prototype.setNameText=function(e){this.nameLabel.text=e},t.prototype.setBaseScoreText=function(e){this.baseScoreLabel.text=String(e)},t.prototype.setMultipleText=function(e){this.multipleLabel.text=String(e)},t.prototype.setCoinText=function(e){this.coinLabel.text=String(e)},t}(QPLayer);__reflect(DDZGameOverPlayerInfo.prototype,"DDZGameOverPlayerInfo");var DDZGameOverSuccessView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZGameOverSuccessUI",t.continueButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressContinueButton,t),t}return __extends(t,e),t.prototype.setGameData=function(e){this.bottomPlayerInfo.setPlayerInfo({name:e.bottomPlayerModel.attribute.name,baseScore:e.game.baseScore,multiple:e.game.getMultiple(),coin:e.bottomPlayerModel.attribute.score}),this.leftPlayerInfo.setPlayerInfo({name:e.leftPlayerModel.attribute.name,baseScore:e.game.baseScore,multiple:e.game.getMultiple(),coin:e.leftPlayerModel.attribute.score}),this.rightPlayerInfo.setPlayerInfo({name:e.rightPlayerModel.attribute.name,baseScore:e.game.baseScore,multiple:e.game.getMultiple(),coin:e.rightPlayerModel.attribute.score}),this.characterImage.source=e.bottomPlayerModel.getGameOverCharacterSource()},t.prototype.onPressShowCardsStartButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);
var e=new DDZButtonEvent(DDZButtonEvent.SHOW_CARDS_START_PLAY);DDZEventCenter.sharedInstance().dispatchEvent(e)},t.prototype.onPressShareButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZButtonEvent(DDZButtonEvent.GAME_OVER_SHARE);DDZEventCenter.sharedInstance().dispatchEvent(e)},t.prototype.onPressContinueButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZButtonEvent(DDZButtonEvent.CONTINUE_PLAY);DDZEventCenter.sharedInstance().dispatchEvent(e)},t}(QPLayer);__reflect(DDZGameOverSuccessView.prototype,"DDZGameOverSuccessView");var DDZGameOverToolbar=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZGameOverToolbarUI",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressBackButton,this)},t.prototype.onPressBackButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressBackHandler()},t}(QPLayer);__reflect(DDZGameOverToolbar.prototype,"DDZGameOverToolbar");var DDZHomeScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZHomeSceneUI",t.selectRoomButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressSelectRoomButton,t),t.quickStartButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressQuickStartButton,t),t.topToolbar.pressSettingsHandler=t.showSettingsScene.bind(t),t.topToolbar.pressAvatarHandler=t.showUserInfoScene.bind(t),t}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this),this.checkBoardContent(),egret.lifecycle.onResume=this.checkBoardContent.bind(this),DDZEventCenter.sharedInstance().addEventListener(DDZMusicEvent.PLAY_MUSIC_EVENT,this.playMusic,this),DDZEventCenter.sharedInstance().addEventListener(DDZMusicEvent.STOP_MUSIC_EVENT,this.stopMusic,this)},t.prototype.onExist=function(){e.prototype.onExit.call(this),DDZEventCenter.sharedInstance().removeEventListener(DDZMusicEvent.PLAY_MUSIC_EVENT,this.playMusic,this),DDZEventCenter.sharedInstance().removeEventListener(DDZMusicEvent.STOP_MUSIC_EVENT,this.stopMusic,this)},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),QPResource.AsyncLoader.sharedInstance().start(),this.playMusic()},t.prototype.checkBoardContent=function(){var e=this;PasteBoard.getContent(function(t){if(-1!==t.indexOf("您的好友创建好了房间邀请您一起玩一局游戏, 房间号: ")){var n=t.indexOf("["),a=t.indexOf("]"),r=t.slice(n+1,a);QPAlert.sharedInstance().pressedOKHandler=function(){UserModel.sharedInstance().personalRoomModel.setPin(r),e.joinToPersonalRoom()};var o="您的好友邀请您加入房间 ["+r+"], 一起玩游戏吧";QPAlert.sharedInstance().showCancelAndOkButtonAt(e,o)}})},t.prototype.onPressSelectRoomButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().replaceScene(new DDZRoomListScene)},t.prototype.onPressQuickStartButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.createPersonalRoom()},t.prototype.joinToPersonalRoom=function(){var e=this,t=new QPLoadingScene;t.show("正在加入房间");var n=UserModel.sharedInstance().actionDataFactory.makeJoinPersonalRoomData();UserModel.sharedInstance().actionModel.joinPersonalRoomByPin(n,function(e){t.hide(),UserModel.sharedInstance().personalRoomModel.setId(e.id),UserModel.sharedInstance().personalRoomModel.setPlayers(e.players);var n=new DDZGameModel(UserModel.sharedInstance().personalRoomModel.getId());n.addPlayers(UserModel.sharedInstance().personalRoomModel.getPlayers()),qp.SceneManager.sharedInstance().replaceScene(new DDZPlayGameScene(n))},function(n){t.hide(),QPAlert.sharedInstance().showAt(e,n.message)})},t.prototype.createPersonalRoom=function(){var e=this,t=new QPLoadingScene;t.show("正在创建房间");var n=UserModel.sharedInstance().actionDataFactory.makeCreatePersonalRoomData();UserModel.sharedInstance().actionModel.createPersonalRoom(n,function(e){t.hide(),UserModel.sharedInstance().personalRoomModel.setPin(e.pin),UserModel.sharedInstance().personalRoomModel.setId(e.id),UserModel.sharedInstance().personalRoomModel.setPlayers(e.players);var n=new DDZGameModel(UserModel.sharedInstance().personalRoomModel.getId());n.addPlayers(UserModel.sharedInstance().personalRoomModel.getPlayers()),qp.SceneManager.sharedInstance().replaceScene(new DDZPlayGameScene(n))},function(n){t.hide(),QPAlert.sharedInstance().showAt(e,n.message)})},t.prototype.queryPlayerGameState=function(){var e=this,t=new QPLoadingScene;t.show("正在查询游戏信息"),DDZGameState.Model.sharedInstance().fetch(function(n){return n?(t.hide(),void QPAlert.sharedInstance().showAt(e,n.message)):void(DDZGameState.Model.sharedInstance().isInGame()?e.backToExistGame(t):DDZGameState.Model.sharedInstance().isIdling()&&e.joinNewGame(t))})},t.prototype.backToExistGame=function(e){var t={roomId:DDZGameState.Model.sharedInstance().room.id,baseScore:DDZGameState.Model.sharedInstance().room.baseScore,playerInformations:DDZGameState.Model.sharedInstance().room.playerInformations};this.goToPlayScene(t,e)},t.prototype.joinNewGame=function(e){var t=this;e.show("正在寻找房间"),UserModel.sharedInstance().joinGame(function(n){var a={roomId:n.roomId,baseScore:n.baseScore,playerInformations:n.playerInformations};t.goToPlayScene(a,e)},function(n){e.hide(),QPAlert.sharedInstance().showAt(t,n.message)})},t.prototype.goToPlayScene=function(e,t){t.hide();var n=new DDZGameModel(e.roomId);n.addPlayers(e.playerInformations),n.setBaseScore(e.baseScore),qp.SceneManager.sharedInstance().replaceScene(new DDZPlayGameScene(n))},t.prototype.showUserInfoScene=function(){var e=Device.sharedInstance().screenShoot(this);qp.SceneManager.sharedInstance().pushScene(new DDZUserInfoScene(e,UserModel.sharedInstance().attributeModel))},t.prototype.showStoreScene=function(){qp.SceneManager.sharedInstance().pushScene(new DDZStoreScene)},t.prototype.showMailScene=function(){var e=Device.sharedInstance().screenShoot(this);qp.SceneManager.sharedInstance().pushScene(new DDZMailScene(e))},t.prototype.showPackageScene=function(){var e=Device.sharedInstance().screenShoot(this);qp.SceneManager.sharedInstance().pushScene(new DDZPackageScene(e))},t.prototype.showTaskScene=function(){var e=Device.sharedInstance().screenShoot(this);qp.SceneManager.sharedInstance().pushScene(new DDZTaskScene(e))},t.prototype.showSettingsScene=function(){var e=Device.sharedInstance().screenShoot(this);qp.SceneManager.sharedInstance().pushScene(new DDZSettingsScene(e))},t.prototype.playMusic=function(){QPAudioManager.sharedInstance().playBackgroundMusic("ddz_not_play_game_music_mp3",-1)},t.prototype.stopMusic=function(){QPAudioManager.sharedInstance().stopPlayBackgroundMusic()},t}(QPScene);__reflect(DDZHomeScene.prototype,"DDZHomeScene");var DDZGameState;!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.sharedInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.fetch=function(e){var t=this,r={url:QPApiConfig.Host+"/"+QPApiConfig.V1+"/doudizhu/player_state",header:this.headerWithAuthorization()};this.fetchJson(r,function(r){egret.log("fetch game state success ... \n"),egret.log(r),egret.log("========================"),t.setGameState(r.state),(t.gameState===a.BECOMING_LANDLORD||t.gameState===a.PLAYING_CARD)&&(t.room=new n(r.room)),e()},function(t){e(t)})},t.prototype.setGameState=function(e){this.gameState=e},t.prototype.isInGame=function(){return this.gameState===a.BECOMING_LANDLORD||this.gameState===a.PLAYING_CARD},t.prototype.isIdling=function(){return this.gameState===a.IDLING},t.prototype.isPlayingGame=function(){return this.gameState===a.PLAYING_CARD},t.prototype.isBecomingLandlord=function(){return this.gameState===a.BECOMING_LANDLORD},t.prototype.countCardsForPlayer=function(e){var t=this.getPlayerInformationById(e);return t?t.cardsCount:0},t.prototype.listCardsForPlayer=function(e){var t=this.getPlayerInformationById(e);return t?t.cards:[]},t.prototype.listPlayedCardsForPlayer=function(e){var t=this.getPlayerInformationById(e);e===this.room.confirmedLandlord;return t?t.lastPlayedCards:[]},t.prototype.getPlayerInformationById=function(e){for(var t=0,n=this.room.playerInformations;t<n.length;t++){var a=n[t];if(a.id===e)return a}},t.prototype.getActivePlayerTimerValue=function(){return this.room.activePlayerInformation.timerValue},t.instance=void 0,t}(QPNetworkApi);e.Model=t,__reflect(t.prototype,"DDZGameState.Model");var n=function(){function e(e){if(this.lastPlayedCards=[],this.calledLandlordScore=0,this.id=e.id,this.gameMatchId=e.game_match_id,this.startedAt=e.started_at,this.baseScore=e.base_score,this.bottomCards=[],e.bottom_cards)for(var t=0,n=e.bottom_cards;t<n.length;t++){var a=n[t],r=new DDZCard(a);this.bottomCards.push(r)}this.confirmedLandlord=e.landlord,this.initLandlord=e.init_landlord,this.playerIds=e.player_ids,this.playerInformations=[],this.createPlayerInformations(e.players)}return e.prototype.createPlayerInformations=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t],r=!1;(a.stopwatch||0===a.stopwatch)&&(r=!0);var o={id:a.id,service_id:a.service_id,is_active:r,timer_value:r?a.stopwatch:0,cards_count:a.remain_cards_amount,cards:a.cards,call_landlord_score:a.become_landlord_record?a.become_landlord_record.score:0,has_called_landlord:null!==a.become_landlord_record,last_played_cards:a.last_play_card_record?a.last_play_card_record.played_cards:[],seat:a.seat,nickname:a.nickname,profile_image:a.profile_image,gender:a.gender,balance:a.balance};a.last_play_card_record&&this.setLastPlayedCardsCards(a),this.setLastCalledLandlordScore(a);var s=new DDZPlayerJoinGameInformation(o);r&&(this.activePlayerInformation=s),this.playerInformations.push(s)}},e.prototype.setLastCalledLandlordScore=function(e){var t=e.become_landlord_record;t&&this.calledLandlordScore<t.score&&(this.calledLandlordScore=t.score)},e.prototype.setLastPlayedCardsCards=function(e){var t=e.last_play_card_record;if(this.lastPlayedCardsDate){var n=new Date(t.created_at);if(this.lastPlayedCardsDate<n){var a=t.played_cards.map(function(e){return new DDZCard(e)});0!==a.length&&(this.lastPlayedCardsDate=n,this.lastPlayedCards=a,this.lastPlayedCardsPlayer=e.id)}}else{var a=t.played_cards.map(function(e){return new DDZCard(e)});0!==a.length&&(this.lastPlayedCardsDate=new Date(t.created_at),this.lastPlayedCards=a,this.lastPlayedCardsPlayer=e.id)}},e}();e.Room=n,__reflect(n.prototype,"DDZGameState.Room");var a=function(){function e(){}return e.BECOMING_LANDLORD="becoming_landlord",e.PLAYING_CARD="playing_card",e.IDLING="idling",e.GAME_BEEN_RESTORED="game_has_been_restored",e}();e.Type=a,__reflect(a.prototype,"DDZGameState.Type")}(DDZGameState||(DDZGameState={}));var DDZPlayerJoinGameInformation=function(){function e(e){if(this.cardsCount=0,this.calledLandlordScore=0,this.id=e.id,this.serviceId=e.service_id||"",this.isActive=e.is_active,this.timerValue=e.timer_value,this.cardsCount=e.cards_count,this.hasCalledLandlord=e.has_called_landlord,this.cards=[],this.seatId=String(e.seat),this.nickame=e.nickname,this.profileImage=e.profile_image,this.balance=e.balance,this.gender=GenderFactory.createGender(e.gender),e.cards)for(var t=0,n=e.cards;t<n.length;t++){var a=n[t],r=new DDZCard(a);this.cards.push(r)}if(this.calledLandlordScore=e.call_landlord_score,this.lastPlayedCards=[],e.last_played_cards)for(var o=0,s=e.last_played_cards;o<s.length;o++){var a=s[o],r=new DDZCard(a);this.lastPlayedCards.push(r)}}return e}();__reflect(DDZPlayerJoinGameInformation.prototype,"DDZPlayerJoinGameInformation");var DDZHomeBottomToolbar=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZHomeBottomToolbarUI",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.mailButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressMailButton,this),this.taskButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressTaskButton,this),this.packageButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressPackageButton,this),this.storeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressStoreButton,this)},t.prototype.onPressMailButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressMailButtonHandler()},t.prototype.onPressTaskButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressTaskButtonHandler()},t.prototype.onPressPackageButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressPackageButtonHandler()},t.prototype.onPressStoreButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressStoreButtonHandler&&this.pressStoreButtonHandler()},t}(QPLayer);__reflect(DDZHomeBottomToolbar.prototype,"DDZHomeBottomToolbar");var DDZHomeGameBoard=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZHomeGameBoardUI",t}return __extends(t,e),t}(QPLayer);__reflect(DDZHomeGameBoard.prototype,"DDZHomeGameBoard");var DDZHomeTopToolbar=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZHomeTopToolbarUI",t}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this),DDZEventCenter.sharedInstance().addEventListener(DDZDataEvent.UPDATE,this.setUserInfo,this)},t.prototype.onExit=function(){e.prototype.onExit.call(this),DDZEventCenter.sharedInstance().removeEventListener(DDZDataEvent.UPDATE,this.setUserInfo,this)},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.userAvatar.onPressedHandler=this.onPressedAvatar.bind(this),this.settingsButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressSettingsButton,this),this.setUserInfo()},t.prototype.setUserInfo=function(){this.nameLabel.text=UserModel.sharedInstance().attributeModel.name,this.idLabel.text=UserModel.sharedInstance().attributeModel.serviceId},t.prototype.onPressedAvatar=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressAvatarHandler&&this.pressAvatarHandler()},t.prototype.onPressSettingsButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressSettingsHandler&&this.pressSettingsHandler()},t}(QPLayer);__reflect(DDZHomeTopToolbar.prototype,"DDZHomeTopToolbar");var DDZMailScene=function(e){function t(t){var n=e.call(this)||this;return n.skinName="DDZMailSceneUI",n.backgroundImage.source=t,n}return __extends(t,e),t}(QPScene);__reflect(DDZMailScene.prototype,"DDZMailScene");var DDZMail=function(){function e(e){this.title=e.title,this.contentTextFlow=e.content}return e}();__reflect(DDZMail.prototype,"DDZMail");var testSystemMessages=[],DDZMailModel=function(){function e(){}return e.prototype.fetchSystemMails=function(e){e([])},e.prototype.getMailAtIndex=function(e){return e>=this.mails.length?void 0:this.mails[e]},e}();__reflect(DDZMailModel.prototype,"DDZMailModel");var DDZMailDetailView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZMailDetailUI",t.closeButton.pressHandler=t.goBack.bind(t),t}return __extends(t,e),t.prototype.setMailTitle=function(e){this.mailTitleLabel.text=e},t.prototype.setContentTextFlow=function(e){this.contentLabel.textFlow=e},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.contentScroller.viewport=this.contentGroup,this.okButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goBack,this)},t.prototype.goBack=function(){qp.SceneManager.sharedInstance().removeChildLayer(this)},t}(QPLayer);__reflect(DDZMailDetailView.prototype,"DDZMailDetailView");var DDZMailListCell=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZMailListCellUI",t}return __extends(t,e),t.prototype.dataChanged=function(){this.titleLabel.text=this.data.title,this.dateLabel.text=String(this.data.date)},t}(eui.ItemRenderer);__reflect(DDZMailListCell.prototype,"DDZMailListCell");var DDZMailPopupView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZMailPopupUI",t.mailModel=new DDZMailModel,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.emptyContentView.visible=!1,this.createMailList()},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.closeButton.pressHandler=this.onPressCloseButton.bind(this)},t.prototype.createMailList=function(){var e=this;this.mailListScroller.viewport=this.mailList,this.mailModel.fetchSystemMails(function(t,n){n||(e.emptyContentView.visible=0===t.length,e.mailList.dataProvider=new eui.ArrayCollection(t),e.mailList.itemRenderer=DDZMailListCell,e.mailList.addEventListener(eui.ItemTapEvent.ITEM_TAP,e.onPressMail,e))})},t.prototype.onPressCloseButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().popScene()},t.prototype.onPressMail=function(e){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var t=new DDZMailDetailView,n=this.mailModel.getMailAtIndex(e.itemIndex);n?(t.setMailTitle(n.title),t.setContentTextFlow(n.contentTextFlow),qp.SceneManager.sharedInstance().addChildLayer(t)):egret.log("糟糕！！！ DDZMailScene 获取内容列表数据出错")},t}(QPPopupLayer);__reflect(DDZMailPopupView.prototype,"DDZMailPopupView");var DDZGameService=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(Centrifuge);__reflect(DDZGameService.prototype,"DDZGameService");var DDZGameServiceModel=function(){function e(){this.gameService=void 0,this.needExecuteCallback=!1}return e.sharedInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.isSupportWSS=function(e,t){var n=new egret.WebSocket;n.type=egret.WebSocket.TYPE_BINARY,n.addEventListener(egret.Event.CONNECT,function(e){t(!0),n.close()},this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,function(e){t(!1)},this),n.connectByUrl(e)},e.prototype.start=function(e,t){var n=this;if(this.needExecuteCallback=!0,this.gameService)return void(this.needExecuteCallback&&(this.gameService.connect(),t(),this.needExecuteCallback=!1));var a={isNative:Device.sharedInstance().isNative(),url:e.host,version:e.version,accessToken:e.access_token,user:e.user_id,info:e.info,timestamp:e.timestamp,token:e.token};this.gameService=new DDZGameService(a),this.gameService.connect(),this.gameService.on("connect",function(e){t&&n.needExecuteCallback&&(t(),n.needExecuteCallback=!1);var a=new DDZNetworkEvent(DDZNetworkEvent.CONNECT_TO_SERVER_EVENT);DDZEventCenter.sharedInstance().dispatchEvent(a),egret.log("game service connect ....")}),this.gameService.on("disconnect",function(e){var t=new DDZNetworkEvent(DDZNetworkEvent.DISCONNECT_SERVER_EVENT);DDZEventCenter.sharedInstance().dispatchEvent(t),egret.log("game service disconnect ......"),egret.log(e)}),this.gameService.on("error",function(e){egret.log("game service error ......"),egret.log(e)})},e.prototype.stop=function(){this.gameService.disconnect(),this.gameService=void 0},e.prototype.subscribe=function(e,t){return this.gameService.subscribe(e,t)},e}();__reflect(DDZGameServiceModel.prototype,"DDZGameServiceModel",["IUserWebsocketAction"]);var DDZUserChannelModel=function(){function e(){this.needExecuteCallback=!1}return e.sharedInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setMessageCounter=function(e){this.messageCounter=e},e.prototype.resetMessageCounter=function(){this.messageCounter.reset()},e.prototype.subscribe=function(e,t){var n=this;if(this.needExecuteCallback=!0,this.userChannel)return egret.log("callback without subscribe..........."),void t();var a={message:function(e){egret.log("----------------------------------------"),egret.log(JSON.stringify(e.data.payload)),egret.log("\n"),n.needResetMessageCounter(e)&&n.resetMessageCounter(),"room"===e.data.stream?n.handleRoomMessage(e):"doudizhu"===e.data.stream&&n.handleGameMessage(e),n.checkMessageMissed(e)},join:function(e){egret.log("user channel someone joined channel")},leave:function(e){egret.log("user channel someone left channel")},subscribe:function(e){n.needExecuteCallback&&(t(),n.needExecuteCallback=!1)},error:function(e){n.needExecuteCallback&&(t(new Error("订阅用户频道出错")),n.needExecuteCallback=!1),n.unsubscribe(),egret.log("subscribe userChannel failed ......."),egret.log(e)},unsubscribe:function(e){egret.log("unsubscribe userChannel success .......")}};this.userChannel=DDZGameServiceModel.sharedInstance().subscribe(e,a)},e.prototype.unsubscribe=function(){this.userChannel&&(this.userChannel.unsubscribe(),this.userChannel=void 0)},e.prototype.handleRoomMessage=function(e){var t=e.data;if(t.payload.action===DDZGameServiceMessageType.JoinRoom||t.payload.action===DDZGameServiceMessageType.LeaveRoom){var n=new DDZGameServiceMessage(e);this.roomPlayerChangedHandler&&this.roomPlayerChangedHandler(n.data)}},e.prototype.handleGameMessage=function(e){var t=e.data;if(t.payload.action===DDZGameServiceMessageType.StartGame){var n=new DDZGameServiceMessage(e);this.startGameHandler&&this.startGameHandler(n)}else if(t.payload.action===DDZGameServiceMessageType.DealCards){var a=new DDZGameServiceMessage(e);this.dealCardsHandler&&this.dealCardsHandler(a)}else if(t.payload.action===DDZGameServiceMessageType.CallLandlord){var r=new DDZGameServiceMessage(e);this.callLandlordMessageHandler&&this.callLandlordMessageHandler(r.data)}else if(t.payload.action===DDZGameServiceMessageType.ConfirmLandlord){var o=new DDZGameServiceMessage(e);this.confirmLandlordHandler&&this.confirmLandlordHandler(o)}else if(t.payload.action===DDZGameServiceMessageType.RestartGame){var s=new DDZGameServiceMessage(e);this.restartGameHandler&&this.restartGameHandler(s)}else if(t.payload.action===DDZGameServiceMessageType.PlayCard){var i=new DDZGameServiceMessage(e);this.playCardHandler&&this.playCardHandler(i)}else if(t.payload.action===DDZGameServiceMessageType.GameOver){var d=new DDZGameServiceMessage(e);this.gameOverMessageHandler&&this.gameOverMessageHandler(d)}},e.prototype.needResetMessageCounter=function(e){var t=e.data.payload.action;return t===DDZGameServiceMessageType.RestartGame?!0:t===DDZGameServiceMessageType.GameOver?!0:!1},e.prototype.checkMessageMissed=function(e){if(e.data.payload.action!==DDZGameServiceMessageType.GameOver&&(this.messageCounter.addMessage(e.data.payload.sequence),this.messageCounter.isMessageMissed())){var t=new DDZWebsocketEvent(DDZWebsocketEvent.MISS_MESSAGE_EVENT);DDZEventCenter.sharedInstance().dispatchEvent(t)}},e}();__reflect(DDZUserChannelModel.prototype,"DDZUserChannelModel");var TestDDZUserChannelModel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.startTest=function(){this.testMissMessage(),this.testNoMessageMissed(),this.testMissedMessageAndCountAgain()},t.prototype.testMissMessage=function(){var e=new DDZGameServiceMessageCounter;this.assertEquals("期待初始丢失消息状态为 false",!1,e.isMessageMissed()),e.addMessage(1),e.addMessage(2),e.addMessage(3),e.addMessage(4),e.addMessage(6),this.assertEquals("监测到丢失消息",!0,e.isMessageMissed())},t.prototype.testNoMessageMissed=function(){var e=new DDZGameServiceMessageCounter;this.assertEquals("期待初始丢失消息状态为 false",!1,e.isMessageMissed()),e.addMessage(1),e.addMessage(2),e.addMessage(3),e.addMessage(4),e.addMessage(5),e.addMessage(6),e.addMessage(7),e.addMessage(8),e.addMessage(9),e.addMessage(10),e.addMessage(11),e.addMessage(12),e.addMessage(13),e.addMessage(14),e.addMessage(15),this.assertEquals("测试连续收到15条消息",!1,e.isMessageMissed())},t.prototype.testMissedMessageAndCountAgain=function(){var e=new DDZGameServiceMessageCounter;this.assertEquals("测试缺失消息然后重新检测 --- 期待初始丢失消息状态为 false",!1,e.isMessageMissed()),e.addMessage(1),e.addMessage(2),e.addMessage(3),e.addMessage(4),e.addMessage(6),this.assertEquals("测试缺失消息然后重新检测 --- 监测到消息丢失",!0,e.isMessageMissed()),e.reset(),e.addMessage(1),e.addMessage(2),e.addMessage(3),e.addMessage(4),e.addMessage(5),this.assertEquals("测试缺失消息然后重新检测 --- 消息丢失后重新检测没有丢失情况",!1,e.isMessageMissed()),e.reset(),e.addMessage(1),e.addMessage(2),e.addMessage(3),e.addMessage(4),e.addMessage(6),this.assertEquals("测试缺失消息然后重新检测 --- 消息丢失后重新检测又有消息丢失情况",!0,e.isMessageMissed())},t}(QPTestCase);__reflect(TestDDZUserChannelModel.prototype,"TestDDZUserChannelModel");var DDZGameServiceMessage=function(){function e(e){this.uid=e.uid,this.channel=e.channel,this.data=DDZGameServiceMessageDataFactory.createMessageData(e.data.payload)}return e}();__reflect(DDZGameServiceMessage.prototype,"DDZGameServiceMessage");var TestMain=function(e){function t(){var t=e.call(this)||this,n=new TestGameModel("test_game_model");n.startTest();var a=new TestDDZTaskActionModel("test_task_action_model");a.startTest();var r=new TestUserActionModel("test.user.http.action.model");r.startTest();var o=new TestDDZUserChannelModel("test.user.channel.model");return o.startTest(),t}return __extends(t,e),t}(eui.UILayer);__reflect(TestMain.prototype,"TestMain");var DDZGameServiceMessageCallLandlordData=function(e){function t(t){var n=e.call(this,t)||this;return n.nextPlayer=t.next_player_id,n.playerId=t.player_id,n.score=t.score,n.currentLandlordScore=t.current_landlord_score,n}return __extends(t,e),t}(DDZGameServiceMessageBaseData);__reflect(DDZGameServiceMessageCallLandlordData.prototype,"DDZGameServiceMessageCallLandlordData");var DDZGameServiceMessageConfirmLandlordData=function(e){function t(t){var n=e.call(this,t)||this;n.landlord=t.landlord,n.bottomCards=[];for(var a=0,r=t.bottom_cards;a<r.length;a++){var o=r[a],s=new DDZCard(o);n.bottomCards.push(s)}return n}return __extends(t,e),t}(DDZGameServiceMessageBaseData);__reflect(DDZGameServiceMessageConfirmLandlordData.prototype,"DDZGameServiceMessageConfirmLandlordData");var DDZGameServiceMessageCounter=function(){function e(){this.DefaultMessageSequence=-11111,this.reset()}return e.prototype.addMessage=function(e){void 0!==e&&(this.previousMessageSequence===this.DefaultMessageSequence?this.missMessage=!1:e-this.previousMessageSequence!==1&&(this.missMessage=!0),this.previousMessageSequence=e)},e.prototype.isMessageMissed=function(){return this.missMessage},e.prototype.reset=function(){this.previousMessageSequence=this.DefaultMessageSequence,this.missMessage=!1},e}();__reflect(DDZGameServiceMessageCounter.prototype,"DDZGameServiceMessageCounter",["IDDZMessageCounter"]);var DDZGameServiceMessageDataFactory=function(){function e(){}return e.createMessageData=function(e){switch(e.action){case DDZGameServiceMessageType.JoinRoom:return new DDZGameServiceMessageRoomPlayerChangedData(e);case DDZGameServiceMessageType.LeaveRoom:return new DDZGameServiceMessageRoomPlayerChangedData(e);case DDZGameServiceMessageType.DealCards:return new DDZGameServiceMessageDealCardsData(e);case DDZGameServiceMessageType.CallLandlord:return new DDZGameServiceMessageCallLandlordData(e);case DDZGameServiceMessageType.ConfirmLandlord:return new DDZGameServiceMessageConfirmLandlordData(e);case DDZGameServiceMessageType.StartGame:return new DDZGameServiceMessageStartGameData(e);case DDZGameServiceMessageType.RestartGame:return new DDZGameServiceMessageRestartGameData(e);case DDZGameServiceMessageType.PlayCard:return new DDZGameServiceMessagePlayCardData(e);case DDZGameServiceMessageType.GameOver:return new DDZGameServiceMessageGameOverData(e)}throw new Error("create game service message data fatal error ...")},e}();__reflect(DDZGameServiceMessageDataFactory.prototype,"DDZGameServiceMessageDataFactory");var DDZGameServiceMessageDealCardsData=function(e){function t(t){var n=e.call(this,t)||this;n.cards=[];for(var a=0,r=t.cards;a<r.length;a++){var o=r[a],s=new DDZCard(o);n.cards.push(s)}return n}return __extends(t,e),t}(DDZGameServiceMessageBaseData);__reflect(DDZGameServiceMessageDealCardsData.prototype,"DDZGameServiceMessageDealCardsData");var DDZGameServiceMessageGameOverData=function(e){function t(t){var n=e.call(this,t)||this;return n.playerInformations=n.createPlayerInformations(t.players_information),n.isSpring=t.is_slam,n.endDateString=t.ended_at,n}return __extends(t,e),t.prototype.createPlayerInformations=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var r=a[n],o=new DDZGameOverPlayerInformation(r);t.push(o)}return t},t}(DDZGameServiceMessageBaseData);__reflect(DDZGameServiceMessageGameOverData.prototype,"DDZGameServiceMessageGameOverData");var DDZGameOverPlayerInformation=function(){function e(e){if(this.playerId=e.player_id,this.remainCards=[],e.remain_cards)for(var t=0,n=e.remain_cards;t<n.length;t++){var a=n[t],r=new DDZCard(a);this.remainCards.push(r)}e.settlement&&(this.balance=Number(e.settlement.balance),this.dealtAmount=Number(e.settlement.dealt_amount),this.frozenAmount=Number(e.settlement.frozen_amount),this.totalAmount=Number(e.settlement.total_amount))}return e.prototype.isWinner=function(){return 0===this.remainCards.length},e}();__reflect(DDZGameOverPlayerInformation.prototype,"DDZGameOverPlayerInformation");var DDZGameServiceMessagePlayCardData=function(e){function t(t){var n=e.call(this,t)||this;if(n.playerId=t.player_id,n.remainCardsAmount=t.remain_cards_amount,n.nextPlayerId=t.next_player_id,0===t.played_cards.length)n.playedCards=[];else{var a=t.played_cards.map(function(e){return new DDZCard(e)});n.playedCards=a.sort(function(e,t){return t.index-e.index})}return n}return __extends(t,e),t}(DDZGameServiceMessageBaseData);__reflect(DDZGameServiceMessagePlayCardData.prototype,"DDZGameServiceMessagePlayCardData");var DDZGameServiceMessageRestartGameData=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(DDZGameServiceMessageStartGameData);__reflect(DDZGameServiceMessageRestartGameData.prototype,"DDZGameServiceMessageRestartGameData");var DDZGameServiceMessageRoomPlayerChangedData=function(e){function t(t){var n=e.call(this,t)||this;return n.playerInformations=[],n.createPlayerInformaitons(t.room.players),n}return __extends(t,e),t.prototype.createPlayerInformaitons=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t],r={id:a.id,service_id:a.service_id,is_active:!1,timer_value:0,cards_count:0,cards:[],call_landlord_score:0,has_called_landlord:!1,last_played_cards:[],seat:a.seat,nickname:a.nickname,profile_image:a.profile_image,gender:a.gender,balance:a.balance},o=new DDZPlayerJoinGameInformation(r);this.playerInformations.push(o)}},t}(DDZGameServiceMessageBaseData);__reflect(DDZGameServiceMessageRoomPlayerChangedData.prototype,"DDZGameServiceMessageRoomPlayerChangedData");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,a){function r(e){t.call(a,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(a))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var DDZGameServiceMessageType=function(){function e(){}return e.JoinRoom="join_room",e.LeaveRoom="leave_room",e.StartGame="start_game",e.DealCards="deal_cards",e.Match="match",e.CallLandlord="become_landlord",e.ConfirmLandlord="finish_landlord",e.RestartGame="restart_game",e.Deal="deal",e.PlayCard="play_card",e.GameOver="end_game",e}();__reflect(DDZGameServiceMessageType.prototype,"DDZGameServiceMessageType");var DDZAccountRegisterPopup=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZAccountRegisterPopupUI",t.getVerificationCodeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressGetVerificationCodeButton,t),t.registerButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressRegisterButton,t),t}return __extends(t,e),t.prototype.onExit=function(){e.prototype.onExit.call(this),this.getVerificationCodeButton.stopCountDown()},t.prototype.disableSendVerificationButon=function(){this.getVerificationCodeButton.disable()},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.phoneInput.prompt="请输入电话号码",this.passwordInput.prompt="请输入密码",this.verificationCodeInput.prompt="请输入验证码"
},t.prototype.onPressGetVerificationCodeButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressGetVerificationCodeHandler&&this.pressGetVerificationCodeHandler(this.phoneInput.text)},t.prototype.onPressRegisterButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressRegisterHandler&&this.pressRegisterHandler(this.phoneInput.text,this.passwordInput.text,this.verificationCodeInput.text)},t}(QPPopupLayer);__reflect(DDZAccountRegisterPopup.prototype,"DDZAccountRegisterPopup");var HttpActionModel=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.executeGet=function(e,t,n){},t.prototype.executePost=function(e,t,n){var a={url:e.url,header:e.needAuthorization?this.headerWithAuthorization():this.headerWithoutAuthorization(),body:e.body};this.postReturnJson(a,function(e){t(e)},function(e){n(e)})},t}(QPNetworkApi);__reflect(HttpActionModel.prototype,"HttpActionModel",["IHttpAction"]);var QPApiConfig=function(){function e(){}return e.Host="https://api-staging.shafayouxi.org",e.V1="v1",e.WEBSOCKET_V1="v1",e.WSS_HOST="wss://api-staging.shafayouxi.org",e.WS_HOST="ws://api-staging.shafayouxi.org",e}();__reflect(QPApiConfig.prototype,"QPApiConfig");var DDZAccountRegisterScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZAccountRegisterSceneUI",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goBack,this),this.popup.pressGetVerificationCodeHandler=this.getVerificationCode.bind(this),this.popup.pressRegisterHandler=this.register.bind(this)},t.prototype.goBack=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().popScene()},t.prototype.getVerificationCode=function(e){var t=this;UserModel.sharedInstance().inputtedAttributeModel.setPhoneNumber(e);var n=UserModel.sharedInstance().actionDataFactory.makeSendVerificationCodeData();n.isLegal&&this.popup.disableSendVerificationButon(),UserModel.sharedInstance().actionModel.sendVerificationCode(n,function(e){UserModel.sharedInstance().attributeModel.setHashDigest(e.hash_digest),UserModel.sharedInstance().attributeModel.setExpireISOTime(e.expire_iso_time),egret.log("DDZAccountRegisterScene getVerificationCode success....")},function(e){QPAlert.sharedInstance().showOKButtonAt(t,e.message)})},t.prototype.register=function(e,t,n){var a=this;UserModel.sharedInstance().inputtedAttributeModel.setVerificationCode(n),UserModel.sharedInstance().inputtedAttributeModel.setPhoneNumber(e),UserModel.sharedInstance().inputtedAttributeModel.setPassword(t);var r=new QPLoadingScene;r.show();var o=UserModel.sharedInstance().actionDataFactory.makeSignUpData();UserModel.sharedInstance().actionModel.signUp(o,function(e){egret.log(e),r.hide(),a.registerSuccess()},function(e){r.hide(),QPAlert.sharedInstance().showOKButtonAt(a,e.message)})},t.prototype.registerSuccess=function(){QPAlert.sharedInstance().showAt(this,UserModel.sharedInstance().inputtedAttributeModel.getPhoneNumber()+"注册成功"),QPAlert.sharedInstance().pressedOKHandler=function(){qp.SceneManager.sharedInstance().popScene()}},t}(QPScene);__reflect(DDZAccountRegisterScene.prototype,"DDZAccountRegisterScene");var QPNetworkErrorType;!function(e){e[e.None=0]="None",e[e.UserNotFound=1]="UserNotFound",e[e.NotThisPlayerTurn=2]="NotThisPlayerTurn",e[e.WrongCardType=3]="WrongCardType",e[e.ClientCheckedWrongCardType=4]="ClientCheckedWrongCardType"}(QPNetworkErrorType||(QPNetworkErrorType={}));var QPNetworkError=function(){function e(e){this.message=e.message,"user_not_found"===e.error_type?this.type=QPNetworkErrorType.UserNotFound:"not_this_player_turn"===e.error_type?this.type=QPNetworkErrorType.NotThisPlayerTurn:"wrong_card_type"===e.error_type?this.type=QPNetworkErrorType.WrongCardType:"client_checked_wrong_card_type"===e.error_type?this.type=QPNetworkErrorType.ClientCheckedWrongCardType:this.type=QPNetworkErrorType.None}return e}();__reflect(QPNetworkError.prototype,"QPNetworkError");var UserModel=function(e){function t(){var t=e.call(this)||this;return t.isTourist=!0,t.actionModel=new UserActionModel,t}return __extends(t,e),t.sharedInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.setActionDataFactory=function(e){this.actionDataFactory=e},t.prototype.setAttributeModel=function(e){this.attributeModel=e},t.prototype.setInputtedAttributeModel=function(e){this.inputtedAttributeModel=e},t.prototype.setPersonalRoomModel=function(e){this.personalRoomModel=e},t.prototype.signOut=function(e,t){DDZUserChannelModel.sharedInstance().unsubscribe(),DDZGameServiceModel.sharedInstance().stop(),this.attributeModel.cleanCommunicationAttribute(),t()},t.prototype.verifyIAPReceipt=function(e,t){var n={url:QPApiConfig.Host+"/"+QPApiConfig.V1+"/iap/transaction",header:this.headerWithAuthorization(),body:{user_id:this.attributeModel.id,receipt_data:e}};this.postReturnJson(n,function(e){t()},function(e){t(e)})},t.prototype.joinGame=function(e,t){var n=this,a={url:QPApiConfig.Host+"/"+QPApiConfig.V1+"/room/doudizhu/basic/join",header:this.headerWithAuthorization()};this.postReturnJson(a,function(e){egret.log("加入房间http请求成功")},function(e){t(e)}),DDZUserChannelModel.sharedInstance().roomPlayerChangedHandler=function(t){var a={roomId:t.roomId,baseScore:0,playerInformations:t.playerInformations},r=n.findUserInformation(t.playerInformations);n.setBalance(Number(r.balance)),e(a)}},t.prototype.modifyUserInformation=function(e,t){var n=this;if(e.nickname.countByte()<6)return void t(new QPNetworkError({message:"您的用户名不能少于2个中文或者6个英文字母"}));if(21<e.nickname.countByte())return void t(new QPNetworkError({message:"您的用户名不能多余7个中文或者21个英文字母"}));var a={header:this.headerWithAuthorization(),body:{nickname:e.nickname,gender:e.gender},url:QPApiConfig.Host+"/"+QPApiConfig.V1+"/user/profile/"};this.postReturnJson(a,function(e){n.attributeModel.name=e.nickname,n.attributeModel.gender=GenderFactory.createGender(e.gender),t()},function(e){t(e)})},t.prototype.connectRealtimeGameService=function(e){var t=this;this.createGameServiceParameters(function(n){DDZGameServiceModel.sharedInstance().start(n,function(){DDZUserChannelModel.sharedInstance().subscribe(t.attributeModel.getChannel(),function(t){return t?void e(t):(DDZUserChannelModel.sharedInstance().setMessageCounter(new DDZGameServiceMessageCounter),void e())})})})},t.prototype.addBalance=function(e){this.wallet.add(e),this.attributeModel.setBalanceAmount(this.wallet.getAvailableAmount())},t.prototype.saveUserInformation=function(e){this.attributeModel.setAccessToken(e.auth.access_token),this.attributeModel.setId(e.user.id),this.attributeModel.serviceId=e.user.service_id,this.attributeModel.gender=GenderFactory.createGender(e.user.gender),this.attributeModel.name=e.user.nickname,this.attributeModel.setIsAnonymous(e.user.is_anonymous),e.user.wallet&&(this.wallet=new UserWallet(e.user.wallet[0]),this.attributeModel.setBalanceAmount(this.wallet.getAvailableAmount())),this.attributeModel.setChannel(e.websocket_token.user_channel),this.attributeModel.setInfo(e.websocket_token.info),this.attributeModel.setTimestamp(e.websocket_token.timestamp),this.attributeModel.setToken(e.websocket_token.token)},t.prototype.createGameServiceParameters=function(e){var n=this,a=QPApiConfig.WSS_HOST+"/"+QPApiConfig.WEBSOCKET_V1+"/connection/websocket";a+="?access_token="+t.sharedInstance().attributeModel.getAccessToken(),DDZGameServiceModel.sharedInstance().isSupportWSS(a,function(t){var a={user_id:n.attributeModel.id,timestamp:n.attributeModel.getTimestamp(),host:QPApiConfig.WS_HOST,version:QPApiConfig.WEBSOCKET_V1,access_token:n.attributeModel.getAccessToken(),info:n.attributeModel.getInfo(),token:n.attributeModel.getToken()};t&&(a.host=QPApiConfig.WSS_HOST),e(a)})},t.prototype.findUserInformation=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];if(a.id===this.attributeModel.id)return a}},t.prototype.setBalance=function(e){this.wallet.setAvailableAmount(e),this.attributeModel.setBalanceAmount(this.wallet.getAvailableAmount())},t.instance=void 0,t}(QPNetworkApi);__reflect(UserModel.prototype,"UserModel");var UserWallet=function(){function e(e){this.name=e.currency,this.availableAmount=Number(e.balance),this.frozenAmount=Number(e.frozen_amount),this.totalAmount=Number(e.total_amount)}return e.prototype.add=function(e){this.availableAmount+=e,this.update()},e.prototype.setAvailableAmount=function(e){this.availableAmount=e,this.update()},e.prototype.getAvailableAmount=function(){return this.availableAmount},e.prototype.update=function(){this.totalAmount=this.availableAmount+this.frozenAmount;var e=new DDZDataEvent(DDZDataEvent.UPDATE);DDZEventCenter.sharedInstance().dispatchEvent(e)},e}();__reflect(UserWallet.prototype,"UserWallet",["IWallet"]);var TestUserActionModel=function(e){function t(t){var n=e.call(this,t)||this;return n.actionModel=new UserActionModel,n}return __extends(t,e),t.prototype.startTest=function(){this.testGetVerificationCode(),this.testPhoneSignIn(),this.testCreatePersonalRoom(),this.testJoinPersonalRoomByPin()},t.prototype.testGetVerificationCode=function(){var e=this,t=new SendVerificationCodeData({country_code:"86",phone_number:"13982100549"});this.actionModel.sendVerificationCode(t,function(t){e.assert("测试请求发送验证码",!0),e.hashDigest=t.hash_digest,e.expireISOTime=t.expire_iso_time,e.testPhoneSignUp()},function(t){e.assert("测试请求发送验证码",!1)})},t.prototype.testPhoneSignUp=function(){var e=this,t=new PhoneSignUpData({country_code:"86",phone_number:"13982100549",password:"qwerty",verification_code:"123456",hash_digest:this.hashDigest,expire_iso_time:this.expireISOTime,username:"ieffffff",nickname:"David Lee",birthday:"2000-01-01"});this.actionModel.signUp(t,function(t){e.assert("测试用户手机注册",!0)},function(t){e.assert("测试用户手机注册 "+t.message,!1)})},t.prototype.testPhoneSignIn=function(){var e=this,t=new PhoneAndPasswordSignInData({country_code:"86",phone_number:"13982100549",password:"123456"});this.actionModel.signIn(t,function(t){egret.log(t),e.assert("手机密码登录",!0)},function(t){e.assert("手机密码登录 : "+t.message,!1)})},t.prototype.testCreatePersonalRoom=function(){var e=this,t=new CreatePersonalRoomData({});this.actionModel.createPersonalRoom(t,function(t){UserModel.sharedInstance().personalRoomModel.setPin(t.pin),UserModel.sharedInstance().personalRoomModel.setId(t.id),UserModel.sharedInstance().personalRoomModel.setPlayers(t.players),e.assertEquals("房间的pin应该是 "+t.pin,t.pin,UserModel.sharedInstance().personalRoomModel.getPin()),e.assertEquals("房间的id应该是 "+t.id,t.id,UserModel.sharedInstance().personalRoomModel.getId()),e.assertEquals("房间的玩家数应该是 "+t.players.length,t.players.length,UserModel.sharedInstance().personalRoomModel.getPlayers().length)},function(t){e.assert("创建私人房间出错，错误是："+t.message,!1)})},t.prototype.testJoinPersonalRoomByPin=function(){var e=this,t=new JoinPersonalRoomData({pin:UserModel.sharedInstance().personalRoomModel.getPin()});this.actionModel.joinPersonalRoomByPin(t,function(t){UserModel.sharedInstance().personalRoomModel.setPlayers(t.players),e.assertEquals("房间的玩家数应该是 "+t.players.length,t.players.length,UserModel.sharedInstance().personalRoomModel.getPlayers().length),e.assertEquals("房间邀请码应该是 "+t.pin,t.pin,UserModel.sharedInstance().personalRoomModel.getPin())},function(t){e.assert("加入个人房间出错，错误是："+t.message,!1)})},t}(QPTestCase);__reflect(TestUserActionModel.prototype,"TestUserActionModel");var PhoneUserActionDataFactory=function(){function e(){}return e.prototype.makeSendVerificationCodeData=function(){return new SendVerificationCodeData({country_code:UserModel.sharedInstance().inputtedAttributeModel.getCountryCode(),phone_number:UserModel.sharedInstance().inputtedAttributeModel.getPhoneNumber()})},e.prototype.makeSignUpData=function(){return new PhoneSignUpData({country_code:UserModel.sharedInstance().inputtedAttributeModel.getCountryCode(),phone_number:UserModel.sharedInstance().inputtedAttributeModel.getPhoneNumber(),password:UserModel.sharedInstance().inputtedAttributeModel.getPassword(),username:UserModel.sharedInstance().inputtedAttributeModel.getUsername(),nickname:UserModel.sharedInstance().inputtedAttributeModel.getNickname(),birthday:UserModel.sharedInstance().inputtedAttributeModel.getBirthday(),verification_code:UserModel.sharedInstance().inputtedAttributeModel.getVerificationCode(),hash_digest:UserModel.sharedInstance().attributeModel.getHashDigest(),expire_iso_time:UserModel.sharedInstance().attributeModel.getExpireISOTime()})},e.prototype.makeSignInData=function(){return new PhoneAndPasswordSignInData({country_code:UserModel.sharedInstance().inputtedAttributeModel.getCountryCode(),phone_number:UserModel.sharedInstance().inputtedAttributeModel.getPhoneNumber(),password:UserModel.sharedInstance().inputtedAttributeModel.getPassword()})},e.prototype.makeSignOutData=function(){},e.prototype.makeBindPhoneData=function(){throw new Error("电话登录用户不用绑定手机号")},e.prototype.makeCreatePersonalRoomData=function(){return new CreatePersonalRoomData({})},e.prototype.makeJoinPersonalRoomData=function(){return new JoinPersonalRoomData({pin:UserModel.sharedInstance().personalRoomModel.getPin()})},e}();__reflect(PhoneUserActionDataFactory.prototype,"PhoneUserActionDataFactory",["IUserActionDataFactory"]);var TouristUserActionDataFactory=function(){function e(){}return e.prototype.makeSendVerificationCodeData=function(){return new SendVerificationCodeData({country_code:UserModel.sharedInstance().inputtedAttributeModel.getCountryCode(),phone_number:UserModel.sharedInstance().inputtedAttributeModel.getPhoneNumber()})},e.prototype.makeSignUpData=function(){return new TouristRegisterData({password:UserModel.sharedInstance().attributeModel.password})},e.prototype.makeSignInData=function(){return new TouristSignInData({user_id:UserModel.sharedInstance().attributeModel.id,password:UserModel.sharedInstance().attributeModel.password})},e.prototype.makeSignOutData=function(){},e.prototype.makeBindPhoneData=function(){return new BindPhoneData({country_code:UserModel.sharedInstance().inputtedAttributeModel.getCountryCode(),phone_number:UserModel.sharedInstance().inputtedAttributeModel.getPhoneNumber(),password:UserModel.sharedInstance().inputtedAttributeModel.getPassword(),verification_code:UserModel.sharedInstance().inputtedAttributeModel.getVerificationCode(),hash_digest:UserModel.sharedInstance().attributeModel.getHashDigest(),expire_iso_time:UserModel.sharedInstance().attributeModel.getExpireISOTime()})},e.prototype.makeCreatePersonalRoomData=function(){throw new Error("游客玩家不能创建个人房间")},e.prototype.makeJoinPersonalRoomData=function(){throw new Error("游客玩家不能加入个人房间")},e}();__reflect(TouristUserActionDataFactory.prototype,"TouristUserActionDataFactory",["IUserActionDataFactory"]);var UserActionModel=function(e){function t(){var n=e.call(this)||this;return n.httpAction=new HttpActionModel,n.isAgreementReaded=DDZCacheModel.sharedInstance().booleanForKey(t.SAVE_READ_AGREEMENT_KEY),n.isAgreementApproved=DDZCacheModel.sharedInstance().booleanForKey(t.SAVE_APPROVED_AGREEMENT_KEY),n}return __extends(t,e),t.prototype.readAgreement=function(){this.isAgreementReaded=!0,DDZCacheModel.sharedInstance().setBoolean(t.SAVE_READ_AGREEMENT_KEY,this.isAgreementReaded)},t.prototype.approveAgreement=function(e){this.isAgreementApproved=e,DDZCacheModel.sharedInstance().setBoolean(t.SAVE_APPROVED_AGREEMENT_KEY,this.isAgreementApproved)},t.prototype.sendVerificationCode=function(e,t,n){return e.isLegal?void this.httpAction.executePost(e,function(e){t(e)},function(e){n(e)}):void n(new QPNetworkError({message:e.validateMessage}))},t.prototype.signUp=function(e,t,n){return e.isLegal?void this.httpAction.executePost(e,function(e){t(e)},function(e){n(e)}):void n(new QPNetworkError({message:e.validateMessage}))},t.prototype.signIn=function(e,t,n){return e.isLegal?void this.httpAction.executePost(e,function(e){t(e)},function(e){n(e)}):void n(new QPNetworkError({message:e.validateMessage}))},t.prototype.signOut=function(e,t,n){},t.prototype.bindPhone=function(e,t,n){return e.isLegal?void this.httpAction.executePost(e,function(e){t(e)},function(e){n(e)}):void n(new QPNetworkError({message:e.validateMessage}))},t.prototype.createPersonalRoom=function(e,t,n){this.httpAction.executePost(e,function(e){t(e)},function(e){n(e)})},t.prototype.joinPersonalRoomByPin=function(e,t,n){return e.isLegal?void this.httpAction.executePost(e,function(e){t(e)},function(e){n(e)}):void n(new QPNetworkError({message:e.validateMessage}))},t.SAVE_READ_AGREEMENT_KEY="save.user.is.read.agreement.key",t.SAVE_APPROVED_AGREEMENT_KEY="save.user.is.approved.agreement.key",t}(QPNetworkApi);__reflect(UserActionModel.prototype,"UserActionModel",["IUserAction"]);var BindPhoneData=function(e){function t(t){var n=e.call(this,t)||this;return n.body.country_code=t.country_code,n.body.phone_number=t.phone_number,n.body.password=t.password,n.body.verification_code=t.verification_code,n.body.hash_digest=t.hash_digest,n.body.expire_iso_time=t.expire_iso_time,n.needAuthorization=!0,n.url=QPApiConfig.Host+"/"+QPApiConfig.V1+"/user/bind_phone/",n}return __extends(t,e),t.prototype.validate=function(e){return this.isLegal=!1,e.phone_number?e.phone_number.length<11?void(this.validateMessage="请输入正确的电话号码"):e.password?e.password.length<6?void(this.validateMessage="密码长度不能小于6"):50<e.password.length?void(this.validateMessage="密码长度不能大于50"):e.verification_code?6!==e.verification_code.length?void(this.validateMessage="请输入6位数验证码"):void(this.isLegal=!0):void(this.validateMessage="请输入验证码"):void(this.validateMessage="请输入密码"):void(this.validateMessage="请输入电话号码")},t}(HttpActionData);__reflect(BindPhoneData.prototype,"BindPhoneData");var SendVerificationCodeData=function(e){function t(t){var n=e.call(this,t)||this;return n.body.country_code=t.country_code,n.body.phone_number=t.phone_number,n.url=QPApiConfig.Host+"/"+QPApiConfig.V1+"/sms/code/",n.needAuthorization=!1,n}return __extends(t,e),t.prototype.validate=function(e){return e.phone_number?e.phone_number.length<11?(this.validateMessage="请输入正确的电话号码",void(this.isLegal=!1)):void(this.isLegal=!0):(this.validateMessage="请输入电话号码",void(this.isLegal=!1))},t}(HttpActionData);__reflect(SendVerificationCodeData.prototype,"SendVerificationCodeData");var CreatePersonalRoomData=function(e){function t(t){var n=e.call(this,t)||this;return n.needAuthorization=!0,n.url=QPApiConfig.Host+"/"+QPApiConfig.V1+"/room",n}return __extends(t,e),t.prototype.validate=function(e){this.isLegal=!0},t}(HttpActionData);__reflect(CreatePersonalRoomData.prototype,"CreatePersonalRoomData");var JoinPersonalRoomData=function(e){function t(t){var n=e.call(this,t)||this;return n.body={pin:t.pin},n.needAuthorization=!0,n.url=QPApiConfig.Host+"/"+QPApiConfig.V1+"/room/join",n}return __extends(t,e),t.prototype.validate=function(e){return e.pin?void(this.isLegal=!0):(this.validateMessage="请提供想要加入房间的邀请码",void(this.isLegal=!1))},t}(HttpActionData);__reflect(JoinPersonalRoomData.prototype,"JoinPersonalRoomData");var PhoneAndPasswordSignInData=function(e){function t(t){var n=e.call(this,t)||this;return n.body.country_code=t.country_code,n.body.phone_number=t.phone_number,n.body.password=t.password,n.url=QPApiConfig.Host+"/"+QPApiConfig.V1+"/user/login/phone/",n.needAuthorization=!1,n}return __extends(t,e),t.prototype.validate=function(e){return e.phone_number?e.phone_number.length<11?(this.validateMessage="请输入正确的电话号码",void(this.isLegal=!1)):e.password?e.password.length<6?(this.validateMessage="密码长度不能小于6",void(this.isLegal=!1)):50<e.password.length?(this.validateMessage="密码长度不能大于50",void(this.isLegal=!1)):void(this.isLegal=!0):(this.validateMessage="请输入密码",void(this.isLegal=!1)):(this.validateMessage="请输入电话号码",void(this.isLegal=!1))},t}(HttpActionData);__reflect(PhoneAndPasswordSignInData.prototype,"PhoneAndPasswordSignInData");var PhoneAndVerifyCodeLoginData=function(e){function t(t){var n=e.call(this,t)||this;return n.body.country_code=t.country_code,n.body.phone_number=t.phone_number,n.body.verifycation_code=t.verifycation_code,n.body.hash_digest=t.hash_digest,n.body.expire_iso_time=t.expire_iso_time,n.url=QPApiConfig.Host+"/"+QPApiConfig.V1+"/user/login/phone/",n.needAuthorization=!1,n}return __extends(t,e),t.prototype.validate=function(e){this.validateMessage="暂不提供手机验证登录方式",this.isLegal=!1},t}(HttpActionData);__reflect(PhoneAndVerifyCodeLoginData.prototype,"PhoneAndVerifyCodeLoginData");var TouristSignInData=function(e){function t(t){var n=e.call(this,t)||this;return n.body.user_id=t.user_id,n.body.password=t.password,n.url=QPApiConfig.Host+"/"+QPApiConfig.V1+"/user/login/anonymous/",n.needAuthorization=!1,n}return __extends(t,e),t.prototype.validate=function(e){return e.user_id?e.password?e.password.length<6?(this.validateMessage="密码长度不能小于6",void(this.isLegal=!1)):50<e.password.length?(this.validateMessage="密码长度不能大于50",void(this.isLegal=!1)):void(this.isLegal=!0):(this.validateMessage="请输入密码",void(this.isLegal=!1)):(this.validateMessage="没有用户名",void(this.isLegal=!1))},t}(HttpActionData);__reflect(TouristSignInData.prototype,"TouristSignInData");var PhoneSignUpData=function(e){function t(t){var n=e.call(this,t)||this;return n.body.country_code=t.country_code,n.body.phone_number=t.phone_number,n.body.username=t.username,n.body.nickname=t.nickname,n.body.birthday=t.birthday,n.body.password=t.password,n.body.verification_code=t.verification_code,n.body.hash_digest=t.hash_digest,n.body.expire_iso_time=t.expire_iso_time,n.url=QPApiConfig.Host+"/"+QPApiConfig.V1+"/user/register/phone/",n.needAuthorization=!1,n}return __extends(t,e),t.prototype.validate=function(e){return this.isLegal=!1,e.phone_number?e.phone_number.length<11?void(this.validateMessage="请输入正确的电话号码"):e.password?e.password.length<6?void(this.validateMessage="密码长度不能小于6"):50<e.password.length?void(this.validateMessage="密码长度不能大于50"):e.verification_code?6!==e.verification_code.length?void(this.validateMessage="请输入6位数验证码"):void(this.isLegal=!0):void(this.validateMessage="请输入验证码"):void(this.validateMessage="请输入密码"):void(this.validateMessage="请输入电话号码")},t}(HttpActionData);__reflect(PhoneSignUpData.prototype,"PhoneSignUpData");var TouristRegisterData=function(e){function t(t){var n=e.call(this,t)||this;return n.body.password=t.password,n.url=QPApiConfig.Host+"/"+QPApiConfig.V1+"/user/register/anonymous/",n.needAuthorization=!1,n}return __extends(t,e),t.prototype.validate=function(e){return e.password?e.password.length<6?(this.validateMessage="密码长度不能小于6",void(this.isLegal=!1)):50<e.password.length?(this.validateMessage="密码长度不能大于50",void(this.isLegal=!1)):void(this.isLegal=!0):(this.validateMessage="请输入密码",void(this.isLegal=!1))},t}(HttpActionData);__reflect(TouristRegisterData.prototype,"TouristRegisterData");var DDZAccountSignInScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZAccountSignInSceneUI",t.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.goBack,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.popup.pressRegisterHandler=this.register.bind(this),this.popup.pressForgetPasswordHandler=this.forgetPassword.bind(this),this.popup.pressSignInHandler=this.signIn.bind(this)},t.prototype.goBack=function(){qp.SceneManager.sharedInstance().replaceScene(new DDZUserAgreementScene)},t.prototype.register=function(){qp.SceneManager.sharedInstance().pushScene(new DDZAccountRegisterScene)},t.prototype.forgetPassword=function(){},t.prototype.signIn=function(e,t){var n=this;UserModel.sharedInstance().inputtedAttributeModel.setPhoneNumber(e),UserModel.sharedInstance().inputtedAttributeModel.setPassword(t),this.signInLoading=new QPLoadingScene,this.signInLoading.show();var a=UserModel.sharedInstance().actionDataFactory.makeSignInData();UserModel.sharedInstance().actionModel.signIn(a,function(e){UserModel.sharedInstance().saveUserInformation(e),n.goHomeScene()},function(e){n.signInLoading.hide(),QPAlert.sharedInstance().showOKButtonAt(n,e.message)})},t.prototype.goHomeScene=function(){var e=this;UserModel.sharedInstance().connectRealtimeGameService(function(t){return e.signInLoading.hide(),t?void QPAlert.sharedInstance().showOKButtonAt(e,t.message):void qp.SceneManager.sharedInstance().replaceScene(new DDZHomeScene)})},t}(QPScene);__reflect(DDZAccountSignInScene.prototype,"DDZAccountSignInScene");var InputtedAttributeModel=function(){function e(){this.countryCode="86"}return e.prototype.setCountryCode=function(e){this.countryCode=e},e.prototype.getCountryCode=function(){return this.countryCode},e.prototype.setPhoneNumber=function(e){this.phoneNumber=e},e.prototype.getPhoneNumber=function(){return this.phoneNumber},e.prototype.setPassword=function(e){this.password=e},e.prototype.getPassword=function(){return this.password},e.prototype.setVerificationCode=function(e){this.verificationCode=e},e.prototype.getVerificationCode=function(){return this.verificationCode},e.prototype.setFirstName=function(e){this.firstName=e},e.prototype.getFirstName=function(){return this.firstName},e.prototype.setLastName=function(e){this.lastName=e},e.prototype.getLastName=function(){return this.lastName},e.prototype.hasAccountAndPassword=function(){return this.phoneNumber&&this.password?!0:!1},e.prototype.hasNickname=function(){return this.firstName||this.lastName?!0:!1},e.prototype.getNickname=function(){var e="";return this.firstName&&(e+=this.firstName),this.lastName&&(e+=this.lastName),e},e.prototype.setUsername=function(e){this.username=e},e.prototype.getUsername=function(){return this.username},e.prototype.setBirthday=function(e){this.birthday=e},e.prototype.getBirthday=function(){return this.birthday},e}();__reflect(InputtedAttributeModel.prototype,"InputtedAttributeModel",["IInputtedAttribute"]);var PersonalRoomModel=function(){function e(){}return e.prototype.setPin=function(e){this.pin=e},e.prototype.getPin=function(){return this.pin},e.prototype.setId=function(e){this.id=e},e.prototype.getId=function(){return this.id},e.prototype.setPlayers=function(e){this.players=[];for(var t=0,n=e;t<n.length;t++){var a=n[t],r=new DDZPlayerJoinGameInformation({id:a.id,service_id:a.username,nickname:a.nickname,gender:a.gender,seat:a.seat});this.players.push(r)}},e.prototype.getPlayers=function(){return this.players},e}();__reflect(PersonalRoomModel.prototype,"PersonalRoomModel",["IPersonalRoom"]);var PhoneUserAttributeModel=function(e){function t(){var n=e.call(this)||this;return n.hasSignUp=DDZCacheModel.sharedInstance().booleanForKey(t.SIGN_UP_STATE_KEY),n}return __extends(t,e),t.prototype.setHasSignUp=function(e){this.hasSignUp=e,DDZCacheModel.sharedInstance().setBoolean(t.SIGN_UP_STATE_KEY,e)},t.SIGN_UP_STATE_KEY="phone.user.register.state.key",t}(BaseUserAttributeModel);__reflect(PhoneUserAttributeModel.prototype,"PhoneUserAttributeModel");var TouristUserAttributeModel=function(e){function t(){var n=e.call(this)||this;return n.password=DDZCacheModel.sharedInstance().stringForKey(t.PASSWORD_KEY),n.password||(n.password=UUID.generate(),DDZCacheModel.sharedInstance().setString(t.PASSWORD_KEY,n.password)),n.id=DDZCacheModel.sharedInstance().stringForKey(t.USER_ID_KEY),n.hasSignUp=DDZCacheModel.sharedInstance().booleanForKey(t.SIGN_UP_STATE_KEY),n.hasBindPhoneNumber=DDZCacheModel.sharedInstance().booleanForKey(t.HAS_BIND_PHONE_NUMBER_KEY),n}return __extends(t,e),t.prototype.setId=function(e){if(!e)throw new Error("尝试为用户设置空id");this.id=e,DDZCacheModel.sharedInstance().setString(t.USER_ID_KEY,this.id)},t.prototype.deleteAccount=function(){this.id=void 0,this.setHasSignUp(!1),this.setHasBindPhoneNumber(!1),DDZCacheModel.sharedInstance().removeItemForKey(t.USER_ID_KEY)},t.prototype.setHasSignUp=function(e){this.hasSignUp=e,DDZCacheModel.sharedInstance().setBoolean(t.SIGN_UP_STATE_KEY,e)},t.prototype.setHasBindPhoneNumber=function(e){this.hasBindPhoneNumber=e,DDZCacheModel.sharedInstance().setBoolean(t.HAS_BIND_PHONE_NUMBER_KEY,e)},t.PASSWORD_KEY="tourist.user.password.save.key",t.USER_ID_KEY="tourist.user.id.save.key",t.SIGN_UP_STATE_KEY="tourist.user.register.state.key",t.HAS_BIND_PHONE_NUMBER_KEY="tourist.user.has.bind.phone.number.key",t}(BaseUserAttributeModel);__reflect(TouristUserAttributeModel.prototype,"TouristUserAttributeModel");var GenderFactory=function(){function e(){}return e.createGender=function(e){return"male"===e?new GenderMale:"female"===e?new GenderFeMale:new GenderNull},e}();__reflect(GenderFactory.prototype,"GenderFactory");var GenderFeMale=function(){function e(){this.name="female",this.iconSource="img_userinfo_female@2x_png"}return e.prototype.isMale=function(){return!1},e}();__reflect(GenderFeMale.prototype,"GenderFeMale",["IGender"]);var GenderMale=function(){function e(){this.name="male",this.iconSource="img_userinfo_male@2x_png"}return e.prototype.isMale=function(){return!0},e}();__reflect(GenderMale.prototype,"GenderMale",["IGender"]);var GenderNull=function(){function e(){this.name="null",this.iconSource=""}return e.prototype.isMale=function(){return!1},e}();__reflect(GenderNull.prototype,"GenderNull",["IGender"]);var DDZPackageScene=function(e){function t(t){var n=e.call(this)||this;return n.skinName="DDZPackageSceneUI",n.backgroundImage.source=t,n.popup.pressBackButtonHandler=n.goBack.bind(n),n}return __extends(t,e),t.prototype.goBack=function(){qp.SceneManager.sharedInstance().popScene()},t}(QPScene);__reflect(DDZPackageScene.prototype,"DDZPackageScene");var testProps=[{amount:2,name:"圣诞大礼包"},{amount:5,name:"双11大礼包"},{amount:8,name:"双12大礼包"},{amount:1,name:"元旦大礼包"},{amount:2,name:"春节大礼包"},{amount:9,name:"春季大礼包"}],DDZPackageModel=function(){function e(){}return e.prototype.fetchProps=function(e,t){e(testProps)},e}();__reflect(DDZPackageModel.prototype,"DDZPackageModel");var DDZPackageListCell=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPackageListCellUI",t.useButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressUseButton,t),t}return __extends(t,e),t.prototype.onPressUseButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1)},t}(eui.ItemRenderer);__reflect(DDZPackageListCell.prototype,"DDZPackageListCell");var DDZPackagePopup=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPackagePopupUI",t.leftToggle.addEventListener(eui.UIEvent.CHANGE,t.toggleChangedHandler,t),t.middleToggle.addEventListener(eui.UIEvent.CHANGE,t.toggleChangedHandler,t),t.rightToggle.addEventListener(eui.UIEvent.CHANGE,t.toggleChangedHandler,t),t.packageModel=new DDZPackageModel,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.emptyContentView.visible=!1,this.contentScroller.viewport=this.contentList,this.createContentList(),this.closeButton.pressHandler=this.onPressCloseButton.bind(this)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.leftToggle.selected=!0},t.prototype.createContentList=function(){var e=this;this.packageModel.fetchProps(function(t){e.emptyContentView.visible=0===t.length,e.contentList.dataProvider=new eui.ArrayCollection(t),e.contentList.itemRenderer=DDZPackageListCell,e.contentList.addEventListener(eui.ItemTapEvent.ITEM_TAP,e.onPressPackageItem,e)},function(){egret.log("fetch props error.")})},t.prototype.onPressPackageItem=function(e){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),QPAlert.sharedInstance().showAt(this.parent,"暂未开放此功能，敬请期待"),egret.log(e)},t.prototype.toggleChangedHandler=function(e){var t=this;QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.leftToggle===e.target&&(this.packageModel.fetchProps(function(e){t.emptyContentView.visible=0===e.length,t.contentList.dataProvider=new eui.ArrayCollection(e)},function(){egret.log("fetch  props error")}),this.leftToggle.selected=!0,this.middleToggle.selected=!1,this.rightToggle.selected=!1),this.middleToggle===e.target&&(this.emptyContentView.visible=!0,this.contentList.dataProvider=new eui.ArrayCollection([]),this.leftToggle.selected=!1,this.middleToggle.selected=!0,this.rightToggle.selected=!1),this.rightToggle===e.target&&(this.emptyContentView.visible=!0,this.contentList.dataProvider=new eui.ArrayCollection([]),this.leftToggle.selected=!1,this.middleToggle.selected=!1,this.rightToggle.selected=!0)
},t.prototype.onPressCloseButton=function(){this.pressBackButtonHandler()},t}(QPPopupLayer);__reflect(DDZPackagePopup.prototype,"DDZPackagePopup");var DDZPlayGameDebugWindow=function(e){function t(){var t=e.call(this)||this;return t.messageCount=0,t}return __extends(t,e),t.prototype.setRoomId=function(e){this.roomIdLabel.text="房间："+e},t.prototype.setServerAddress=function(e){this.serverLabel.text="服务器: "+e},t.prototype.setGameMatchId=function(e){e&&(this.gameMatchIdLabel.text="游戏："+e)},t.prototype.addMessage=function(e){if(e){var t=JSON.stringify(e),n=new eui.Label(t);n.textColor=16777215,n.size=25,n.y=50*this.messageCount,this.contentGroup.addChild(n),this.messageCount+=1}},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.contentScroller.viewport=this.contentGroup;var t=RES.getRes("app_version_json");this.setAppVersion(t.version)},t.prototype.setAppVersion=function(e){this.appVersionLabel.text="版本："+e},t}(QPLayer);__reflect(DDZPlayGameDebugWindow.prototype,"DDZPlayGameDebugWindow");var DDZPlayGameScene=function(e){function t(t){var n=e.call(this)||this;return n.skinName="DDZPlayGameSceneUI",n.gameModel=t,n.invitePlayerPopup=new InvitePlayerPopupLayer,n.setup(),n}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this),this.addListeners()},t.prototype.onExit=function(){e.prototype.onExit.call(this),this.gameModel.removeWebsocketMonitor(),this.gameModel=void 0,this.removeListeners(),this.matchPlayerView.hide()},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.playMusic(),this.setPlayersCharacterImage(),this.matchPlayerView.showWaitForStartGame(),this.setLeftPlayerViewVisible(!1),this.leftPlayerView.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showLeftPlayerDetailInfo,this),this.setRightPlayerViewVisible(!1),this.rightPlayerView.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showRightPlayerDetailInfo,this),this.bottomPlayerView.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showBottomPlayerDetailInfo,this),this.showPlayers()},t.prototype.childrenCreated=function(){if(e.prototype.childrenCreated.call(this),DDZGameState.Model.sharedInstance().isInGame()){var t={playCardGameRestored:this.playCardGameRestored.bind(this),becomeLandlordGameRestored:this.becomeLandlordGameRestored.bind(this)};this.gameModel.restoreGame(t)}this.updateDebugWindowContent(),this.showInvitePlayerPopup()},t.prototype.updateDebugWindowContent=function(){this.debugWindow.setRoomId(this.gameModel.game.roomId),this.debugWindow.setServerAddress(QPApiConfig.Host),this.debugWindow.setGameMatchId(this.gameModel.game.getMatchId())},t.prototype.showInvitePlayerPopup=function(){if(!this.gameModel.isPlayersFull()){var e=UserModel.sharedInstance().personalRoomModel.getPin();egret.log("房间的pin是",e);var t="您可以复制这条消息并分享给好友,邀请好友加入您创建的私人房间一起来玩斗地主!!! 房间号: ["+e+"],快去告诉Ta!";this.invitePlayerPopup.verticalCenter=0,this.invitePlayerPopup.horizontalCenter=0,this.invitePlayerPopup.setInvitationMessage(t),this.invitePlayerPopup.show()}},t.prototype.addListeners=function(){DDZEventCenter.sharedInstance().addEventListener(DDZHandCardEvent.TOUCHED,this.handCardTouched,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.PLAY_CARD,this.playCard,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.HINT,this.hint,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.NOT_PLAY_CARD,this.notPlayCardButtonPressed,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.NOT_CALL_LANDLORD,this.notCallLandlord,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.CALL_ONE_POINT,this.callOnePoint,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.CALL_TWO_POINT,this.callTwoPoint,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.CALL_THREE_POINT,this.callThreePoint,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.START_GAME,this.startMatchPlayer,this),DDZEventCenter.sharedInstance().addEventListener(DDZDebugEvent.DEBUG_ROOM_CHANNEL,this.receiveDebugMessage,this),DDZEventCenter.sharedInstance().addEventListener(DDZNetworkEvent.CONNECT_TO_SERVER_EVENT,this.fetchUserGameState,this),DDZEventCenter.sharedInstance().addEventListener(DDZMusicEvent.PLAY_MUSIC_EVENT,this.playMusic,this),DDZEventCenter.sharedInstance().addEventListener(DDZMusicEvent.STOP_MUSIC_EVENT,this.stopMusic,this),DDZEventCenter.sharedInstance().addEventListener(DDZWebsocketEvent.MISS_MESSAGE_EVENT,this.fetchUserGameState,this)},t.prototype.removeListeners=function(){DDZEventCenter.sharedInstance().removeEventListener(DDZHandCardEvent.TOUCHED,this.handCardTouched,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.PLAY_CARD,this.playCard,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.HINT,this.hint,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.NOT_PLAY_CARD,this.notPlayCardButtonPressed,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.NOT_CALL_LANDLORD,this.notCallLandlord,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.CALL_ONE_POINT,this.callOnePoint,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.CALL_TWO_POINT,this.callTwoPoint,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.CALL_THREE_POINT,this.callThreePoint,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.START_GAME,this.startMatchPlayer,this),DDZEventCenter.sharedInstance().removeEventListener(DDZDebugEvent.DEBUG_ROOM_CHANNEL,this.receiveDebugMessage,this),DDZEventCenter.sharedInstance().removeEventListener(DDZNetworkEvent.CONNECT_TO_SERVER_EVENT,this.fetchUserGameState,this),DDZEventCenter.sharedInstance().removeEventListener(DDZMusicEvent.PLAY_MUSIC_EVENT,this.playMusic,this),DDZEventCenter.sharedInstance().removeEventListener(DDZMusicEvent.STOP_MUSIC_EVENT,this.stopMusic,this),DDZEventCenter.sharedInstance().removeEventListener(DDZWebsocketEvent.MISS_MESSAGE_EVENT,this.fetchUserGameState,this)},t.prototype.receiveDebugMessage=function(e){this.debugWindow.addMessage(e.messageObject)},t.prototype.showSettingsScene=function(){var e=Device.sharedInstance().screenShoot(this);qp.SceneManager.sharedInstance().pushScene(new DDZSettingsScene(e))},t.prototype.setLeftPlayerViewVisible=function(e){e&&this.leftPlayerView.setCharacterImageSource(this.gameModel.leftPlayerModel.getPlayGameCharacterSource()),this.leftPlayerView.visible=e,this.leftPlayerGameInfoView.visible=e,this.leftPlayerInfo.visible=e},t.prototype.setRightPlayerViewVisible=function(e){e&&this.rightPlayerView.setCharacterImageSource(this.gameModel.rightPlayerModel.getPlayGameCharacterSource()),this.rightPlayerView.visible=e,this.rightPlayerGameInfoView.visible=e,this.rightPlayerInfo.visible=e},t.prototype.setup=function(){this.leftPlayerPlayedCardListView.setAnimation(new DDZCardListLeftToRightAnimation({target:this.leftPlayerPlayedCardListView.cardList})),this.rightPlayerPlayedCardListView.setAnimation(new DDZCardListRightToLeftAnimation({target:this.rightPlayerPlayedCardListView.cardList})),this.topToolbar.pressSettingsHandler=this.showSettingsScene.bind(this),this.topToolbar.pressBackHandler=this.leaveGamePressed.bind(this),this.topToolbar.pressTaskHandler=this.showTaskScene.bind(this),this.topToolbar.pressPackageHandler=this.showPackageScene.bind(this),this.bottomToolbar.pressChatButtonHandler=this.showChatView.bind(this),this.bottomPlayerHandCardsView.dealCardAnimationDidFinishedHandler=this.startCallingLandlord.bind(this),this.gameModel.gameOverHandler=this.gameOver.bind(this),this.gameModel.showPlayerHandler=this.showPlayers.bind(this),this.gameModel.hidePlayerHandler=this.hidePlayer.bind(this),this.gameModel.playerPlayedCardsHandler=this.playerPlayedCards.bind(this),this.gameModel.nextPlayCardPlayerHandler=this.nextPlayCardPlayer.bind(this),this.gameModel.nextCallLandlordPlayerHandler=this.nextCallLandlordPlayer.bind(this),this.gameModel.playerCalledLandlordHandler=this.showPlayerCallLandlordResult.bind(this),this.gameModel.dealCardsHandler=this.dealCards.bind(this),this.gameModel.dealCardsAgainHandler=this.reDealCards.bind(this),this.gameModel.gameLandlordConfirmedHandler=this.gameLandlordHasBeenConfirmed.bind(this)},t.prototype.showChatView=function(){QPAlert.sharedInstance().showAt(this,"此功能暂未开放，敬请期待")},t.prototype.showTaskScene=function(){var e=Device.sharedInstance().screenShoot(this);qp.SceneManager.sharedInstance().pushScene(new DDZTaskScene(e))},t.prototype.showPackageScene=function(){var e=Device.sharedInstance().screenShoot(this);qp.SceneManager.sharedInstance().pushScene(new DDZPackageScene(e))},t.prototype.leaveGamePressed=function(){var e=this;return this.gameModel.isStarted?(QPAlert.sharedInstance().showCancelAndQuitButtonAt(this,"现在离开会由系统机器人代打，输了可别怪他哟！"),void(QPAlert.sharedInstance().pressedQuitHandler=function(){e.leaveGame()})):void this.leaveGame()},t.prototype.leaveGame=function(){var e=this,t=new QPLoadingScene;t.show("离开房间中"),this.gameModel.bottomPlayerModel.leaveRoom(function(n){return t.hide(),n?void QPAlert.sharedInstance().showOKButtonAt(e,n.message):(e.invitePlayerPopup.hide(),void qp.SceneManager.sharedInstance().replaceScene(new DDZHomeScene))})},t.prototype.handCardTouched=function(){if(this.gameModel.bottomPlayerModel.handCardModel.isSelectedCardLegal())this.dispatchEnablePlayCardButtonEvent();else{var e=new DDZButtonEvent(DDZButtonEvent.DISABLE_PLAY_CARD_BUTTON);DDZEventCenter.sharedInstance().dispatchEvent(e)}},t.prototype.dispatchEnablePlayCardButtonEvent=function(){var e=new DDZButtonEvent(DDZButtonEvent.ENABLE_PLAY_CARD_BUTTON);DDZEventCenter.sharedInstance().dispatchEvent(e)},t.prototype.startCallingLandlord=function(){this.gameModel.isBottomPlayerCallingLandlord()?this.playGameButtonsContainer.showCallLandlordButtons():this.gameModel.isLeftPlayerCallingLandlord()?this.leftPlayerGameInfoView.showActiveSign():this.gameModel.isRightPlayerCallingLandlord()&&this.rightPlayerGameInfoView.showActiveSign()},t.prototype.playerPlayedCards=function(e){1===e?this.bottomPlayerPlayedCards():2===e?this.leftPlayerPlayedCards():3===e&&this.rightPlayerPlayedCards()},t.prototype.bottomPlayerPlayedCards=function(){var e=this.gameModel.bottomPlayerModel.listLastPlayedCards();this.bottomPlayerPlayedCardListView.setCards(e),this.bottomPlayerPlayedCardListView.visible=!0,this.bottomPlayerHandCardsView.setCards(this.gameModel.bottomPlayerModel.listHandCards()),0===e.length?this.bottomPlayerStateView.setState(8):this.bottomPlayerStateView.hideAllState(),this.playGameButtonsContainer.hideAllButtons(),this.dispatchEnablePlayCardButtonEvent()},t.prototype.leftPlayerPlayedCards=function(){this.leftPlayerGameInfoView.reset(),this.showLeftPlayerPlayedCards();var e=this.gameModel.countLeftPlayerCardsAmount();this.leftPlayerGameInfoView.setRemainCardsCount(e),3>e&&this.leftPlayerGameInfoView.showWarningLightView(),0===e&&this.leftPlayerGameInfoView.hideRemainCardsView()},t.prototype.showLeftPlayerPlayedCards=function(){var e=this.gameModel.leftPlayerModel.listLastPlayedCards();return 0===e.length?void this.leftPlayerGameInfoView.showNotPlayCard():(this.leftPlayerPlayedCardListView.visible=!0,this.leftPlayerPlayedCardListView.setCards(e),void this.leftPlayerPlayedCardListView.playAnimation())},t.prototype.rightPlayerPlayedCards=function(){this.rightPlayerGameInfoView.reset(),this.showRightPlayerPlayedCards();var e=this.gameModel.countRightPlayerCardsAmount();this.rightPlayerGameInfoView.setRemainCardsCount(e),3>e&&this.rightPlayerGameInfoView.showWarningLightView(),0===e&&this.rightPlayerGameInfoView.hideRemainCardsView()},t.prototype.showRightPlayerPlayedCards=function(){var e=this.gameModel.rightPlayerModel.listLastPlayedCards();return 0===e.length?void this.rightPlayerGameInfoView.showNotPlayCard():(this.rightPlayerPlayedCardListView.visible=!0,this.rightPlayerPlayedCardListView.setCards(e),void this.rightPlayerPlayedCardListView.playAnimation())},t.prototype.gameLandlordHasBeenConfirmed=function(){var e=this;this.bottomPlayerHandCardsView.playHideBottomCardsAnimation(function(){e.leftPlayerGameInfoView.reset(),e.rightPlayerGameInfoView.reset(),e.updatePlayersStateAndCards(),e.startPlayingCard()})},t.prototype.reDealCards=function(){this.leftPlayerGameInfoView.reset(),this.rightPlayerGameInfoView.reset(),this.bottomPlayerStateView.hideAllState(),this.bottomPlayerHandCardsView.hideBottomCards()},t.prototype.updatePlayersStateAndCards=function(){this.bottomPlayerStateView.hideAllState(),this.landlordCardsView.setCards(this.gameModel.game.landlordCards),this.setPlayersCharacterImage(),this.bottomPlayerHandCardsView.setCards(this.gameModel.bottomPlayerModel.listHandCards()),this.bottomPlayerHandCardsView.hideBottomCards(),this.leftPlayerGameInfoView.setRemainCardsCount(this.gameModel.countLeftPlayerCardsAmount()),this.rightPlayerGameInfoView.setRemainCardsCount(this.gameModel.countRightPlayerCardsAmount())},t.prototype.setPlayersCharacterImage=function(){this.gameModel.isLeftPlayerExist()&&this.leftPlayerView.setCharacterImageSource(this.gameModel.leftPlayerModel.getPlayGameCharacterSource()),this.gameModel.isRightPlayerExist()&&this.rightPlayerView.setCharacterImageSource(this.gameModel.rightPlayerModel.getPlayGameCharacterSource()),this.bottomPlayerView.setCharacterImageSource(this.gameModel.bottomPlayerModel.getPlayGameCharacterSource())},t.prototype.playCardGameRestored=function(e){this.matchPlayerView.hide(),this.updatePlayersStateAndCards(),this.bottomPlayerHandCardsView.setCards(this.gameModel.bottomPlayerModel.listHandCards()),this.nextPlayCardPlayer(e),this.updateDebugWindowContent()},t.prototype.becomeLandlordGameRestored=function(e,t){this.matchPlayerView.hide(),this.updatePlayersStateAndCards(),this.bottomPlayerHandCardsView.setCards(this.gameModel.bottomPlayerModel.listHandCards()),this.bottomPlayerHandCardsView.showBottomCards(),this.nextCallLandlordPlayer(e,t),this.gameModel.bottomPlayerModel.attribute.hasCalledLandlord&&this.showBottomPlayerCallLandlord(this.gameModel.bottomPlayerModel.attribute.calledLandlordScore),this.gameModel.leftPlayerModel.attribute.hasCalledLandlord&&this.showLeftPlayerCallLandlord(this.gameModel.leftPlayerModel.attribute.calledLandlordScore),this.gameModel.rightPlayerModel.attribute.hasCalledLandlord&&this.showRightPlayerCallLandlord(this.gameModel.rightPlayerModel.attribute.calledLandlordScore),this.updateDebugWindowContent()},t.prototype.showBottomPlayerCallLandlordButtons=function(e){this.playGameButtonsContainer.showCallLandlordButtons(),1===e?this.playGameButtonsContainer.disableCallOnePointButton():2===e&&(this.playGameButtonsContainer.disableCallOnePointButton(),this.playGameButtonsContainer.disableCallTwoPointButton())},t.prototype.nextCallLandlordPlayer=function(e,t){switch(e){case 1:this.bottomPlayerStateView.hideAllState(),this.showBottomPlayerCallLandlordButtons(t);break;case 2:this.leftPlayerGameInfoView.showActiveSign();break;case 3:this.rightPlayerGameInfoView.showActiveSign()}},t.prototype.showPlayerCallLandlordResult=function(e,t){1===e?(this.showBottomPlayerCallLandlord(t),QPAudioManager.sharedInstance().playEffectSound(this.gameModel.bottomPlayerModel.getCallLandlordSoundByPoint(t),1)):2===e?(this.showLeftPlayerCallLandlord(t),QPAudioManager.sharedInstance().playEffectSound(this.gameModel.leftPlayerModel.getCallLandlordSoundByPoint(t),1)):3===e&&(this.showRightPlayerCallLandlord(t),QPAudioManager.sharedInstance().playEffectSound(this.gameModel.rightPlayerModel.getCallLandlordSoundByPoint(t),1))},t.prototype.showBottomPlayerCallLandlord=function(e){1===e?this.bottomPlayerStateView.setState(1):2===e?this.bottomPlayerStateView.setState(2):3===e?this.bottomPlayerStateView.setState(3):0===e&&this.bottomPlayerStateView.setState(4),this.playGameButtonsContainer.hideAllButtons()},t.prototype.showLeftPlayerCallLandlord=function(e){this.leftPlayerGameInfoView.reset(),0===e?this.leftPlayerGameInfoView.showNotCallLandlord():this.leftPlayerGameInfoView.setCallLandlordPoint(e)},t.prototype.showRightPlayerCallLandlord=function(e){this.rightPlayerGameInfoView.reset(),0===e?this.rightPlayerGameInfoView.showNotCallLandlord():this.rightPlayerGameInfoView.setCallLandlordPoint(e)},t.prototype.nextPlayCardPlayer=function(e){switch(this.bottomPlayerHandCardsView.hideBottomCards(),e){case 1:if(this.bottomPlayerPlayedCardListView.visible=!1,this.bottomPlayerStateView.setState(0),this.gameModel.amIWinInARound()){if(this.gameModel.resetLastPlayedCards(),this.gameModel.canIAutoPlayRemainCardsSet())return void this.autoPlayCard();this.playGameButtonsContainer.showMustPlayCardButtons()}else if(this.gameModel.doIHaveBiggerCards()){if(this.gameModel.canIAutoPlayRemainCardsSet())return void this.autoPlayCard();this.playGameButtonsContainer.showPlayCardButtons()}else this.playGameButtonsContainer.showNoBiggerCardsButtons();this.gameModel.bottomPlayerModel.handCardModel.isSelectedCardLegal()&&this.dispatchEnablePlayCardButtonEvent();break;case 2:this.leftPlayerPlayedCardListView.visible=!1,this.leftPlayerGameInfoView.showActiveSign();break;case 3:this.rightPlayerPlayedCardListView.visible=!1,this.leftPlayerGameInfoView.showActiveSign();break;case 0:this.leftPlayerGameInfoView.hideActiveSign(),this.rightPlayerGameInfoView.hideActiveSign();break;default:throw new Error("玩家类型出错了")}},t.prototype.startMatchPlayer=function(){var e=this,n=new QPLoadingScene;n.show("正在匹配玩家"),UserModel.sharedInstance().joinGame(function(e){var a={roomId:e.roomId,baseScore:e.baseScore,playerInformations:e.playerInformations};n.hide();var r=new DDZGameModel(a.roomId);r.addPlayers(a.playerInformations),r.setBaseScore(a.baseScore),qp.SceneManager.sharedInstance().replaceScene(new t(r))},function(t){n.hide(),QPAlert.sharedInstance().showAt(e,t.message),e.playGameButtonsContainer.showStartGameButton()})},t.prototype.startPlayingCard=function(){this.gameModel.isBottomPlayerLandlord()?this.playGameButtonsContainer.showMustPlayCardButtons():this.gameModel.isLeftPlayerLandlord()?this.leftPlayerGameInfoView.showActiveSign():this.gameModel.isRightPlayerLandlord()&&this.rightPlayerGameInfoView.showActiveSign()},t.prototype.showPlayers=function(){this.gameModel.isPlayersFull()&&this.invitePlayerPopup.hide(),this.gameModel.isLeftPlayerExist()&&(this.leftPlayerInfo.setInfo(this.gameModel.leftPlayerModel.attribute),this.setLeftPlayerViewVisible(!0)),this.gameModel.isRightPlayerExist()&&(this.rightPlayerInfo.setInfo(this.gameModel.rightPlayerModel.attribute),this.setRightPlayerViewVisible(!0)),this.bottomPlayerInfoView.setName(this.gameModel.bottomPlayerModel.attribute.name),this.gameModel.isPlayersFull()&&this.matchPlayerView.showWaitForStartGame()},t.prototype.hidePlayer=function(e){2===e?this.setLeftPlayerViewVisible(!1):3===e&&this.setRightPlayerViewVisible(!1)},t.prototype.dealCards=function(){this.bottomPlayerHandCardsView.dealCards(this.gameModel.bottomPlayerModel.listHandCards()),this.matchPlayerView.hide(),this.leftPlayerGameInfoView.setRemainCardsCount(this.gameModel.DefaultCardsCount),this.rightPlayerGameInfoView.setRemainCardsCount(this.gameModel.DefaultCardsCount),this.updateDebugWindowContent()},t.prototype.gameOver=function(){this.leftPlayerGameInfoView.reset(),this.rightPlayerGameInfoView.reset(),this.gameModel.isLeftPlayerPlayedAllCards()||(this.leftPlayerPlayedCardListView.setCards(this.gameModel.leftPlayerModel.listHandCards()),this.leftPlayerPlayedCardListView.visible=!0),this.gameModel.isRightPlayerPlayedAllCards()||(this.rightPlayerPlayedCardListView.setCards(this.gameModel.rightPlayerModel.listHandCards()),this.rightPlayerPlayedCardListView.visible=!0);var e=new egret.Timer(2e3,1);e.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.toGameOverScene,this),e.start()},t.prototype.toGameOverScene=function(){var e=Device.sharedInstance().screenShoot(this);qp.SceneManager.sharedInstance().replaceScene(new DDZGameOverScene(e,this.gameModel))},t.prototype.playCard=function(){var e=this,t=this.gameModel.bottomPlayerModel.listSelectedCards();this.gameModel.playCards(t,function(t){return t?void e.handlePlayCardError(t):void e.bottomPlayerPlayedCards()})},t.prototype.handlePlayCardError=function(e){this.gameModel.bottomPlayerModel.cancelSelectedCards(),this.bottomPlayerHandCardsView.setCards(this.gameModel.bottomPlayerModel.listHandCards()),this.dispatchEnablePlayCardButtonEvent(),e.type===QPNetworkErrorType.ClientCheckedWrongCardType?this.showWrongCardTypeMessage():this.fetchUserGameState()},t.prototype.showWrongCardTypeMessage=function(){var e=this;this.wrongTypeCardImage.visible=!0;var t=new egret.Timer(2e3,1);t.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){e.wrongTypeCardImage.visible=!1,t=void 0},this),t.start()},t.prototype.fetchUserGameState=function(){var e=this;QPToast.sharedInstance().showAt(this,"连接网络中..."),DDZGameState.Model.sharedInstance().fetch(function(t){if(QPToast.sharedInstance().hide(),t)return void QPAlert.sharedInstance().showAt(e,t.message);DDZGameState.Model.sharedInstance().room&&e.gameModel.addPlayers(DDZGameState.Model.sharedInstance().room.playerInformations);var n={playCardGameRestored:e.playCardGameRestored.bind(e),becomeLandlordGameRestored:e.becomeLandlordGameRestored.bind(e)};e.gameModel.restoreGame(n),DDZUserChannelModel.sharedInstance().resetMessageCounter()})},t.prototype.hint=function(){this.gameModel.hint(),this.gameModel.bottomPlayerModel.handCardModel.hasSelectedCards()&&(this.dispatchEnablePlayCardButtonEvent(),this.bottomPlayerHandCardsView.setCards(this.gameModel.bottomPlayerModel.listHandCards()))},t.prototype.notPlayCardButtonPressed=function(){this.notPlayCard()},t.prototype.autoPlayCard=function(){var e=this;this.dispatchEnablePlayCardButtonEvent(),this.gameModel.bottomPlayerModel.cancelSelectedCards();var t=this.gameModel.listAutoPlayCards();this.gameModel.playCards(t,function(t){return t?void e.handlePlayCardError(t):void e.bottomPlayerPlayedCards()})},t.prototype.notPlayCard=function(){var e=this;this.gameModel.bottomPlayerModel.cancelSelectedCards(),this.gameModel.notPlayCard(function(t){return t?(egret.log("\n\n"),void egret.log(t)):void e.bottomPlayerPlayedCards()})},t.prototype.notCallLandlord=function(){this.gameModel.bottomPlayerModel.notCallLandlord(),this.bottomPlayerStateView.setState(4),this.playGameButtonsContainer.hideAllButtons()},t.prototype.callOnePoint=function(){this.gameModel.bottomPlayerModel.callLandlord(1),this.playGameButtonsContainer.hideAllButtons()},t.prototype.callTwoPoint=function(){this.gameModel.bottomPlayerModel.callLandlord(2),this.playGameButtonsContainer.hideAllButtons()},t.prototype.callThreePoint=function(){this.gameModel.bottomPlayerModel.callLandlord(3),this.playGameButtonsContainer.hideAllButtons()},t.prototype.playMusic=function(){QPAudioManager.sharedInstance().playBackgroundMusic("ddz_play_game_music_mp3",-1)},t.prototype.stopMusic=function(){QPAudioManager.sharedInstance().stopPlayBackgroundMusic()},t.prototype.showLeftPlayerDetailInfo=function(){var e=Device.sharedInstance().screenShoot(this),t=new DDZUserInfoScene(e,this.gameModel.leftPlayerModel.attribute);t.adjustAsPlayGameMode(),qp.SceneManager.sharedInstance().pushScene(t)},t.prototype.showRightPlayerDetailInfo=function(){var e=Device.sharedInstance().screenShoot(this),t=new DDZUserInfoScene(e,this.gameModel.rightPlayerModel.attribute);t.adjustAsPlayGameMode(),qp.SceneManager.sharedInstance().pushScene(t)},t.prototype.showBottomPlayerDetailInfo=function(){var e=Device.sharedInstance().screenShoot(this),t=new DDZUserInfoScene(e,this.gameModel.bottomPlayerModel.attribute);t.adjustAsPlayGameMode(),qp.SceneManager.sharedInstance().pushScene(t)},t}(QPScene);__reflect(DDZPlayGameScene.prototype,"DDZPlayGameScene");var TestGameModel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.startTest=function(){this.testGameOver(),this.testHintTrioTakesSingle(),this.testHintTrioTakesSingleNoBiggerTrioInHand()},t.prototype.testGameOver=function(){var e=new DDZGameServiceMessageGameOverData(mockGameOverPayload);this.assertEquals("Game Action expect to end_game","end_game",e.action),this.assertEquals("room id expect to 8b2a1a3d-2fec-4cc0-b392-4512d7d3f215","8b2a1a3d-2fec-4cc0-b392-4512d7d3f215",e.roomId),this.assertEquals("game is spring expect false",!1,e.isSpring);var t=e.playerInformations[0];this.assertEquals("player's id expect to aaaaaaaa-7a8e-4f14-bdeb-df27796c39a2","aaaaaaaa-7a8e-4f14-bdeb-df27796c39a2",t.playerId),this.assertEquals("player's balance expect to 19100",19100,t.balance),this.assertEquals("player's dealt_amount expect to 300",300,t.dealtAmount),this.assertEquals("player's frozen_amount expect to 0",0,t.frozenAmount),this.assertEquals("player's total_amount expect to 19100",19100,t.totalAmount);var n=e.playerInformations[1];this.assertEquals("player's id expect to bbbbbbbb-77d8-49a4-9616-4fa07f987039","bbbbbbbb-77d8-49a4-9616-4fa07f987039",n.playerId),this.assertEquals("player's balance expect to 19100",19100,n.balance),this.assertEquals("player's dealt_amount expect to 300",300,n.dealtAmount),this.assertEquals("player's frozen_amount expect to 0",0,n.frozenAmount),this.assertEquals("player's total_amount expect to 19100",19100,n.totalAmount);var a=e.playerInformations[2];this.assertEquals("player's id expect to  cccccccc-8a2e-46c6-9723-57caa2a61c4c","cccccccc-8a2e-46c6-9723-57caa2a61c4c",a.playerId),this.assertEquals("player's balance expect to 19100",19100,a.balance),this.assertEquals("player's dealt_amount expect to -600",-600,a.dealtAmount),this.assertEquals("player's frozen_amount expect to 0",0,a.frozenAmount),this.assertEquals("player's total_amount expect to 19100",19100,a.totalAmount)},t.prototype.testHintTrioTakesSingle=function(){var e=new DDZHandCardModel,t=["8s","8h","8c","5s"].map(function(e){return new DDZCard(e)}),n=["ts","th","tc","9s","7h","2s","2s","2s"].map(function(e){return new DDZCard(e)});e.setCards(n);var a=DDZPlayCardSetFactory.createCardSet(t);e.hint(a);var r=e.listSelectedCards(),o=DDZPlayCardSetFactory.createCardSet(r);this.assertEquals("test hint trio takes single target cardtype expected to 5",5,o.cardTypeName)},t.prototype.testHintTrioTakesSingleNoBiggerTrioInHand=function(){var e=new DDZHandCardModel,t=["as","ah","ac","5s"].map(function(e){return new DDZCard(e)}),n=["ts","th","tc","9s","7h","qs","qs","qs"].map(function(e){return new DDZCard(e)});e.setCards(n);var a=DDZPlayCardSetFactory.createCardSet(t);e.hint(a);var r=e.listSelectedCards(),o="test hint trio takes single no bigger trio in hand expected found cards length 0";this.assert(o,0===r.length)},t}(QPTestCase);__reflect(TestGameModel.prototype,"TestGameModel");var mockGameOverPayload={action:"end_game",sent_at:"2018-01-31T09:50:42.849090",room_id:"8b2a1a3d-2fec-4cc0-b392-4512d7d3f215",is_slam:!1,players_information:[{player_id:"aaaaaaaa-7a8e-4f14-bdeb-df27796c39a2",remain_cards:["3h","5d","6c","6h","7c","7h","9c","ac","ah","tc","td","th"],settlement:{balance:"19100",dealt_amount:"300",frozen_amount:"0",total_amount:"19100"}},{player_id:"bbbbbbbb-77d8-49a4-9616-4fa07f987039",remain_cards:[],settlement:{balance:"19100",dealt_amount:"300",frozen_amount:"0",total_amount:"19100"}},{player_id:"cccccccc-8a2e-46c6-9723-57caa2a61c4c",remain_cards:["2d","bw"],settlement:{balance:"19100",dealt_amount:"-600",frozen_amount:"0",total_amount:"19100"}}],ended_at:"2017-12-19T06:50:48.053709"},DDZGame=function(){function e(e){this.phase=0,this.baseScore=0,this.bombAmount=0,this.isSpring=!1,this.landlordCards=[],this.roomId=e}return e.prototype.setMatchId=function(e){this.matchId=e},e.prototype.getMatchId=function(){return this.matchId},e.prototype.setPhase=function(e){this.phase=e},e.prototype.getMultiple=function(){return this.multiple=1,this.bombAmount&&(this.multiple*=this.bombAmount),this.isSpring&&(this.multiple*=2),this.multiple},e.prototype.addBombAmount=function(){this.bombAmount+=1},e.prototype.setIsSpring=function(e){this.isSpring=e},e.prototype.setLandlordId=function(e){this.landlordId=e},e.prototype.setLandlordCards=function(e){this.landlordCards=e},e.prototype.setCallingLandlordPlayerSeat=function(e){this.callingLandlordPlayerSeat=e},e}();__reflect(DDZGame.prototype,"DDZGame");var DDZGameModel=function(e){function t(t){var n=e.call(this)||this;return n.DefaultCardsCount=17,n.bottomPlayerModel=void 0,n.leftPlayerModel=void 0,n.rightPlayerModel=void 0,n.isGameOver=!1,n.game=new DDZGame(t),n.createBottomPlayer(),n.addWebsocketMonitor(),n}return __extends(t,e),t.prototype.addWebsocketMonitor=function(){this.monitorCallLandlordMessage(),this.monitorPlayCardMessage(),this.monitorGameOverMessage(),this.monitorRoomPlayerChangedMessage(),this.monitorServerDealCardsMessage(),this.monitorStartGameMessage(),this.monitorRestartGameMessage(),this.monitorConfirmLandlordMessage()},t.prototype.removeWebsocketMonitor=function(){DDZUserChannelModel.sharedInstance().callLandlordMessageHandler=void 0,DDZUserChannelModel.sharedInstance().playCardHandler=void 0,DDZUserChannelModel.sharedInstance().gameOverMessageHandler=void 0,DDZUserChannelModel.sharedInstance().roomPlayerChangedHandler=void 0,DDZUserChannelModel.sharedInstance().dealCardsHandler=void 0,DDZUserChannelModel.sharedInstance().startGameHandler=void 0,DDZUserChannelModel.sharedInstance().restartGameHandler=void 0,DDZUserChannelModel.sharedInstance().confirmLandlordHandler=void 0},t.prototype.restoreGame=function(e){DDZGameState.Model.sharedInstance().isPlayingGame()?(this.isStarted=!0,this.setGamePhase(2),this.restorePlayCardGame(function(t){e.playCardGameRestored&&e.playCardGameRestored(t)})):DDZGameState.Model.sharedInstance().isBecomingLandlord()&&(this.isStarted=!0,this.setGamePhase(1),this.restoreBecomLandlordGame(function(t,n){e.becomeLandlordGameRestored&&e.becomeLandlordGameRestored(t,n)})),DDZGameState.Model.sharedInstance().room&&this.game.setMatchId(DDZGameState.Model.sharedInstance().room.gameMatchId),DDZGameState.Model.sharedInstance().setGameState(DDZGameState.Type.GAME_BEEN_RESTORED)},t.prototype.containsPlayerId=function(e){return this.bottomPlayerModel?this.bottomPlayerModel.attribute.id===e:this.leftPlayerModel?this.leftPlayerModel.attribute.id===e:this.rightPlayerModel?this.rightPlayerModel.attribute.id===e:!1},t.prototype.addPlayers=function(e){var t=this.getBottomPlayerSeatId(e);"1"===t?(this.createLeftPlayer(this.getPlayerInfoBySeatId("3",e)),this.createRightPlayer(this.getPlayerInfoBySeatId("2",e))):"2"===t?(this.createLeftPlayer(this.getPlayerInfoBySeatId("1",e)),this.createRightPlayer(this.getPlayerInfoBySeatId("3",e))):"3"===t&&(this.createLeftPlayer(this.getPlayerInfoBySeatId("2",e)),this.createRightPlayer(this.getPlayerInfoBySeatId("1",e)))},t.prototype.isPlayersFull=function(){return this.leftPlayerModel&&this.rightPlayerModel?!0:!1},t.prototype.resetLastPlayedCards=function(){this.lastPlayedCardSet=void 0,this.setPlayersGameStopwatch()},t.prototype.doIHaveBiggerCards=function(){return this.bottomPlayerModel.isHaveBiggerCards(this.lastPlayedCardSet)},t.prototype.hint=function(){this.bottomPlayerModel.handCardModel.hint(this.lastPlayedCardSet)},t.prototype.isLeftPlayerExist=function(){return this.leftPlayerModel?!0:!1},t.prototype.isRightPlayerExist=function(){return this.rightPlayerModel?!0:!1},t.prototype.isBottomPlayerLandlord=function(){return this.bottomPlayerModel.attribute.isLandlord()},t.prototype.isLeftPlayerLandlord=function(){return this.leftPlayerModel.attribute.isLandlord()},t.prototype.isRightPlayerLandlord=function(){return this.rightPlayerModel.attribute.isLandlord()},t.prototype.isLeftPlayerPlayedAllCards=function(){return 0===this.leftPlayerModel.countRemainCards()},t.prototype.isRightPlayerPlayedAllCards=function(){return 0===this.rightPlayerModel.countRemainCards()},t.prototype.canIAutoPlayRemainCardsSet=function(){if(this.bottomPlayerModel.handCardModel.isRemainCardsASet()){var e=this.bottomPlayerModel.handCardModel.getRemainCardsSet();if(!this.lastPlayedCardSet)return e.isFourTakes()?!1:e.isHuoJian()?!1:!0;
if(e.isBiggerThan(this.lastPlayedCardSet))return!0}return!1},t.prototype.amIWinInARound=function(){return this.lastPlayedCardSet?this.bottomPlayerModel.isIdEqualTo(this.lastPlayedCardSet.playerId)?!0:!1:!0},t.prototype.setBaseScore=function(e){this.game.baseScore=e},t.prototype.listAutoPlayCards=function(){return this.bottomPlayerModel.listAutoPlayCards(this.lastPlayedCardSet)},t.prototype.playCards=function(e,t){if(!this.isGameOver){var n=DDZPlayCardSetFactory.createCardSet(e);if(n.setPlayerId(this.bottomPlayerModel.attribute.id),!n.isLegal())return void t(new QPNetworkError({message:"您的出牌不符合规则",error_type:"client_checked_wrong_card_type"}));if(this.lastPlayedCardSet&&!n.isBomb()&&!n.isHuoJian()&&!n.isTypeEqualTo(this.lastPlayedCardSet))return void t(new QPNetworkError({message:"您的出牌不符合规则",error_type:"client_checked_wrong_card_type"}));if(this.lastPlayedCardSet&&!n.isBiggerThan(this.lastPlayedCardSet))return void t(new QPNetworkError({message:"您的出牌不符合规则",error_type:"client_checked_wrong_card_type"}));(n.isBomb()||n.isHuoJian())&&this.game.addBombAmount(),n.isEmpty()||(this.lastPlayedCardSet=n),this.bottomPlayerModel.dropPlayedCards(e),this.bottomPlayerModel.setLatestPlayedCards(e),t();var a=n.cards.map(function(e){return e.code}),r={body:{played_cards:a},header:this.headerWithAuthorization(),url:QPApiConfig.Host+"/"+QPApiConfig.V1+"/doudizhu/play_card"};this.postReturnJson(r,function(){},function(e){t(e)})}},t.prototype.notPlayCard=function(e){var t={body:{played_cards:[]},header:this.headerWithAuthorization(),url:QPApiConfig.Host+"/"+QPApiConfig.V1+"/doudizhu/play_card"};this.bottomPlayerModel.dropPlayedCards([]),this.bottomPlayerModel.setLatestPlayedCards([]),e(),this.postReturnJson(t,function(){},function(t){e(t)})},t.prototype.setDefaultLandlordId=function(e){var t=this.getSeatByPlayerId(e);this.game.setCallingLandlordPlayerSeat(t)},t.prototype.getSeatByPlayerId=function(e){var t=0;return this.bottomPlayerModel.isIdEqualTo(e)?t=1:this.leftPlayerModel&&this.leftPlayerModel.isIdEqualTo(e)?t=2:this.rightPlayerModel&&this.rightPlayerModel.isIdEqualTo(e)&&(t=3),t},t.prototype.isBottomPlayerCallingLandlord=function(){return 1===this.game.callingLandlordPlayerSeat},t.prototype.isLeftPlayerCallingLandlord=function(){return 2===this.game.callingLandlordPlayerSeat},t.prototype.isRightPlayerCallingLandlord=function(){return 3===this.game.callingLandlordPlayerSeat},t.prototype.countLeftPlayerCardsAmount=function(){return this.leftPlayerModel.countRemainCards()},t.prototype.countRightPlayerCardsAmount=function(){return this.rightPlayerModel.countRemainCards()},t.prototype.monitorCallLandlordMessage=function(){var e=this;DDZUserChannelModel.sharedInstance().callLandlordMessageHandler=function(t){e.setGamePhase(1);var n=e.getSeatByPlayerId(t.nextPlayer);e.setPlayersGameStopwatch(),e.nextCallLandlordPlayerHandler(n,t.currentLandlordScore);var a=e.getSeatByPlayerId(t.playerId),r=t.score;e.playerCalledLandlordHandler(a,r)}},t.prototype.monitorPlayCardMessage=function(){var e=this;DDZUserChannelModel.sharedInstance().playCardHandler=function(t){e.setGamePhase(2);var n=e.getSeatByPlayerId(t.data.playerId),a=e.getSeatByPlayerId(t.data.nextPlayerId),r=t.data.playedCards,o=t.data.remainCardsAmount,s=DDZPlayCardSetFactory.createCardSet(r);s.isEmpty()||(e.lastPlayedCardSet=s,e.lastPlayedCardSet.setPlayerId(t.data.playerId)),n===e.bottomPlayerModel.attribute.seat?(e.bottomPlayerModel.dropPlayedCards(r),e.bottomPlayerModel.setLatestPlayedCards(r),e.bottomPlayerModel.setHandCardsAmount(o),e.bottomPlayerModel.playPlayedCardsAudio(),e.playerPlayedCardsHandler(1)):n===e.leftPlayerModel.attribute.seat?(e.leftPlayerModel.dropPlayedCards(r),e.leftPlayerModel.setLatestPlayedCards(r),e.leftPlayerModel.setHandCardsAmount(o),e.leftPlayerModel.playPlayedCardsAudio(),e.playerPlayedCardsHandler(2)):n===e.rightPlayerModel.attribute.seat&&(e.rightPlayerModel.dropPlayedCards(r),e.rightPlayerModel.setLatestPlayedCards(r),e.rightPlayerModel.setHandCardsAmount(o),e.rightPlayerModel.playPlayedCardsAudio(),e.playerPlayedCardsHandler(3)),e.setPlayersGameStopwatch(),e.nextPlayCardPlayerHandler(a)}},t.prototype.monitorGameOverMessage=function(){var e=this;DDZUserChannelModel.sharedInstance().gameOverMessageHandler=function(t){for(var n=t.data.playerInformations,a=0,r=n;a<r.length;a++){var o=r[a],s=void 0;o.isWinner()&&(s=e.getWinnerCharacter(o.playerId),e.bottomPlayerModel.attribute.isWinner=e.bottomPlayerModel.characterEqualTo(s),e.leftPlayerModel.attribute.isWinner=e.leftPlayerModel.characterEqualTo(s),e.rightPlayerModel.attribute.isWinner=e.rightPlayerModel.characterEqualTo(s)),e.leftPlayerModel.isIdEqualTo(o.playerId)?(e.leftPlayerModel.handCardModel.setCards(o.remainCards),e.leftPlayerModel.attribute.score=o.dealtAmount):e.rightPlayerModel.isIdEqualTo(o.playerId)?(e.rightPlayerModel.handCardModel.setCards(o.remainCards),e.rightPlayerModel.attribute.score=o.dealtAmount):(e.bottomPlayerModel.handCardModel.setCards(o.remainCards),e.bottomPlayerModel.attribute.score=o.dealtAmount,UserModel.sharedInstance().addBalance(o.dealtAmount))}e.isGameOver=!0,e.gameOverHandler()}},t.prototype.monitorRoomPlayerChangedMessage=function(){var e=this;DDZUserChannelModel.sharedInstance().roomPlayerChangedHandler=function(t){return e.isGameOver?void(e.playerInformationsAfterGameOver=t.playerInformations):void e.addPlayers(t.playerInformations)}},t.prototype.monitorStartGameMessage=function(){var e=this;DDZUserChannelModel.sharedInstance().startGameHandler=function(t){e.startGame(t.data)}},t.prototype.monitorRestartGameMessage=function(){var e=this;DDZUserChannelModel.sharedInstance().restartGameHandler=function(t){e.dealCardsAgainHandler(),e.startGame(t.data)}},t.prototype.monitorServerDealCardsMessage=function(){var e=this;DDZUserChannelModel.sharedInstance().dealCardsHandler=function(t){e.bottomPlayerModel.handCardModel.setCards(t.data.cards),e.dealCardsHandler()}},t.prototype.monitorConfirmLandlordMessage=function(){var e=this;DDZUserChannelModel.sharedInstance().confirmLandlordHandler=function(t){e.game.setLandlordCards(t.data.bottomCards),e.setLandlordId(t.data.landlord),e.bottomPlayerModel.attribute.isLandlord()&&e.bottomPlayerModel.addLandlordCards(e.game.landlordCards),e.setGamePhase(2),e.setPlayersGameStopwatch(),e.bottomPlayerModel.setInitialHandCardsAmount(),e.leftPlayerModel.setInitialHandCardsAmount(),e.rightPlayerModel.setInitialHandCardsAmount(),e.gameLandlordConfirmedHandler&&e.gameLandlordConfirmedHandler()}},t.prototype.setLandlordId=function(e){this.game.setLandlordId(e),this.confirmPlayersCharactor(e)},t.prototype.startGame=function(e){this.isStarted=!0,this.setDefaultLandlordId(e.initLandlord),this.game.setMatchId(e.gameMatchId),this.setGamePhase(1),this.setPlayersGameStopwatch()},t.prototype.confirmPlayersCharactor=function(e){this.bottomPlayerModel.confirmCharacterByLandlordId(e),this.leftPlayerModel.confirmCharacterByLandlordId(e),this.rightPlayerModel.confirmCharacterByLandlordId(e)},t.prototype.createBottomPlayer=function(){this.bottomPlayerModel||(this.bottomPlayerModel=new DDZPlayerModel({id:UserModel.sharedInstance().attributeModel.id}),this.bottomPlayerModel.attribute.name=UserModel.sharedInstance().attributeModel.name,this.bottomPlayerModel.attribute.serviceId=UserModel.sharedInstance().attributeModel.serviceId,this.bottomPlayerModel.attribute.setBalanceAmount(UserModel.sharedInstance().attributeModel.getBalanceAmount()),this.bottomPlayerModel.attribute.gender=UserModel.sharedInstance().attributeModel.gender,this.bottomPlayerModel.attribute.seat=1,this.showPlayerHandler&&this.showPlayerHandler(this.bottomPlayerModel))},t.prototype.createRightPlayer=function(e){e?this.rightPlayerModel||(this.rightPlayerModel=new DDZPlayerModel({id:e.id}),this.rightPlayerModel.attribute.name=e.nickame,this.rightPlayerModel.attribute.serviceId=e.serviceId,this.rightPlayerModel.attribute.serviceId=e.serviceId,this.rightPlayerModel.attribute.setBalanceAmount(Number(e.balance)),this.rightPlayerModel.attribute.gender=e.gender,this.rightPlayerModel.attribute.seat=3,this.showPlayerHandler&&this.showPlayerHandler(this.rightPlayerModel)):(this.rightPlayerModel=void 0,this.hidePlayerHandler&&this.hidePlayerHandler(3))},t.prototype.createLeftPlayer=function(e){e?this.leftPlayerModel||(this.leftPlayerModel=new DDZPlayerModel({id:e.id}),this.leftPlayerModel.attribute.name=e.nickame,this.leftPlayerModel.attribute.serviceId=e.serviceId,this.leftPlayerModel.attribute.setBalanceAmount(Number(e.balance)),this.leftPlayerModel.attribute.gender=e.gender,this.leftPlayerModel.attribute.seat=2,this.showPlayerHandler&&this.showPlayerHandler(this.leftPlayerModel)):(this.leftPlayerModel=void 0,this.hidePlayerHandler&&this.hidePlayerHandler(2))},t.prototype.setGamePhase=function(e){this.game.phase=e,this.setPlayersPhase(e)},t.prototype.setPlayersPhase=function(e){this.bottomPlayerModel.attribute.gamePhase=e,this.leftPlayerModel.attribute.gamePhase=e,this.rightPlayerModel.attribute.gamePhase=e},t.prototype.restorePlayCardGame=function(e){this.game.setLandlordCards(DDZGameState.Model.sharedInstance().room.bottomCards),this.setLandlordId(DDZGameState.Model.sharedInstance().room.confirmedLandlord);var t=DDZGameState.Model.sharedInstance().room.lastPlayedCards,n=DDZPlayCardSetFactory.createCardSet(t);n&&!n.isEmpty()&&(this.lastPlayedCardSet=n,this.lastPlayedCardSet.setPlayerId(DDZGameState.Model.sharedInstance().room.lastPlayedCardsPlayer)),this.bottomPlayerModel.restoreFromPlayCardGame(),this.playerPlayedCardsHandler(1),this.leftPlayerModel.restoreFromPlayCardGame(),this.playerPlayedCardsHandler(2),this.rightPlayerModel.restoreFromPlayCardGame(),this.playerPlayedCardsHandler(3);var a=DDZGameState.Model.sharedInstance().room.activePlayerInformation.id,r=this.getSeatByPlayerId(a);this.setRestoredGameStopwatchForActivePlayer(r),e(r)},t.prototype.restoreBecomLandlordGame=function(e){this.game.setLandlordCards(DDZGameState.Model.sharedInstance().room.bottomCards),this.bottomPlayerModel.restoreFromBecomLandlordGame(),this.leftPlayerModel.restoreFromBecomLandlordGame(),this.rightPlayerModel.restoreFromBecomLandlordGame();var t=DDZGameState.Model.sharedInstance().room.activePlayerInformation.id,n=this.getSeatByPlayerId(t);this.setRestoredGameStopwatchForActivePlayer(n),e(n,DDZGameState.Model.sharedInstance().room.calledLandlordScore)},t.prototype.setRestoredGameStopwatchForActivePlayer=function(e){1===e?this.bottomPlayerModel.setRestoredGameStopwatch():2===e?this.leftPlayerModel.setRestoredGameStopwatch():3===e&&this.rightPlayerModel.setRestoredGameStopwatch()},t.prototype.setPlayersGameStopwatch=function(){this.bottomPlayerModel.setGameStopwatchByGamePhase(this.game.phase),2===this.game.phase&&(this.doIHaveBiggerCards()||this.bottomPlayerModel.setNoBiggerCardsStopwatch()),this.leftPlayerModel.setGameStopwatchByGamePhase(this.game.phase),this.rightPlayerModel.setGameStopwatchByGamePhase(this.game.phase)},t.prototype.getBottomPlayerSeatId=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];if(this.bottomPlayerModel.isIdEqualTo(a.id))return a.seatId}return"error_seat"},t.prototype.getPlayerInfoBySeatId=function(e,t){for(var n=0,a=t;n<a.length;n++){var r=a[n];if(r.seatId===e)return r}},t.prototype.getWinnerCharacter=function(e){return this.game.landlordId===e?1:2},t}(QPNetworkApi);__reflect(DDZGameModel.prototype,"DDZGameModel");var DDZPlayerAttribute=function(){function e(){}return e.prototype.setId=function(e){this.id=e},e.prototype.getDisplayId=function(){return this.serviceId},e.prototype.setBalanceAmount=function(e){this.balanceAmount=e},e.prototype.getBalanceAmount=function(){return this.balanceAmount},e.prototype.setIsAnonymous=function(e){this.isAnonymous=e},e.prototype.getIsAnonymous=function(){return this.isAnonymous},e.prototype.deleteAccount=function(){this.id=void 0},e.prototype.isLandlord=function(){return 1===this.character},e}();__reflect(DDZPlayerAttribute.prototype,"DDZPlayerAttribute",["IUserAttribute","IPlayerInGameAttribute"]);var DDZPlayerModel=function(e){function t(t){var n=e.call(this)||this;return n.attribute=new DDZPlayerAttribute,n.attribute.setId(t.id),n.handCardModel=new DDZHandCardModel,n}return __extends(t,e),t.prototype.isIdEqualTo=function(e){return this.attribute.id===e},t.prototype.characterEqualTo=function(e){return this.attribute.character===e},t.prototype.hasCards=function(){return this.handCardModel.hasCards()},t.prototype.getGameOverCharacterSource=function(){return this.attribute.isWinner?this.attribute.isLandlord()?this.attribute.gender.isMale()?"img_male_landlord@2x_png":"img_female_landlord@2x_png":this.attribute.gender.isMale()?"img_male_farmer@2x_png":"img_female_farmer@2x_png":this.attribute.isLandlord()?this.attribute.gender.isMale()?"img_male_landlord_cry_png":"img_female_landlord_cry_png":this.attribute.gender.isMale()?"img_male_farmer_cry_png":"img_female_farmer_cry_png"},t.prototype.getPlayGameCharacterSource=function(){return this.attribute.isLandlord()?this.attribute.gender.isMale()?"img_male_landlord@2x_png":"img_female_landlord@2x_png":this.attribute.gender.isMale()?"img_male_farmer@2x_png":"img_female_farmer@2x_png"},t.prototype.getCallLandlordSoundByPoint=function(e){if(0===e)return this.getNotCallLandlordSoundName();if(1===e)return this.getCallOnePointSoundName();if(2===e)return this.getCallTwoPointSoundName();if(3===e)return this.getCallThreePointSoundName();throw new Error("Fatal Error，你需要传一个分数进来，获取叫地主的音效")},t.prototype.setInitialHandCardsAmount=function(){this.setHandCardsAmount(this.attribute.isLandlord()?DDZConstant.DEFAULT_LANDLORD_CARDS_AMOUNT:DDZConstant.DEFAULT_FARMER_CARDS_AMOUNT)},t.prototype.confirmCharacterByLandlordId=function(e){this.isIdEqualTo(e)?this.attribute.character=1:this.attribute.character=2},t.prototype.setHandCardsAmount=function(e){this.attribute.handCardsAmount=e},t.prototype.countRemainCards=function(){var e=this.attribute.handCardsAmount;return 0>=e&&(e=0),e},t.prototype.callLandlord=function(e){var t={body:{score:e},header:this.headerWithAuthorization(),url:QPApiConfig.Host+"/"+QPApiConfig.V1+"/doudizhu/become_landlord"};this.postReturnJson(t,function(){egret.log("call landlord success #######")},function(e){egret.log("call landlord failed #######")})},t.prototype.notCallLandlord=function(){var e={body:{score:0},header:this.headerWithAuthorization(),url:QPApiConfig.Host+"/"+QPApiConfig.V1+"/doudizhu/become_landlord"};this.postReturnJson(e,function(e){egret.log("not call landlord success ######")},function(e){egret.log("not call landlord failed ########")})},t.prototype.leaveRoom=function(e){var t={header:this.headerWithAuthorization(),url:QPApiConfig.Host+"/"+QPApiConfig.V1+"/room/leave"};this.postReturnJson(t,function(t){e&&e()},function(t){e&&e(t)})},t.prototype.addLandlordCards=function(e){this.handCardModel.addLandlordCards(e)},t.prototype.listHandCards=function(){return this.handCardModel.listCards()},t.prototype.listSelectedCards=function(){return this.handCardModel.listSelectedCards()},t.prototype.listAutoPlayCards=function(e){var t=this.handCardModel.findBiggerCardSetThanTarget(e);return t?t.cards:[]},t.prototype.cancelSelectedCards=function(){this.handCardModel.cancelSelectedCards()},t.prototype.restoreFromPlayCardGame=function(){var e=DDZGameState.Model.sharedInstance().listPlayedCardsForPlayer(this.attribute.id);this.setLatestPlayedCards(e),this.setCardsAndCardsAmount()},t.prototype.restoreFromBecomLandlordGame=function(){var e=DDZGameState.Model.sharedInstance().getPlayerInformationById(this.attribute.id);this.setHasCalledLandlord(e.hasCalledLandlord),this.setCalledLandlordScore(e.calledLandlordScore),this.setCardsAndCardsAmount()},t.prototype.setGameStopwatchByGamePhase=function(e){1===e?this.attribute.stopwatchValue=t.CALL_LANDLORD_TIME:2===e&&(this.attribute.stopwatchValue=t.PLAY_CARD_TIME)},t.prototype.setNoBiggerCardsStopwatch=function(){this.attribute.stopwatchValue=t.NO_BIGGER_CARDS_TIME},t.prototype.setRestoredGameStopwatch=function(){this.attribute.stopwatchValue=DDZGameState.Model.sharedInstance().getActivePlayerTimerValue()},t.prototype.isHaveBiggerCards=function(e){if(!e&&this.handCardModel.hasCards())return!0;if(e.isEmpty()&&this.handCardModel.hasCards())return!0;var t=this.handCardModel.findBiggerCardSetThanTarget(e);return e.reset(),t?!0:!1},t.prototype.setLatestPlayedCards=function(e){for(var t=0,n=e.length,a=0,r=e;a<r.length;a++){var o=r[a];o.showLandlordTag(this.attribute.isLandlord()),t===n-1&&(o.isLastOne=!0),t+=1}var s=DDZPlayCardSetFactory.createCardSet(e);this.attribute.lastPlayedCardSet=s},t.prototype.playPlayedCardsAudio=function(){1!==this.countRemainCards()||this.isJust1CardAudioPlayed?2!==this.countRemainCards()||this.isJust2CardsAudioPlayed?this.playCardSetAudio():this.playJust2CardsAudio():this.playJust1CardAudio()},t.prototype.listLastPlayedCards=function(){return this.attribute.lastPlayedCardSet.cards.sort(function(e,t){return t.index-e.index}),this.attribute.lastPlayedCardSet.cards},t.prototype.dropPlayedCards=function(e){this.handCardModel.dropPlayedCards(e)},t.prototype.setCardsAndCardsAmount=function(){for(var e=DDZGameState.Model.sharedInstance().listCardsForPlayer(this.attribute.id),t=0,n=e;t<n.length;t++){var a=n[t];a.showLandlordTag(this.attribute.isLandlord())}this.handCardModel.setCards(e),this.setHandCardsAmount(DDZGameState.Model.sharedInstance().countCardsForPlayer(this.attribute.id))},t.prototype.setCalledLandlordScore=function(e){this.attribute.calledLandlordScore=e},t.prototype.setHasCalledLandlord=function(e){this.attribute.hasCalledLandlord=e},t.prototype.playCardSetAudio=function(){var e=this.attribute.lastPlayedCardSet.getSoundEffectName();this.attribute.gender.isMale()&&(e="male_"+e),this.attribute.lastPlayedCardSet.isEmpty()||QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.SEND_CARD,1),QPAudioManager.sharedInstance().playEffectSound(e,1)},t.prototype.playJust1CardAudio=function(){var e="quick_wj1zpl_mp3";this.attribute.gender.isMale()&&(e="male_"+e),QPAudioManager.sharedInstance().playEffectSound(e,1),this.isJust1CardAudioPlayed=!0},t.prototype.playJust2CardsAudio=function(){var e="quick_wj2zpl_mp3";this.attribute.gender.isMale()&&(e="male_"+e),QPAudioManager.sharedInstance().playEffectSound(e,1),this.isJust2CardsAudioPlayed=!0},t.prototype.getNotCallLandlordSoundName=function(){return this.attribute.gender.isMale()?"male_grab_bu_jiao_mp3":"grab_bu_jiao_mp3"},t.prototype.getCallOnePointSoundName=function(){return this.attribute.gender.isMale()?"male_grab_1_point_mp3":"grab_1_point_mp3"},t.prototype.getCallTwoPointSoundName=function(){return this.attribute.gender.isMale()?"male_grab_2_point_mp3":"grab_2_point_mp3"},t.prototype.getCallThreePointSoundName=function(){return this.attribute.gender.isMale()?"male_grab_3_point_mp3":"grab_3_point_mp3"},t.CALL_LANDLORD_TIME=15,t.PLAY_CARD_TIME=25,t.NO_BIGGER_CARDS_TIME=10,t.OBVIOUS_NO_BIGGER_CARDS_TIME=4,t}(QPNetworkApi);__reflect(DDZPlayerModel.prototype,"DDZPlayerModel");var DDZAccountSignInPopup=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZAccountSignInPopupUI",t.registerButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressRegisterButton,t),t.forgetPasswordButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressForgetPasswordButton,t),t.signInButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressSignInButton,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.phoneInput.prompt="输入您的手机号码",this.passwordInput.prompt="输入您的密码"},t.prototype.onPressRegisterButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressRegisterHandler&&this.pressRegisterHandler()},t.prototype.onPressForgetPasswordButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressForgetPasswordHandler&&this.pressForgetPasswordHandler()},t.prototype.onPressSignInButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressSignInHandler&&this.pressSignInHandler(this.phoneInput.text,this.passwordInput.text)},t}(QPPopupLayer);__reflect(DDZAccountSignInPopup.prototype,"DDZAccountSignInPopup");var DDZCardAnalyzer=function(){function e(){}return e.setCards=function(t){e.classifiedCardObject=new Object;for(var n=0,a=t;n<a.length;n++){var r=a[n],o=e.classifiedCardObject[r.value];o?o.addCard(r):(o=new DDZClassifiedCard(r.value),o.addCard(r),e.classifiedCardObject[r.value]=o)}e.cards=[].concat(t)},e.getCardsType=function(){var t=e.cards.length;if(0===t)return 1;if(1===t)return 2;if(2===t){var n=e.cards[0],a=e.cards[1];if(n.value>15&&15<a.value)return 15;if(n.isValueEqualTo(a))return 3}if(3===t&&e.cards[0].value===e.cards[2].value)return 4;if(4===t){var n=e.cards[0],a=e.cards[1],r=e.cards[2],o=e.cards[3];if(n.isValueEqualTo(a)&&a.isValueEqualTo(r)&&r.isValueEqualTo(o))return 14;if(n.isValueEqualTo(r)||a.isValueEqualTo(o))return 5}if(t>=5){if(e.isStraight())return 7;if(e.isTrioWithPair())return 6}if(t>=6){if(e.isConsecutivePair())return 8;if(e.isAirplane())return 9;if(e.isFourTakesTwo())return 12}if(t>=8){if(e.isAirplaneTakesSingles())return 10;if(e.isAirplaneTakesPairs())return 11;if(e.isFourTakesTwoPairs())return 13}return 0},e.getCardsValue=function(){var t=e.getCardsType();if(2===t)return e.cards[0].value;if(3===t)return e.cards[0].value;if(4===t)return e.cards[0].value;if(7===t)return e.getSmallestCard().value;if(8===t)return e.getSmallestCard().value;if(9===t)return e.getSmallestCard().value;if(14===t)return e.cards[0].value;if(15===t)return e.cards[0].value;if(5===t||6===t)for(var n=0,a=Object.keys(e.classifiedCardObject);n<a.length;n++){var r=a[n],o=e.classifiedCardObject[r];if(o.isTrio())return o.value}if(10===t||11===t){for(var s=void 0,i=0,d=Object.keys(e.classifiedCardObject);i<d.length;i++){var r=d[i],o=e.classifiedCardObject[r];o.isTrio()&&(s?s.isBiggerThan(o)&&(s=o):s=o)}if(s)return s.value}if(12===t||13===t)for(var l=0,c=Object.keys(e.classifiedCardObject);l<c.length;l++){var r=c[l],o=e.classifiedCardObject[r];if(o.isBomb())return o.value}return 0},e.isStraight=function(){for(var t=[],n=0,a=Object.keys(e.classifiedCardObject);n<a.length;n++){var r=a[n],o=e.classifiedCardObject[r];if(!o.isSingle())return!1;t.push(o)}var s=t.length;if(5>s||s>12)return!1;var i=t[0],d=t[s-1];return d.value>14?!1:d.value-i.value===s-1?!0:!1},e.getSmallestCard=function(){var t=e.cards[0],n=e.cards[e.cards.length-1];return t.value<n.value?t:n},e.isConsecutivePair=function(){for(var t=[],n=0,a=Object.keys(e.classifiedCardObject);n<a.length;n++){var r=a[n],o=e.classifiedCardObject[r];if(!o.isPair())return!1;t.push(o)}var s=t.length;if(3>s||s>10)return!1;var i=t[0],d=t[s-1];return 14<d.value?!1:d.value-i.value===s-1?!0:!1},e.isFourTakesTwo=function(){if(6!==e.cards.length)return!1;for(var t=0,n=Object.keys(e.classifiedCardObject);t<n.length;t++){var a=n[t],r=e.classifiedCardObject[a];if(r.isBomb())return!0}return!1},e.isFourTakesTwoPairs=function(){if(8!==e.cards.length)return!1;for(var t=!1,n=0,a=0,r=Object.keys(e.classifiedCardObject);a<r.length;a++){var o=r[a],s=e.classifiedCardObject[o];s.isBomb()&&(t=!0),s.isPair()&&(n+=1)}return t&&2===n?!0:!1},e.isTrioWithPair=function(){if(5!==e.cards.length)return!1;for(var t=!1,n=!1,a=0,r=Object.keys(e.classifiedCardObject);a<r.length;a++){var o=r[a],s=e.classifiedCardObject[o];s.isTrio()&&(t=!0),s.isPair()&&(n=!0)}return t&&n?!0:!1},e.isAirplane=function(){var t=e.cards.length;if(t%3!==0)return!1;for(var n=[],a=0,r=Object.keys(e.classifiedCardObject);a<r.length;a++){var o=r[a],s=e.classifiedCardObject[o];s.isTrio()&&n.push(s)}var i=n.length,d=t/3;if(2>i)return!1;if(d>i)return!1;var l=n[0],c=n[i-1];return 13<l.value||14<c.value?!1:c.value-l.value===i-1?!0:!1},e.isAirplaneTakesSingles=function(){var t=e.cards.length;if(8!==t&&12!==t&&16!==t&&20!==t)return!1;for(var n=[],a=[],r=0,o=Object.keys(e.classifiedCardObject);r<o.length;r++){var s=o[r],i=e.classifiedCardObject[s];i.isTrio()?n.push(i):a.push(i)}var d=n.length,l=t/4;if(2>d)return!1;if(l>d)return!1;var c=n[0],u=n[d-1];if(13<c.value||14<u.value)return!1;if(u.value-c.value!==d-1)return!1;for(var h=d,p=0,y=0,f=a;y<f.length;y++){var g=f[y];p+=g.countCards()}return p===h?!0:!1},e.isAirplaneTakesPairs=function(){var t=e.cards.length;if(10!==t&&15!==t&&20!==t)return!1;for(var n=[],a=[],r=0,o=Object.keys(e.classifiedCardObject);r<o.length;r++){var s=o[r],i=e.classifiedCardObject[s];i.isTrio()&&n.push(i),i.isPair()&&a.push(i)}var d=n.length,l=a.length,c=t/5;if(c>d)return!1;if(2>d)return!1;if(d!==l)return!1;var u=n[0],h=n[d-1];return 13<u.value||14<h.value?!1:h.value-u.value===d-1?!0:!1},e.cards=[],e}();__reflect(DDZCardAnalyzer.prototype,"DDZCardAnalyzer");var DDZClassifiedCard=function(){function e(e){this.value=18,this.cards=[],this.value=e}return e.prototype.reset=function(){this.cards=[]},e.prototype.isBiggerThan=function(e){return this.value>e.value},e.prototype.countCards=function(){return this.cards.length},e.prototype.addCard=function(e){this.cards.push(e)},e.prototype.isBlackJoker=function(){return 16===this.value},e.prototype.isRedJoker=function(){return 17===this.value},e.prototype.isSingle=function(){return 1===this.countCards()},e.prototype.isPair=function(){return 2===this.countCards()},e.prototype.isTrio=function(){return 3===this.countCards()},e.prototype.hasCards=function(){return this.countCards()>=1},e.prototype.isBomb=function(){return 4===this.countCards()},e}();__reflect(DDZClassifiedCard.prototype,"DDZClassifiedCard");var DDZDealCardModel=function(){function e(){this.cards=[],this.dealtCards=[],this.dealtCardCount=0}return e.prototype.setCards=function(e){this.cards=e,this.reset();for(var t=e.length,n=0;t>n;n+=1){var a=new DDZRearCard;a.showLandlordTag(!1),this.rearCards.push(a)}},e.prototype.listRearCards=function(){return this.rearCards},e.prototype.isAllCardsDealt=function(){return this.dealtCards.length===this.cards.length},e.prototype.dealOneCard=function(){this.dealtCards.push(this.cards[this.dealtCardCount]),this.rearCards.shift(),this.dealtCardCount+=1},e.prototype.listCards=function(){return this.cards},e.prototype.listDealtCards=function(){return this.dealtCards},e.prototype.countDealtCards=function(){return this.dealtCards.length},e.prototype.reset=function(){this.dealtCardCount=0,this.dealtCards=[],this.rearCards=[]},e}();__reflect(DDZDealCardModel.prototype,"DDZDealCardModel");var DDZHandCardModel=function(){function e(){this.cards=[]}return e.prototype.setCards=function(e){0!==e.length&&(this.classifyCards(e),this.cards=[].concat(e),this.cards.sort(function(e,t){return t.index-e.index}))},e.prototype.listCards=function(){return this.markLastCard(),this.cards},e.prototype.hasCards=function(){return this.cards.length>0},e.prototype.isSelectedCardLegal=function(){DDZCardAnalyzer.setCards(this.listSelectedCards());var e=DDZCardAnalyzer.getCardsType();return 0===e?!1:1===e?!1:!0},e.prototype.listSelectedCards=function(){for(var e=[],t=0,n=this.cards;t<n.length;t++){var a=n[t];a.isSelect&&e.push(a)}return e},e.prototype.hasSelectedCards=function(){return 0!==this.listSelectedCards().length},e.prototype.cancelSelectedCards=function(){for(var e=0,t=this.cards;e<t.length;e++){var n=t[e];n.isSelect=!1}},e.prototype.dropPlayedCards=function(e){for(var t=e.length,n=0;t>n;n+=1)for(var a=e[n],r=this.cards.length-1;r>=0;r-=1){var o=this.cards[r];o.isExactlySameTo(a)&&this.cards.splice(r,1)}this.classifyCards(this.cards)},e.prototype.hint=function(e){var t=this.findBiggerCardSetThanTarget(e);if(t)for(var n=0,a=this.cards;n<a.length;n++)for(var r=a[n],o=0,s=t.cards;o<s.length;o++){var i=s[o];if(r.isSelect=r.isExactlySameTo(i),r.isSelect)break}},e.prototype.addLandlordCards=function(e){3===e.length&&(this.cards=this.cards.concat(e),this.cards.sort(function(e,t){return t.index-e.index}),this.cards.forEach(function(e){e.showLandlordTag(!0)}))},e.prototype.findBiggerCardSetThanTarget=function(e){if(this.isRemainCardsHuoJian())return DDZPlayCardSetFactory.createCardSet(this.cards);if(this.isRemainCardsBomb()&&e&&!e.isBomb()&&!e.isHuoJian())return DDZPlayCardSetFactory.createCardSet(this.cards);if(!e)return this.findSmallestCardSetInHand();if(!e.isHuoJian()){var t=e.listBiggerLegalCardSet(this.analyzedCardObject);return t||e.isBomb()||(t=this.findSmallestBomb(e)),t||(t=this.findHuoJian(e)),t}},e.prototype.isRemainCardsASet=function(){return 0===this.remainCardsType?!1:1===this.remainCardsType?!1:!0},e.prototype.isRemainCardsHuoJian=function(){return 15===this.remainCardsType},e.prototype.isRemainCardsBomb=function(){return 14===this.remainCardsType?!0:!1},e.prototype.getRemainCardsSet=function(){return DDZPlayCardSetFactory.createCardSet(this.cards)},e.prototype.findHuoJian=function(e){for(var t=[],n=0,a=Object.keys(this.analyzedCardObject);n<a.length;n++){var r=a[n],o=this.analyzedCardObject[r];(o.isBlackJoker()||o.isRedJoker())&&(t=t.concat(o.cards))}return 2===t.length?DDZPlayCardSetFactory.createCardSet(t):void 0},e.prototype.findSmallestBomb=function(e){for(var t=0,n=Object.keys(this.analyzedCardObject);t<n.length;t++){var a=n[t],r=this.analyzedCardObject[a];if(r.isBomb())return DDZPlayCardSetFactory.createCardSet(r.cards)}},e.prototype.findSmallestCardSetInHand=function(){if(this.isRemainCardsASet())return DDZPlayCardSetFactory.createCardSet(this.cards);for(var e=0,t=Object.keys(this.analyzedCardObject);e<t.length;e++){var n=t[e],a=this.analyzedCardObject[n];if(a.hasCards())return DDZPlayCardSetFactory.createCardSet(a.cards)}},e.prototype.classifyCards=function(e){this.analyzedCardObject=new Object;for(var t=0,n=e;t<n.length;t++){var a=n[t],r=this.analyzedCardObject[a.value];r?r.addCard(a):(r=new DDZClassifiedCard(a.value),r.addCard(a),this.analyzedCardObject[a.value]=r)}DDZCardAnalyzer.setCards(e),this.remainCardsType=DDZCardAnalyzer.getCardsType()},e.prototype.markLastCard=function(){this.hasCards()&&(this.cards[this.cards.length-1].isLastOne=!0)},e}();__reflect(DDZHandCardModel.prototype,"DDZHandCardModel");var DDZRearCard=function(e){function t(){return e.call(this,t.DefaultCode)||this}return __extends(t,e),t.prototype.getImageName=function(){return"poker_back@2x_png"},t.DefaultCode="3d",t}(DDZCard);__reflect(DDZRearCard.prototype,"DDZRearCard");var DDZPlayCardAirplaneSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){var t=this.countCards()/3,n=this.findBiggerAirplaneCards(e,t);return 0!==n.length?DDZPlayCardSetFactory.createCardSet(n):void 0},t.prototype.getSoundEffectName=function(){return"poker_airplane_mp3"},t}(DDZPlayCardAirplaneTakes);__reflect(DDZPlayCardAirplaneSet.prototype,"DDZPlayCardAirplaneSet");var GameLaunchScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="GameLaunchSceneUI",t}return __extends(t,e),t.prototype.setProgress=function(e,t){this.progress.value=Math.floor(e/t*100),this.progress.labelFunction=function(e,t){return Math.ceil(e/t*100)+"%"}},t}(eui.Component);__reflect(GameLaunchScene.prototype,"GameLaunchScene");var DDZPlayCardAirplaneTakesPairsSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){var t=this.countCards()/5,n=this.findBiggerAirplaneCards(e,t);if(0!==n.length){for(var a=t,r=[],o=2*a,s=0,i=this.pairs;s<i.length;s++){var d=i[s];if(r.length<o&&(r=r.concat(d.cards)),r.length===o)return DDZPlayCardSetFactory.createCardSet(n.concat(r))}for(var l=n[0].value,c=n[n.length-1].value,u=0,h=this.trioes;u<h.length;u++){var p=h[u];if(r.length<o&&(p.value<l||c<p.value)&&(r=r.concat([p.cards[0],p.cards[1]])),r.length===o)return DDZPlayCardSetFactory.createCardSet(n.concat(r))}}},t.prototype.getSoundEffectName=function(){return"poker_airplane_mp3"},t}(DDZPlayCardAirplaneTakes);__reflect(DDZPlayCardAirplaneTakesPairsSet.prototype,"DDZPlayCardAirplaneTakesPairsSet");var DDZPlayCardAirplaneTakesSinglesSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this
}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){var t=this.countCards()/4,n=this.findBiggerAirplaneCards(e,t);if(0!==n.length){for(var a=[],r=0,o=this.singles;r<o.length;r++){var s=o[r];if(a.length<t&&(a=a.concat(s.cards)),a.length===t)return DDZPlayCardSetFactory.createCardSet(n.concat(a))}for(var i=0,d=this.pairs;i<d.length;i++){var l=d[i];if(a.length<t&&(a=a.concat([l.cards[0]])),a.length<t&&(a=a.concat([l.cards[1]])),a.length===t)return DDZPlayCardSetFactory.createCardSet(n.concat(a))}for(var c=n[0].value,u=n[n.length-1].value,h=0,p=this.trioes;h<p.length;h++){var y=p[h];if((y.value<c||u<y.value)&&(a.length<t&&(a=a.concat([y.cards[0]])),a.length<t&&(a=a.concat([y.cards[1]])),a.length<t&&(a=a.concat([y.cards[2]]))),a.length===t)return DDZPlayCardSetFactory.createCardSet(n.concat(a))}}},t.prototype.getSoundEffectName=function(){return"poker_airplane_mp3"},t}(DDZPlayCardAirplaneTakes);__reflect(DDZPlayCardAirplaneTakesSinglesSet.prototype,"DDZPlayCardAirplaneTakesSinglesSet");var DDZPlayCardBombSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){var t=this.findBiggerBombCards(e);if(0!==t.length)return DDZPlayCardSetFactory.createCardSet(t)},t.prototype.getSoundEffectName=function(){return"poker_bomb_mp3"},t}(DDZPlayCardFourTakes);__reflect(DDZPlayCardBombSet.prototype,"DDZPlayCardBombSet");var DDZPlayCardConsecutivePairsSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){for(var t=[],n=0,a=Object.keys(e);n<a.length;n++){var r=a[n],o=e[r];(o.isPair()||o.isTrio()||o.isBomb())&&t.push(o)}var s=t.length,i=this.countCards()/2;if(!(i>s)){for(var d=s-1,l=0;d>=l;l+=1){var c=l+i-1;if(c>d)return;var u=t[c];if(15<=u.value)return;var h=t[l];if(this.canBeBiggerConsetutive(h,u,i)){if(this.lastFoundIndex!==DDZConstant.INDEX_NOT_FOUND&&l<=this.lastFoundIndex)continue;if(this.lastFoundIndex=l,d>c){var p=t[c+1];(p.value-u.value!==1||15<=p.value)&&(this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND)}else c===d&&(this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND);for(var y=t.slice(l,c+1),f=[],g=0,m=y;g<m.length;g++){var D=m[g];f=f.concat([D.cards[0],D.cards[1]])}return DDZPlayCardSetFactory.createCardSet(f)}}if(this.lastFoundIndex!==DDZConstant.INDEX_NOT_FOUND){var v=this.lastFoundIndex,C=this.lastFoundIndex+i-1;if(C>d)return;if(15<=t[C].value)return;if(t[C].value-t[v].value!==i-1)return;for(var P=t.slice(v,C+1),_=[],I=0,S=P;I<S.length;I++){var M=S[I];_=_.concat([M.cards[0],M.cards[1]])}return DDZPlayCardSetFactory.createCardSet(_)}}},t.prototype.getSoundEffectName=function(){return"poker_consecutive_pairs_mp3"},t}(DDZPlayCardSet);__reflect(DDZPlayCardConsecutivePairsSet.prototype,"DDZPlayCardConsecutivePairsSet");var DDZPlayCardEmptySet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var a=n[t],r=e[a];if(r.hasCards())return DDZPlayCardSetFactory.createCardSet(r.cards)}},t.prototype.getSoundEffectName=function(){return QPAudioSouce.getRandomBuYao()},t}(DDZPlayCardSet);__reflect(DDZPlayCardEmptySet.prototype,"DDZPlayCardEmptySet");var DDZPlayCardErrorSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){throw new Error("错误的牌型不应该找比它大的牌")},t.prototype.getSoundEffectName=function(){return""},t}(DDZPlayCardSet);__reflect(DDZPlayCardErrorSet.prototype,"DDZPlayCardErrorSet");var DDZPlayCardFourWithTwoPairsSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){var t=this.findBiggerBombCards(e);if(0!==t.length){for(var n=[],a=4,r=0,o=this.pairs;r<o.length;r++){var s=o[r];if(n.length<a&&(n=n.concat(s.cards)),n.length===a)return DDZPlayCardSetFactory.createCardSet(t.concat(n))}for(var i=0,d=this.trioes;i<d.length;i++){var l=d[i];if(n.length<a&&(n=n.concat([l.cards[0],l.cards[1]])),n.length===a)return DDZPlayCardSetFactory.createCardSet(t.concat(n))}}},t.prototype.getSoundEffectName=function(){return"poker_4_take_4_mp3"},t}(DDZPlayCardFourTakes);__reflect(DDZPlayCardFourWithTwoPairsSet.prototype,"DDZPlayCardFourWithTwoPairsSet");var DDZPlayCardFourTakesTwoSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){var t=this.findBiggerBombCards(e);if(0!==t.length){for(var n=[],a=2,r=0,o=this.singles;r<o.length;r++){var s=o[r];if(n.length<a&&!s.isBlackJoker()&&!s.isRedJoker())n.push(s.cards[0]);else if(n.length===a)return DDZPlayCardSetFactory.createCardSet(t.concat(n))}for(var i=0,d=this.pairs;i<d.length;i++){var l=d[i];if(n.length<a&&n.push(l.cards[0]),n.length<a&&n.push(l.cards[1]),n.length===a)return DDZPlayCardSetFactory.createCardSet(t.concat(n))}for(var c=0,u=this.trioes;c<u.length;c++){var h=u[c];if(n.length<a&&n.push(h.cards[0]),n.length<a&&n.push(h.cards[1]),n.length===a)return DDZPlayCardSetFactory.createCardSet(t.concat(n))}for(var p=0,y=this.attachedBombs;p<y.length;p++){var f=y[p];if(n.length<a&&n.push(f.cards[0]),n.length<a&&n.push(f.cards[1]),n.length===a)return DDZPlayCardSetFactory.createCardSet(t.concat(n))}}},t.prototype.getSoundEffectName=function(){return"poker_4_take_2_mp3"},t}(DDZPlayCardFourTakes);__reflect(DDZPlayCardFourTakesTwoSet.prototype,"DDZPlayCardFourTakesTwoSet");var DDZPlayCardHuoJianSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){},t.prototype.getSoundEffectName=function(){return"poker_huo_jian_mp3"},t}(DDZPlayCardSet);__reflect(DDZPlayCardHuoJianSet.prototype,"DDZPlayCardHuoJianSet");var DDZPlayCardPairSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){for(var t=[],n=[],a=0,r=Object.keys(e);a<r.length;a++){var o=r[a],s=e[o];s.isPair()&&this.value<s.value&&t.push(s),s.isTrio()&&this.value<s.value&&n.push(s)}var i=[];i=i.concat(t),i=i.concat(n);var d=i.length;if(1===d){var l=i[0];return DDZPlayCardSetFactory.createCardSet([l.cards[0],l.cards[1]])}for(var c=0;d>c;c+=1){var l=i[c];if(this.lastFoundIndex===DDZConstant.INDEX_NOT_FOUND)return this.lastFoundIndex=c,DDZPlayCardSetFactory.createCardSet([l.cards[0],l.cards[1]]);if(this.lastFoundIndex<c)return this.lastFoundIndex=c,c===d-1&&(this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND),DDZPlayCardSetFactory.createCardSet([l.cards[0],l.cards[1]])}},t.prototype.getSoundEffectName=function(){return 3===this.value?"poker_33_mp3":4===this.value?"poker_44_mp3":5===this.value?"poker_55_mp3":6===this.value?"poker_66_mp3":7===this.value?"poker_77_mp3":8===this.value?"poker_88_mp3":9===this.value?"poker_99_mp3":10===this.value?"poker_1010_mp3":11===this.value?"poker_JJ_mp3":12===this.value?"poker_QQ_mp3":13===this.value?"poker_KK_mp3":14===this.value?"poker_AA_mp3":15===this.value?"poker_22_mp3":""},t}(DDZPlayCardSet);__reflect(DDZPlayCardPairSet.prototype,"DDZPlayCardPairSet");var DDZPlayCardSetFactory=function(){function e(){}return e.createCardSet=function(e){if(e){var t=e.slice(0);DDZCardAnalyzer.setCards(t);var n,a=DDZCardAnalyzer.getCardsType(),r=DDZCardAnalyzer.getCardsValue();switch(a){case 2:n=new DDZPlayCardSingleSet(t);break;case 3:n=new DDZPlayCardPairSet(t);break;case 4:n=new DDZPlayCardTrioTakesNoneSet(t);break;case 5:n=new DDZPlayCardTrioTakesSingleSet(t);break;case 6:n=new DDZPlayCardTrioTakesPairSet(t);break;case 7:n=new DDZPlayCardStraightSet(t);break;case 8:n=new DDZPlayCardConsecutivePairsSet(t);break;case 9:n=new DDZPlayCardAirplaneSet(t);break;case 10:n=new DDZPlayCardAirplaneTakesSinglesSet(t);break;case 11:n=new DDZPlayCardAirplaneTakesPairsSet(t);break;case 12:n=new DDZPlayCardFourTakesTwoSet(t);break;case 13:n=new DDZPlayCardFourWithTwoPairsSet(t);break;case 14:n=new DDZPlayCardBombSet(t);break;case 15:n=new DDZPlayCardHuoJianSet(t);break;case 1:n=new DDZPlayCardEmptySet(t);break;default:n=new DDZPlayCardErrorSet(t)}return n.value=r,n.cardTypeName=a,n}},e}();__reflect(DDZPlayCardSetFactory.prototype,"DDZPlayCardSetFactory");var DDZPlayCardSingleSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){for(var t=[],n=[],a=[],r=0,o=Object.keys(e);r<o.length;r++){var s=o[r],i=e[s];i.isSingle()&&this.value<i.value&&t.push(i),i.isPair()&&this.value<i.value&&n.push(i),i.isTrio()&&this.value<i.value&&a.push(i)}var d=[];d=d.concat(t),d=d.concat(n),d=d.concat(a);var l=d.length;if(1===l)return DDZPlayCardSetFactory.createCardSet([d[0].cards[0]]);for(var c=0;l>c;c+=1){var u=d[c];if(this.lastFoundIndex===DDZConstant.INDEX_NOT_FOUND)return this.lastFoundIndex=c,DDZPlayCardSetFactory.createCardSet([u.cards[0]]);if(this.lastFoundIndex<c)return this.lastFoundIndex=c,c===l-1&&(this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND),DDZPlayCardSetFactory.createCardSet([u.cards[0]])}},t.prototype.getSoundEffectName=function(){return 3===this.value?"poker_3_mp3":4===this.value?"poker_4_mp3":5===this.value?"poker_5_mp3":6===this.value?"poker_6_mp3":7===this.value?"poker_7_mp3":8===this.value?"poker_8_mp3":9===this.value?"poker_9_mp3":10===this.value?"poker_10_mp3":11===this.value?"poker_J_mp3":12===this.value?"poker_Q_mp3":13===this.value?"poker_K_mp3":14===this.value?"poker_A_mp3":15===this.value?"poker_2_mp3":16===this.value?"poker_black_joker_mp3":17===this.value?"poker_red_joker_mp3":""},t}(DDZPlayCardSet);__reflect(DDZPlayCardSingleSet.prototype,"DDZPlayCardSingleSet");var DDZPlayCardStraightSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){for(var t=this.countCards(),n=[],a=0,r=Object.keys(e);a<r.length;a++){var o=r[a],s=e[o];n.push(s)}for(var i=n.length,d=i-1,l=0;d>=l;l+=1){var c=l+t-1;if(c>d)return;var u=n[c];if(15<=u.value)return;var h=n[l];if(this.canBeBiggerConsetutive(h,u,t)){if(this.lastFoundIndex!==DDZConstant.INDEX_NOT_FOUND&&l<=this.lastFoundIndex)continue;if(this.lastFoundIndex=l,d>c){var p=n[c+1];(p.value-u.value!==1||15<=p.value)&&(this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND)}else c===d&&(this.lastFoundIndex=DDZConstant.INDEX_NOT_FOUND);for(var y=n.slice(l,c+1),f=[],g=0,m=y;g<m.length;g++){var D=m[g];f=f.concat([D.cards[0]])}return DDZPlayCardSetFactory.createCardSet(f)}}if(this.lastFoundIndex!==DDZConstant.INDEX_NOT_FOUND){var v=this.lastFoundIndex,C=this.lastFoundIndex+t-1;if(C>=i)return;if(15<=n[C].value)return;if(n[C].value-n[v].value!==t-1)return;for(var P=n.slice(v,C+1),f=[],_=0,I=P;_<I.length;_++){var S=I[_];f=f.concat([S.cards[0]])}return DDZPlayCardSetFactory.createCardSet(f)}},t.prototype.getSoundEffectName=function(){return"poker_straight_mp3"},t}(DDZPlayCardSet);__reflect(DDZPlayCardStraightSet.prototype,"DDZPlayCardStraightSet");var DDZPlayCardTrioTakesNoneSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){var t=this.findBiggerTrioCards(e);if(0!==t.length)return DDZPlayCardSetFactory.createCardSet(t)},t.prototype.getSoundEffectName=function(){return 3===this.value?"poker_333_mp3":4===this.value?"poker_444_mp3":5===this.value?"poker_555_mp3":6===this.value?"poker_666_mp3":7===this.value?"poker_777_mp3":8===this.value?"poker_888_mp3":9===this.value?"poker_999_mp3":10===this.value?"poker_101010_mp3":11===this.value?"poker_JJJ_mp3":12===this.value?"poker_QQQ_mp3":13===this.value?"poker_KKK_mp3":14===this.value?"poker_AAA_mp3":15===this.value?"poker_222_mp3":""},t}(DDZPlayCardTrioTakes);__reflect(DDZPlayCardTrioTakesNoneSet.prototype,"DDZPlayCardTrioTakesNoneSet");var DDZPlayCardTrioTakesPairSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){var t=this.findBiggerTrioCards(e);if(0!==t.length){if(0!==this.pairs.length)return DDZPlayCardSetFactory.createCardSet(t.concat(this.pairs[0].cards));for(var n=0,a=this.trioes;n<a.length;n++){var r=a[n];if(r.value!==t[0].value)return DDZPlayCardSetFactory.createCardSet(t.concat([r.cards[0],r.cards[1]]))}}},t.prototype.getSoundEffectName=function(){return"poker_3_take_2_mp3"},t}(DDZPlayCardTrioTakes);__reflect(DDZPlayCardTrioTakesPairSet.prototype,"DDZPlayCardTrioTakesPairSet");var DDZPlayCardTrioTakesSingleSet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.listBiggerLegalCardSet=function(e){var t=this.findBiggerTrioCards(e);if(0!==t.length){if(0!==this.singles.length)return DDZPlayCardSetFactory.createCardSet(t.concat(this.singles[0].cards));if(0!==this.pairs.length)return DDZPlayCardSetFactory.createCardSet(t.concat([this.pairs[0].cards[0]]));for(var n=0,a=this.trioes;n<a.length;n++){var r=a[n];if(r.value!==t[0].value)return DDZPlayCardSetFactory.createCardSet(t.concat([r.cards[0]]))}}},t.prototype.getSoundEffectName=function(){return"poker_3_take_1_mp3"},t}(DDZPlayCardTrioTakes);__reflect(DDZPlayCardTrioTakesSingleSet.prototype,"DDZPlayCardTrioTakesSingleSet");var DDZClockView=function(e){function t(){var t=e.call(this)||this;return t.remainTime=0,t.isTimerEnded=!1,t.skinName="DDZClockUI",t.hLayout=new eui.HorizontalLayout,t.hLayout.gap=0,t.hLayout.horizontalAlign=egret.HorizontalAlign.CENTER,t.hLayout.verticalAlign=egret.VerticalAlign.MIDDLE,t.hLayout.paddingBottom=9,t}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this)},t.prototype.onExit=function(){e.prototype.onExit.call(this),this.stopCountDown()},t.prototype.startCountDown=function(e){this.stopwatchTimer||(this.isTimerEnded=!1,this.remainTime=e,this.stopwatchLabel.text=this.remainTime.toString(),this.stopwatchTimer=new egret.Timer(1e3,0),this.stopwatchTimer.addEventListener(egret.TimerEvent.TIMER,this.timerCall,this),this.stopwatchTimer.start())},t.prototype.stopCountDown=function(){this.stopwatchTimer&&(this.isTimerEnded=!0,this.stopwatchTimer.stop(),this.stopwatchTimer.removeEventListener(egret.TimerEvent.TIMER,this.timerCall,this),this.stopwatchTimer=void 0)},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.reset()},t.prototype.reset=function(){this.stopwatchLabel.text=""},t.prototype.timerCall=function(e){return this.isTimerEnded?void this.stopCountDown():(this.remainTime-=1,this.remainTime<1?(this.stopCountDown(),void(this.stopwatchFinishedHandler&&this.stopwatchFinishedHandler())):(this.stopwatchLabel.text=this.remainTime.toString(),void this.makeLabelShowInMiddle()))},t.prototype.makeLabelShowInMiddle=function(){9<this.remainTime&&this.remainTime<20?this.hLayout.paddingRight=5:this.hLayout.paddingRight=0,this.stopwatchLabelGroup.layout=this.hLayout},t}(QPLayer);__reflect(DDZClockView.prototype,"DDZClockView");var DDZLandlordCardsView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZLandlordCardsUI",t.visible=!1,t}return __extends(t,e),t.prototype.setCards=function(e){3===e.length&&(this.cardOne.setImage(e[0].getImageName()),this.cardTwo.setImage(e[1].getImageName()),this.cardThree.setImage(e[2].getImageName()),this.show())},t.prototype.show=function(){this.y=-80,this.visible=!0,egret.Tween.get(this).to({y:0},300)},t.prototype.hide=function(){this.visible=!1},t}(QPLayer);__reflect(DDZLandlordCardsView.prototype,"DDZLandlordCardsView");var DDZMatchPlayerView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPlayGameMatchPlayerUI",t}return __extends(t,e),t.prototype.showWaitForStartGame=function(){this.informationImage.source="img_wait_for_starting_png",this.show()},t.prototype.showMatchPlayer=function(){this.informationImage.source="img_matching_player_png",this.show()},t.prototype.hide=function(){this.visible=!1},t.prototype.show=function(){this.visible=!0},t}(QPLayer);__reflect(DDZMatchPlayerView.prototype,"DDZMatchPlayerView");var DDZPlayGameBottomToolbar=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPlayGameBottomToolbarUI",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.chatButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressChatButton,this)},t.prototype.onPressChatButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressChatButtonHandler()},t}(QPLayer);__reflect(DDZPlayGameBottomToolbar.prototype,"DDZPlayGameBottomToolbar");var DDZTopToolbar=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPlayGameTopToolbarUI",t.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressBack,t),t.taskButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressTask,t),t.packageButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressPackage,t),t.settingsButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressSettings,t),t}return __extends(t,e),t.prototype.onPressBack=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressBackHandler&&this.pressBackHandler()},t.prototype.onPressTask=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressTaskHandler&&this.pressTaskHandler()},t.prototype.onPressPackage=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressPackageHandler&&this.pressPackageHandler()},t.prototype.onPressSettings=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressSettingsHandler&&this.pressSettingsHandler()},t}(QPLayer);__reflect(DDZTopToolbar.prototype,"DDZTopToolbar");var InvitePlayerPopupLayer=function(e){function t(){var t=e.call(this)||this;return t.skinName="InvitePlayerPopupLayerUI",t}return __extends(t,e),t.prototype.show=function(){qp.SceneManager.sharedInstance().addChildLayer(this)},t.prototype.hide=function(){qp.SceneManager.sharedInstance().removeChildLayer(this)},t.prototype.setInvitationMessage=function(e){this.invitationMessageLabel.text=e;var t=UserModel.sharedInstance().personalRoomModel.getPin(),n="您的好友创建好了房间邀请您一起玩一局游戏, 房间号: ["+t+"] (复制该条消息打开游戏即可加入)";PasteBoard.write(n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.toWeChatButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toWeChat,this)},t.prototype.toWeChat=function(){var e=this;ApplicationUtil.switchToOtherApp("weixin://",function(){egret.log("跳转成功")},function(t){QPAlert.sharedInstance().showAt(e.parent,t.message)})},t}(QPPopupLayer);__reflect(InvitePlayerPopupLayer.prototype,"InvitePlayerPopupLayer");var DDZCallLandlordButtons=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZCallLandlordButtonsUI",t}return __extends(t,e),t.prototype.enableButtons=function(){this.buJiaoButton.enabled=!0,this.callOnePointButton.enabled=!0,this.callTwoPointButton.enabled=!0,this.callThreePointButton.enabled=!0},t.prototype.disableButtons=function(){this.buJiaoButton.enabled=!1,this.callOnePointButton.enabled=!1,this.callTwoPointButton.enabled=!1,this.callThreePointButton.enabled=!1},t.prototype.disableCallOnePointButton=function(){this.callOnePointButton.enabled=!1},t.prototype.disableCallTwoPointButton=function(){this.callTwoPointButton.enabled=!1},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addListeners()},t.prototype.addListeners=function(){this.buJiaoButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressBuJiaoButton,this),this.callOnePointButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressOnePointButton,this),this.callTwoPointButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressTwoPointButton,this),this.callThreePointButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressThreePointButton,this)},t.prototype.onPressBuJiaoButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.disableButtons();var e=new DDZButtonEvent(DDZButtonEvent.NOT_CALL_LANDLORD);DDZEventCenter.sharedInstance().dispatchEvent(e)},t.prototype.onPressOnePointButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.disableButtons();var e=new DDZButtonEvent(DDZButtonEvent.CALL_ONE_POINT);DDZEventCenter.sharedInstance().dispatchEvent(e)},t.prototype.onPressTwoPointButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.disableButtons();var e=new DDZButtonEvent(DDZButtonEvent.CALL_TWO_POINT);DDZEventCenter.sharedInstance().dispatchEvent(e)},t.prototype.onPressThreePointButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.disableButtons();var e=new DDZButtonEvent(DDZButtonEvent.CALL_THREE_POINT);DDZEventCenter.sharedInstance().dispatchEvent(e)},t}(DDZBaseButtons);__reflect(DDZCallLandlordButtons.prototype,"DDZCallLandlordButtons");var DDZMustPlayCardButtons=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZMustPlayCardButtonsUI",t}return __extends(t,e),t.prototype.disablePlayButton=function(){this.playButton.enabled=!1},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addListeners()},t.prototype.addListeners=function(){this.playButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressPlayButton,this),this.hintButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressHintButton,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.ENABLE_PLAY_CARD_BUTTON,this.enablePlayButton,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.DISABLE_PLAY_CARD_BUTTON,this.disablePlayButton,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeListeners,this)},t.prototype.removeListeners=function(){DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.ENABLE_PLAY_CARD_BUTTON,this.enablePlayButton,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.DISABLE_PLAY_CARD_BUTTON,this.disablePlayButton,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeListeners,this)},t.prototype.enablePlayButton=function(){this.playButton.enabled=!0},t.prototype.onPressPlayButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.disablePlayButton();var e=new DDZButtonEvent(DDZButtonEvent.PLAY_CARD);DDZEventCenter.sharedInstance().dispatchEvent(e)},t.prototype.onPressHintButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZButtonEvent(DDZButtonEvent.HINT);DDZEventCenter.sharedInstance().dispatchEvent(e)},t}(DDZBaseButtons);__reflect(DDZMustPlayCardButtons.prototype,"DDZMustPlayCardButtons");var DDZNoBiggerCardsButtons=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZNoBiggerCardsButtonsUI",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addListeners()},t.prototype.addListeners=function(){this.noBiggerCardsButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressNoBiggerCardsButton,this)},t.prototype.onPressNoBiggerCardsButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZButtonEvent(DDZButtonEvent.NOT_PLAY_CARD);DDZEventCenter.sharedInstance().dispatchEvent(e)},t}(DDZBaseButtons);__reflect(DDZNoBiggerCardsButtons.prototype,"DDZNoBiggerCardsButtons");var DDZPlayCardButtons=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPlayCardButtonsUI",t}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this),this.addListeners()},t.prototype.onExit=function(){e.prototype.onExit.call(this),this.removeListeners()},t.prototype.disablePlayButton=function(){this.playButton.enabled=!1},t.prototype.addListeners=function(){this.notPlayButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressNotPlayButton,this),this.hintButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressHintButton,this),this.playButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressPlayButton,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.ENABLE_PLAY_CARD_BUTTON,this.enablePlayButton,this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.DISABLE_PLAY_CARD_BUTTON,this.disablePlayButton,this)},t.prototype.removeListeners=function(){DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.ENABLE_PLAY_CARD_BUTTON,this.enablePlayButton,this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.DISABLE_PLAY_CARD_BUTTON,this.disablePlayButton,this)},t.prototype.enablePlayButton=function(){this.playButton.enabled=!0},t.prototype.onPressNotPlayButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZButtonEvent(DDZButtonEvent.NOT_PLAY_CARD);DDZEventCenter.sharedInstance().dispatchEvent(e)},t.prototype.onPressHintButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZButtonEvent(DDZButtonEvent.HINT);DDZEventCenter.sharedInstance().dispatchEvent(e)},t.prototype.onPressPlayButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZButtonEvent(DDZButtonEvent.PLAY_CARD);this.disablePlayButton(),DDZEventCenter.sharedInstance().dispatchEvent(e)},t}(DDZBaseButtons);__reflect(DDZPlayCardButtons.prototype,"DDZPlayCardButtons");var DDZPlayGameButtonsContainer=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPlayGameButtonsContainerUI",t}return __extends(t,e),t.prototype.hideAllButtons=function(){this.callLandlordButtons.setVisible(!1),this.playCardButtons.setVisible(!1),this.mustPlayCardButtons.setVisible(!1),this.noBiggerCardsButtons.setVisible(!1),this.startGameButton.visible=!1},t.prototype.disableCallOnePointButton=function(){this.callLandlordButtons.disableCallOnePointButton()},t.prototype.disableCallTwoPointButton=function(){this.callLandlordButtons.disableCallTwoPointButton()},t.prototype.showCallLandlordButtons=function(){this.hideAllButtons(),this.callLandlordButtons.setVisible(!0),this.callLandlordButtons.enableButtons()},t.prototype.showPlayCardButtons=function(){this.hideAllButtons(),this.playCardButtons.setVisible(!0),this.playCardButtons.disablePlayButton()},t.prototype.showNoBiggerCardsButtons=function(){this.hideAllButtons(),this.noBiggerCardsButtons.setVisible(!0)},t.prototype.showMustPlayCardButtons=function(){this.hideAllButtons(),this.mustPlayCardButtons.setVisible(!0),this.mustPlayCardButtons.disablePlayButton()},t.prototype.showStartGameButton=function(){this.hideAllButtons(),this.startGameButton.visible=!0},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.hideAllButtons(),this.startGameButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressStartGameButton,this)},t.prototype.onPressStartGameButton=function(){var e=new DDZButtonEvent(DDZButtonEvent.START_GAME);DDZEventCenter.sharedInstance().dispatchEvent(e),this.hideAllButtons()},t}(QPLayer);__reflect(DDZPlayGameButtonsContainer.prototype,"DDZPlayGameButtonsContainer");var DDZBottomPlayerHandCardsView=function(e){function t(){var t=e.call(this)||this;return t.ANIMATION_CARD_UP_LINE_INITIAL_X=50,t.ANIMATION_CARD_UP_LINE_INITIAL_Y=370,t.ANIMATION_CARD_BOTTOM_LINE_INITIAL_X=50,t.ANIMATION_CARD_BOTTOM_LINE_INITIAL_Y=420,t.ANIMATION_CARD_HORIZONTAL_GAP=55,t.ANIMATION_CARD_SPEED=3.106,t.skinName="DDZBottomPlayerHandCardsUI",t.dealCardModel=new DDZDealCardModel,t}return __extends(t,e),t.prototype.dealCards=function(e){this.dealCardModel.setCards(e),this.rearCardListView.setCards(this.dealCardModel.listRearCards()),this.playDealCardsAnimation()},t.prototype.setCards=function(e){if(e.length<15||17<e.length){var t=new eui.HorizontalLayout;t.horizontalAlign=egret.HorizontalAlign.CENTER,t.verticalAlign=egret.VerticalAlign.MIDDLE,this.handCardsGroup.layout=t}this.handCardListView.setCards(e)},t.prototype.showBottomCards=function(){this.bottomCardsGroup.visible=!0},t.prototype.hideBottomCards=function(){this.bottomCardsGroup.visible=!1},t.prototype.playHideBottomCardsAnimation=function(e){var t=this;egret.Tween.get(this.bottomCardsGroup).to({y:-150,scaleX:.4,scaleY:.4},200).call(function(){t.hideBottomCards(),e()})},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.rearCardOriginPosition=new egret.Point(this.rearCardView.x,this.rearCardView.y)},t.prototype.playDealCardsAnimation=function(){var e=this;if(this.dealCardModel.isAllCardsDealt())return this.handCardListView.setCards(this.dealCardModel.listCards()),this.dealCardAnimationDidFinishedHandler&&this.dealCardAnimationDidFinishedHandler(),this.rearCardView.visible=!1,void this.showBottomCards();this.rearCardView.visible=!0,this.dealCardModel.dealOneCard();var t=this.dealCardModel.countDealtCards(),n=this.ANIMATION_CARD_UP_LINE_INITIAL_X+t*this.ANIMATION_CARD_HORIZONTAL_GAP,a=this.ANIMATION_CARD_UP_LINE_INITIAL_Y;t>=10&&(n=this.ANIMATION_CARD_BOTTOM_LINE_INITIAL_X+t%10*this.ANIMATION_CARD_HORIZONTAL_GAP,a=this.ANIMATION_CARD_BOTTOM_LINE_INITIAL_Y);var r=Math.abs(this.rearCardOriginPosition.x-n),o=a-this.rearCardOriginPosition.y,s=Math.floor(Math.sqrt(r*r+o*o)),i=s/this.ANIMATION_CARD_SPEED;QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.SEND_CARD,1),egret.Tween.get(this.rearCardView).to({x:n,y:a},i).call(function(){e.rearCardListView.setCards(e.dealCardModel.listRearCards()),e.handCardListView.setCards(e.dealCardModel.listDealtCards()),e.rearCardView.x=e.rearCardOriginPosition.x,e.rearCardView.y=e.rearCardOriginPosition.y,e.playDealCardsAnimation()})},t}(QPLayer);__reflect(DDZBottomPlayerHandCardsView.prototype,"DDZBottomPlayerHandCardsView");var DDZConstant=function(){function e(){}return e.INDEX_NOT_FOUND=-1,e.DEFAULT_FARMER_CARDS_AMOUNT=17,e.DEFAULT_LANDLORD_CARDS_AMOUNT=20,e}();__reflect(DDZConstant.prototype,"DDZConstant");var DDZHandCardListView=function(e){function t(){var t=e.call(this)||this;return t.CardSpace=58,t.CardWidth=126,t.CardHeight=182,t.CardVerticalGap=-60,t.skinName="DDZCardListUI",t}return __extends(t,e),t.prototype.setCards=function(e){var t=e.length;this.cardList.dataProvider=new eui.ArrayCollection(e),10>=t?(this.width=this.CardWidth+(t-1)*this.CardSpace,this.height=this.CardHeight):(this.width=650,this.height=2*this.CardHeight+this.CardVerticalGap)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.cardList.allowMultipleSelection=!1,this.cardList.itemRenderer=DDZHandCardView;var t=new eui.TileLayout;t.horizontalGap=this.CardSpace-this.CardWidth,t.verticalGap=this.CardVerticalGap,t.horizontalAlign=egret.HorizontalAlign.CENTER,t.verticalAlign=egret.VerticalAlign.MIDDLE,this.cardList.layout=t},t}(DDZCardListView);__reflect(DDZHandCardListView.prototype,"DDZHandCardListView");var DDZPlayedCardListView=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.CardSpace=30,t.CardVerticalGap=-40,t.CardWidth=70,t.CardHeight=102,t}return __extends(t,e),t.prototype.setCards=function(e){var t=e.length;this.cardList.dataProvider=new eui.ArrayCollection(e),10>=t?(this.width=this.CardWidth+(t-1)*this.CardSpace,this.height=this.CardHeight):(this.width=350,this.height=2*this.CardHeight+this.CardVerticalGap)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.cardList.itemRenderer=DDZPlayedCardView;var t=new eui.TileLayout;t.horizontalGap=this.CardSpace-this.CardWidth,t.horizontalAlign=egret.HorizontalAlign.CENTER,t.verticalGap=this.CardVerticalGap,t.verticalAlign=egret.VerticalAlign.MIDDLE,this.cardList.layout=t},t}(DDZCardListView);__reflect(DDZPlayedCardListView.prototype,"DDZPlayedCardListView");var DDZRearCardListView=function(e){function t(){var t=e.call(this)||this;
return t.CardSpace=20,t.CardWidth=105,t.CardHeight=140,t.skinName="DDZCardListUI",t}return __extends(t,e),t.prototype.setCards=function(e){this.cardList.dataProvider=new eui.ArrayCollection(e),this.width=this.CardWidth+(e.length-1)*this.CardSpace},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.cardList.allowMultipleSelection=!1,this.cardList.itemRenderer=DDZRearCardView;var t=new eui.TileLayout;t.horizontalGap=-85,t.verticalGap=0,t.horizontalAlign=egret.HorizontalAlign.CENTER,t.verticalAlign=egret.VerticalAlign.MIDDLE,this.cardList.layout=t},t}(DDZCardListView);__reflect(DDZRearCardListView.prototype,"DDZRearCardListView");var DDZCacheModel=function(){function e(){}return e.sharedInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.removeItemForKey=function(e){egret.localStorage.removeItem(e)},e.prototype.setString=function(e,t){egret.localStorage.setItem(e,t)},e.prototype.stringForKey=function(e){return egret.localStorage.getItem(e)},e.prototype.setBoolean=function(e,t){t?egret.localStorage.setItem(e,"yes"):egret.localStorage.setItem(e,"no")},e.prototype.booleanForKey=function(e){var t=egret.localStorage.getItem(e);return"yes"===t?!0:!1},e}();__reflect(DDZCacheModel.prototype,"DDZCacheModel");var DDZColor=function(){function e(){}return e.YELLOW=16571778,e.BROWN=10041347,e}();__reflect(DDZColor.prototype,"DDZColor");var DDZHandCardView=function(e){function t(){var t=e.call(this)||this;return t.isTouchMovedExcuted=!1,t.skinName="DDZCardUI",t.touchChildren=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchHandler,t),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMoved,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.removeListeners,t),t.addEventListener(egret.TouchEvent.TOUCH_END,t.touchEventEnd,t),DDZEventCenter.sharedInstance().addEventListener(DDZHandCardEvent.TOUCH_END,t.touchHandCardEnd,t),t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.data.isSelect?this.toSelectedPosition():this.toOriginPosition()},t.prototype.touchHandler=function(e){this.handleCardTouched()},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.toOriginPosition()},t.prototype.removeListeners=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMoved,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeListeners,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.touchEventEnd,this),DDZEventCenter.sharedInstance().removeEventListener(DDZHandCardEvent.TOUCH_END,this.touchHandCardEnd,this)},t.prototype.toOriginPosition=function(){this.contentGroup.y=t.ORIGIN_POS},t.prototype.toSelectedPosition=function(){this.contentGroup.y=t.SELECTED_POS},t.prototype.handleCardTouched=function(){this.data.isSelect=!this.data.isSelect,this.data.isSelect?this.toSelectedPosition():this.toOriginPosition();var e=new DDZHandCardEvent(DDZHandCardEvent.TOUCHED);DDZEventCenter.sharedInstance().dispatchEvent(e)},t.prototype.touchMoved=function(){this.isTouchMovedExcuted||(this.handleCardTouched(),this.isTouchMovedExcuted=!0)},t.prototype.touchEventEnd=function(){var e=new DDZHandCardEvent(DDZHandCardEvent.TOUCH_END);DDZEventCenter.sharedInstance().dispatchEvent(e),QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CHOOSE_CARD,1)},t.prototype.touchHandCardEnd=function(){this.isTouchMovedExcuted=!1},t.ORIGIN_POS=0,t.SELECTED_POS=-30,t}(DDZCardView);__reflect(DDZHandCardView.prototype,"DDZHandCardView");var DDZPlayedCardView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPlayedCardUI",t}return __extends(t,e),t.prototype.setImage=function(e){this.image.source="played_"+e},t}(DDZCardView);__reflect(DDZPlayedCardView.prototype,"DDZPlayedCardView");var DDZRearCardView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZRearCardUI",t}return __extends(t,e),t}(DDZBaseCardView);__reflect(DDZRearCardView.prototype,"DDZRearCardView");var DDZCardListLeftToRightAnimation=function(){function e(e){this.target=e.target}return e.prototype.play=function(){this.target.x=-200,egret.Tween.get(this.target).to({x:0},100)},e}();__reflect(DDZCardListLeftToRightAnimation.prototype,"DDZCardListLeftToRightAnimation",["DDZCardAnimation"]);var DDZCardListRightToLeftAnimation=function(){function e(e){this.target=e.target}return e.prototype.play=function(){this.target.x=200,egret.Tween.get(this.target).to({x:0},100)},e}();__reflect(DDZCardListRightToLeftAnimation.prototype,"DDZCardListRightToLeftAnimation",["DDZCardAnimation"]);var DDZLeaveGameAlertView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZLeaveGameAlertViewUI",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.popup.pressExitHandler=this.leaveGame.bind(this),this.popup.pressCancelHandler=this.cancelLeaveGame.bind(this)},t.prototype.leaveGame=function(){this.leaveGameHandler&&this.leaveGameHandler()},t.prototype.cancelLeaveGame=function(){this.visible=!1},t}(QPLayer);__reflect(DDZLeaveGameAlertView.prototype,"DDZLeaveGameAlertView");var DDZLeaveGamePopup=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZLeaveGamePopupUI",t.exitButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressExitButon,t),t.cancelButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressCancelButton,t),t}return __extends(t,e),t.prototype.onPressExitButon=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressExitHandler&&this.pressExitHandler()},t.prototype.onPressCancelButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressCancelHandler&&this.pressCancelHandler()},t}(QPPopupLayer);__reflect(DDZLeaveGamePopup.prototype,"DDZLeaveGamePopup");var DDZBottomPlayerInfoView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZBottomPlayerInfoUI",t}return __extends(t,e),t.prototype.setName=function(e){this.nameLabel.text=e},t}(QPLayer);__reflect(DDZBottomPlayerInfoView.prototype,"DDZBottomPlayerInfoView");var DDZLeftPlayerGameInfoView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZLeftPlayerGameInfoUI",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.playerStateView.setItemAlign(0)},t}(DDZPlayerGameInfoBaseView);__reflect(DDZLeftPlayerGameInfoView.prototype,"DDZLeftPlayerGameInfoView");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function a(a){t.call(n,a,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?a(r):RES.getResAsync(e,a,this)}else RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var DDZPlayerInfoView=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setInfo=function(e){this.setName(e.name),this.setBalance(e.getBalanceAmount())},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.reset()},t.prototype.reset=function(){this.nameLabel.text="",this.coinLabel.text=""},t.prototype.setName=function(e){this.nameLabel.text=e},t.prototype.setBalance=function(e){this.coinLabel.text=String(e)},t}(QPLayer);__reflect(DDZPlayerInfoView.prototype,"DDZPlayerInfoView");var DDZPlayerRemainCardView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPlayerRemainCardUI",t.hLayout=new eui.HorizontalLayout,t.hLayout.horizontalAlign=egret.HorizontalAlign.CENTER,t.hLayout.verticalAlign=egret.VerticalAlign.MIDDLE,t.hLayout.gap=0,t}return __extends(t,e),t.prototype.setAmount=function(e){this.amountLabel.text=String(e),e>9&&20>e?this.hLayout.paddingRight=5:this.hLayout.paddingRight=0,this.amountLabelGroup.layout=this.hLayout},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.reset()},t.prototype.reset=function(){this.amountLabel.text=""},t}(QPLayer);__reflect(DDZPlayerRemainCardView.prototype,"DDZPlayerRemainCardView");var DDZPlayerStateView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPlayerStateUI",t.hideAllState(),t}return __extends(t,e),t.prototype.setItemAlign=function(e){0===e?(this.callOnePointImage.x=0,this.callTwoPointImage.x=0,this.callThreePointImage.x=0,this.notCallLandlordImg.x=0,this.addTimesImg.x=0,this.notAddTimesImg.x=0,this.noBiggerCardsImg.x=0,this.notPlayImg.x=0):1===e&&(this.callOnePointImage.x=this.width-this.callOnePointImage.width,this.callTwoPointImage.x=this.width-this.callTwoPointImage.width,this.callThreePointImage.x=this.width-this.callThreePointImage.width,this.notCallLandlordImg.x=this.width-this.notCallLandlordImg.width,this.addTimesImg.x=this.width-this.addTimesImg.width,this.notAddTimesImg.x=this.width-this.notAddTimesImg.width,this.noBiggerCardsImg.x=this.width-this.noBiggerCardsImg.width,this.notPlayImg.x=this.width-this.notPlayImg.width)},t.prototype.hideAllState=function(){this.callOnePointImage.visible=!1,this.callTwoPointImage.visible=!1,this.callThreePointImage.visible=!1,this.notCallLandlordImg.visible=!1,this.addTimesImg.visible=!1,this.notAddTimesImg.visible=!1,this.noBiggerCardsImg.visible=!1,this.notPlayImg.visible=!1},t.prototype.setState=function(e){switch(this.hideAllState(),e){case 1:this.callOnePointImage.visible=!0;break;case 2:this.callTwoPointImage.visible=!0;break;case 3:this.callThreePointImage.visible=!0;break;case 4:this.notCallLandlordImg.visible=!0;break;case 5:this.addTimesImg.visible=!0;break;case 7:this.noBiggerCardsImg.visible=!0;break;case 8:this.notPlayImg.visible=!0;break;case 6:this.notAddTimesImg.visible=!0}},t}(QPLayer);__reflect(DDZPlayerStateView.prototype,"DDZPlayerStateView");var DDZPlayerView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPlayerUI",t}return __extends(t,e),t.prototype.setCharacterImageSource=function(e){this.characterImg.source=e},t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t}(QPLayer);__reflect(DDZPlayerView.prototype,"DDZPlayerView");var DDZRightPlayerGameInfoView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZRightPlayerGameInfoUI",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.playerStateView.setItemAlign(1)},t}(DDZPlayerGameInfoBaseView);__reflect(DDZRightPlayerGameInfoView.prototype,"DDZRightPlayerGameInfoView");var DDZWarningLightView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZWarningLightUI",t}return __extends(t,e),t.prototype.show=function(){this.visible=!0,this.warningLightShine.gotoAndPlay("shine",-1)},t.prototype.hide=function(){this.visible=!1,this.warningLightShine.gotoAndStop("shine")},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this);var t=RES.getRes("warning_light_json"),n=RES.getRes("warning_light_png"),a=new egret.MovieClipDataFactory(t,n);this.warningLightShine=new egret.MovieClip(a.generateMovieClipData("shine")),this.contentGroup.addChild(this.warningLightShine),this.hide()},t}(QPLayer);__reflect(DDZWarningLightView.prototype,"DDZWarningLightView");var DDZPopupStore=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPopupStoreUI",t.storeModel=new DDZStoreModel,t}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.PURCHASE_COIN,this.purchaseCoins,this)},t.prototype.onExit=function(){e.prototype.onExit.call(this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.PURCHASE_COIN,this.purchaseCoins,this)},t.prototype.createChildren=function(){var t=this;e.prototype.createChildren.call(this),this.tabbar.dataProvider=new eui.ArrayCollection([{upImageName:"btn_popup_store_type_coin@2x_png",downImageName:"btn_popup_store_type_coin_on@2x_png"},{upImageName:"btn_popup_store_type_diamond@2x_png",downImageName:"btn_popup_store_type_diamond_on@2x_png"}]),this.tabbar.itemRenderer=DDZPopupStoreTabbarItem,this.tabbar.selectedIndex=0,this.tabbar.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onGoodTypeTabbarItemTap,this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressCloseButton,this),this.storeModel.fetchCoinGoods(function(e){t.goodsListView.showGoodsListByType(0,e)})},t.prototype.onGoodTypeTabbarItemTap=function(e){var t=this;0===e.itemIndex?this.storeModel.fetchCoinGoods(function(e){t.goodsListView.showGoodsListByType(0,e)}):1===e.itemIndex&&this.storeModel.fetchDiamondGoods(function(e){t.goodsListView.showGoodsListByType(1,e)})},t.prototype.purchaseCoins=function(e){var t=this,n=new QPLoadingScene;n.show();var a={failed:function(e){n.hide(),QPAlert.sharedInstance().showAt(t,e.message)},purchasedSuccessfully:function(e){UserModel.sharedInstance().addBalance(1e4),n.hide(),QPAlert.sharedInstance().showAt(t,e.message),UserModel.sharedInstance().verifyIAPReceipt(e.receipt,function(e){return e?void egret.log(e.message):void egret.log("purchaseGoodsById purchasedSuccessfully ..................")})},purchasing:function(e){egret.log("purchasing goods...")}};this.storeModel.purchaseGoodsById(e.productId,a)},t.prototype.onPressCloseButton=function(){qp.SceneManager.sharedInstance().removeChildLayer(this)},t}(QPLayer);__reflect(DDZPopupStore.prototype,"DDZPopupStore");var DDZPopupStoreTabbarItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZPopupStoreTabbarItemUI",t}return __extends(t,e),t.prototype.dataChanged=function(){this.upImage.source=this.data.upImageName,this.downImage.source=this.data.downImageName},t}(eui.ItemRenderer);__reflect(DDZPopupStoreTabbarItem.prototype,"DDZPopupStoreTabbarItem");var DDZRoomListScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZRoomListSceneUI",t.roomModel=new DDZRoomModel,t.addListener(),t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),QPAudioManager.sharedInstance().playBackgroundMusic("ddz_not_play_game_music_mp3",-1),this.fetchRoomList()},t.prototype.fetchRoomList=function(){var e=this;this.roomModel.fetchRooms(function(){e.createRooms()},function(e){})},t.prototype.createRooms=function(){this.roomList.dataProvider=new eui.ArrayCollection(this.roomModel.listRooms()),this.roomList.itemRenderer=DDZRoomView,this.roomList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onPressRoom,this)},t.prototype.addListener=function(){this.topToolbar.pressBackButtonHandler=this.goBack.bind(this),this.topToolbar.pressSettingsButtonHandler=this.goSettings.bind(this)},t.prototype.goBack=function(){qp.SceneManager.sharedInstance().replaceScene(new DDZHomeScene)},t.prototype.goSettings=function(){var e=Device.sharedInstance().screenShoot(this);qp.SceneManager.sharedInstance().pushScene(new DDZSettingsScene(e))},t.prototype.onPressRoom=function(e){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1)},t}(QPScene);__reflect(DDZRoomListScene.prototype,"DDZRoomListScene");var DDZRoom=function(){function e(e){this.id=void 0,this.requiredCount=0,this.playerCount=0,this.backgroundImageName=e.bg_name,this.nameImage=e.image_name,this.id=e.id,this.requiredCount=e.required_coin,this.playerCount=e.player_count}return e}();__reflect(DDZRoom.prototype,"DDZRoom");var fakeRoomDatas=[{bg_name:"bg_rookie_room@2x_png",id:"d67f7749-2b63-4bd3-b6c4-1bbbe5427724",image_name:"img_rookie_room_name@2x_png",player_count:32929,required_coin:1e3},{bg_name:"bg_primary_room@2x_png",id:"d67f7749-2b63-4bd3-b6c4-2bbbe5427724",image_name:"img_primary_room_name@2x_png",player_count:3300,required_coin:2e3},{bg_name:"bg_normal_room@2x_png",id:"d67f7749-2b63-4bd3-b6c4-3bbbe5427724",image_name:"img_normal_room_name@2x_png",player_count:5898,required_coin:4e3},{bg_name:"bg_middle_room@2x_png",id:"d67f7749-2b63-4bd3-b6c4-4bbbe5427724",image_name:"img_middle_room_name@2x_png",player_count:6e3,required_coin:8e3},{bg_name:"bg_senior_room@2x_png",id:"d67f7749-2b63-4bd3-b6c4-5bbbe5427724",image_name:"img_senior_room_name@2x_png",player_count:8e3,required_coin:16e3},{bg_name:"bg_top_room@2x_png",id:"d67f7749-2b63-4bd3-b6c4-6bbbe5427724",image_name:"img_top_room_name@2x_png",player_count:9999,required_coin:16e3}],DDZRoomModel=function(e){function t(){var t=e.call(this)||this;return t.rooms=[],t}return __extends(t,e),t.prototype.requestPath=function(){return"/v1/connect"},t.prototype.requestParams=function(){return{player_id:UserModel.sharedInstance().attributeModel.id}},t.prototype.listRooms=function(){return this.rooms},t.prototype.fetchRooms=function(e,t){var n=this,a=new egret.Timer(500,1);a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){n.createRooms(fakeRoomDatas),e()},this),a.start()},t.prototype.createRooms=function(e){var t=this;e.forEach(function(e){var n=new DDZRoom(e);t.rooms.push(n)})},t}(QPNetworkApi);__reflect(DDZRoomModel.prototype,"DDZRoomModel");var DDZRoomTopToolbar=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZRoomTopToolbarUI",t.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressBackButton,t),t.settingsButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressSettingsButton,t),t}return __extends(t,e),t.prototype.onPressBackButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressBackButtonHandler&&this.pressBackButtonHandler()},t.prototype.onPressSettingsButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressSettingsButtonHandler&&this.pressSettingsButtonHandler()},t}(QPLayer);__reflect(DDZRoomTopToolbar.prototype,"DDZRoomTopToolbar");var DDZRoomView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZRoomUI",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressed,this)},t.prototype.dataChanged=function(){this.backgroundImage.source=this.data.backgroundImageName,this.nameImage.source=this.data.nameImage,this.playerCountLabel.text=this.data.playerCount,this.requiredCoinLabel.text=this.data.requiredCount},t.prototype.onPressed=function(){egret.log("press room cell")},t}(eui.ItemRenderer);__reflect(DDZRoomView.prototype,"DDZRoomView");var DDZSettingsScene=function(e){function t(t){var n=e.call(this)||this;return n.skinName="DDZSettingsUI",n.backgroundImage.source=t,n}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.popup.pressedCloseButtonHandler=this.closeScene.bind(this)},t.prototype.closeScene=function(){qp.SceneManager.sharedInstance().popScene()},t}(QPScene);__reflect(DDZSettingsScene.prototype,"DDZSettingsScene");var DDZSettingsModel=function(){function e(){QPAudioManager.sharedInstance().setBackgroundMusicVolume(e.MAX_MUSIC_VOLUME),QPAudioManager.sharedInstance().setSoundEffectVolume(e.MAX_SOUND_VOLUME),Device.sharedInstance().isLaunchedApp?(this.isMusicOn=DDZCacheModel.sharedInstance().booleanForKey(e.SAVE_MUSIC_STATE_KEY),this.isSoundOn=DDZCacheModel.sharedInstance().booleanForKey(e.SAVE_SOUND_STATE_KEY)):(this.isMusicOn=!0,this.saveMusicState(),this.isSoundOn=!0,this.saveSoundState())}return e.sharedInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.switchMuisc=function(){if(this.isMusicOn=!this.isMusicOn,this.isMusicOn){var e=new DDZMusicEvent(DDZMusicEvent.PLAY_MUSIC_EVENT);DDZEventCenter.sharedInstance().dispatchEvent(e)}else{var t=new DDZMusicEvent(DDZMusicEvent.STOP_MUSIC_EVENT);DDZEventCenter.sharedInstance().dispatchEvent(t)}this.saveMusicState()},e.prototype.switchSound=function(){this.isSoundOn=!this.isSoundOn,this.saveSoundState()},e.prototype.saveMusicState=function(){DDZCacheModel.sharedInstance().setBoolean(e.SAVE_MUSIC_STATE_KEY,this.isMusicOn)},e.prototype.saveSoundState=function(){DDZCacheModel.sharedInstance().setBoolean(e.SAVE_SOUND_STATE_KEY,this.isSoundOn)},e.MAX_MUSIC_VOLUME=100,e.MAX_SOUND_VOLUME=100,e.SAVE_MUSIC_STATE_KEY="DDZSettingsModel.music.state.key",e.SAVE_SOUND_STATE_KEY="DDZSettingsModel.sound.state.key",e}();__reflect(DDZSettingsModel.prototype,"DDZSettingsModel");var DDZSettingsPopup=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.closeButton.pressHandler=this.onCloseButtonPressed.bind(this),this.musicSwitch.setTitle("音乐"),this.musicSwitch.setSelected(!DDZSettingsModel.sharedInstance().isMusicOn),this.soundSwitch.setTitle("音效"),this.soundSwitch.setSelected(!DDZSettingsModel.sharedInstance().isSoundOn),this.musicSwitch.switchChangedHandler=function(){DDZSettingsModel.sharedInstance().switchMuisc()},this.soundSwitch.switchChangedHandler=function(){DDZSettingsModel.sharedInstance().switchSound()}},t.prototype.onCloseButtonPressed=function(){this.pressedCloseButtonHandler&&this.pressedCloseButtonHandler()},t}(QPPopupLayer);__reflect(DDZSettingsPopup.prototype,"DDZSettingsPopup");var DDZSettingsSwitch=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZSettingsSwitchUI",t}return __extends(t,e),t.prototype.setTitle=function(e){this.titleLabel.text=e},t.prototype.setSelected=function(e){this["switch"].selected=e},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this["switch"].addEventListener(eui.UIEvent.CHANGE,this.switchChanged,this)},t.prototype.switchChanged=function(){this.switchChangedHandler&&this.switchChangedHandler(),QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1)},t}(QPLayer);__reflect(DDZSettingsSwitch.prototype,"DDZSettingsSwitch");var BirthdayScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="BirthdaySceneUI",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.continueButton.enabled=!1,this.birthdayInput.titleLabel.text="生日",this.hintLabel.text="日期格式为 1970-1-1",this.birthdayInput.addEventListener(egret.Event.CHANGE,this.onBirthdayChanged,this),this.continueButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onContinueButtonTouch,this),this.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackButtonTouch,this)},t.prototype.onBirthdayChanged=function(){var e=this.birthdayInput.textDisplay.text;e.isValidDate()?(this.continueButton.enabled=!0,UserModel.sharedInstance().inputtedAttributeModel.setBirthday(e)):(this.continueButton.enabled=!1,UserModel.sharedInstance().inputtedAttributeModel.setBirthday(""))},t.prototype.onContinueButtonTouch=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().pushScene(new UsernameScene)},t.prototype.onBackButtonTouch=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().popScene()},t}(QPScene);__reflect(BirthdayScene.prototype,"BirthdayScene");var NicknameScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="NicknameSceneUI",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.firstNameInput.titleLabel.text="名字",this.lastNameInput.titleLabel.text="姓氏",this.continueButton.enabled=!1,this.firstNameInput.addEventListener(egret.Event.CHANGE,this.onFirstNameChanged,this),this.lastNameInput.addEventListener(egret.Event.CHANGE,this.onLastNameChanged,this),this.continueButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onContinueButtonTouch,this),this.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackButtonTouch,this)},t.prototype.onFirstNameChanged=function(){UserModel.sharedInstance().inputtedAttributeModel.setFirstName(this.firstNameInput.textDisplay.text),this.checkNickname()},t.prototype.onLastNameChanged=function(){UserModel.sharedInstance().inputtedAttributeModel.setFirstName(this.lastNameInput.textDisplay.text),this.checkNickname()},t.prototype.checkNickname=function(){UserModel.sharedInstance().inputtedAttributeModel.hasNickname()?this.continueButton.enabled=!0:this.continueButton.enabled=!1},t.prototype.onContinueButtonTouch=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().pushScene(new BirthdayScene)},t.prototype.onBackButtonTouch=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().popScene()},t}(QPScene);__reflect(NicknameScene.prototype,"NicknameScene");var PasswordScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="PasswordSceneUI",t.passwordInput.titleLabel.text="密码",t.passwordInput.addEventListener(egret.Event.CHANGE,t.onPasswordInputChanged,t),t.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressBackButton,t),t.continueButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressContinueButton,t),t.warningLabel.visible=!1,t.continueButton.enabled=!1,t}return __extends(t,e),t.prototype.onPressBackButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().popScene()},t.prototype.onPressContinueButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().pushScene(new RequestVerificationCodeScene)},t.prototype.onPasswordInputChanged=function(e){var t=e.target.text;t.canBePassword()?(this.warningLabel.visible=!1,UserModel.sharedInstance().inputtedAttributeModel.setPassword(t)):this.warningLabel.visible=!0,t||(this.warningLabel.visible=!1),this.continueButton.enabled=!this.warningLabel.visible},t}(QPScene);__reflect(PasswordScene.prototype,"PasswordScene");var SignInScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="SignInSceneUI",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.accountInput.titleLabel.text="手机号",this.passwordInput.titleLabel.text="密码",this.signInButton.enabled=!1,this.accountInput.addEventListener(egret.Event.CHANGE,this.onAccountChange,this),this.passwordInput.addEventListener(egret.Event.CHANGE,this.onPasswordChange,this),this.forgetPasswordLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onForgetPasswordLabelTouch,this),this.signInButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSignInButtonTouch,this),this.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackButtonTouch,this)},t.prototype.onAccountChange=function(){UserModel.sharedInstance().inputtedAttributeModel.setPhoneNumber(this.accountInput.textDisplay.text),this.checkInputted()},t.prototype.onPasswordChange=function(){UserModel.sharedInstance().inputtedAttributeModel.setPassword(this.passwordInput.textDisplay.text),this.checkInputted()},t.prototype.checkInputted=function(){UserModel.sharedInstance().inputtedAttributeModel.hasAccountAndPassword()?this.signInButton.enabled=!0:this.signInButton.enabled=!1},t.prototype.onForgetPasswordLabelTouch=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1)},t.prototype.onSignInButtonTouch=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.signIn(this.accountInput.textDisplay.text,this.passwordInput.textDisplay.text)},t.prototype.onBackButtonTouch=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().popScene()},t.prototype.signIn=function(e,t){var n=this;UserModel.sharedInstance().inputtedAttributeModel.setPhoneNumber(e),UserModel.sharedInstance().inputtedAttributeModel.setPassword(t),this.signInLoading=new QPLoadingScene,this.signInLoading.show();var a=UserModel.sharedInstance().actionDataFactory.makeSignInData();UserModel.sharedInstance().actionModel.signIn(a,function(e){UserModel.sharedInstance().saveUserInformation(e),n.goHomeScene()},function(e){n.signInLoading.hide(),QPAlert.sharedInstance().showOKButtonAt(n,e.message)})},t.prototype.goHomeScene=function(){var e=this;UserModel.sharedInstance().connectRealtimeGameService(function(t){return e.signInLoading.hide(),t?void QPAlert.sharedInstance().showOKButtonAt(e,t.message):void qp.SceneManager.sharedInstance().replaceScene(new DDZHomeScene)})},t}(QPScene);__reflect(SignInScene.prototype,"SignInScene");var UsernameScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="UsernameSceneUI",t.usernameStateMachine=new UsernameStateMachine,t.usernameStateMachine.handleInputText(t.inputStateLabel,t.usernameInput),t.continueButton.enabled=t.usernameStateMachine.isStateOk(),t.usernameInput.titleLabel.text="用户名",t.continueButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressContinueButton,t),t.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressBackButton,t),t.usernameInput.addEventListener(egret.Event.CHANGE,t.onUsernameInputChanged,t),t}return __extends(t,e),t.prototype.onPressContinueButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().pushScene(new PasswordScene)},t.prototype.onPressBackButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().popScene()},t.prototype.onUsernameInputChanged=function(e){this.usernameStateMachine.handleInputText(this.inputStateLabel,e.target),this.continueButton.enabled=this.usernameStateMachine.isStateOk()},t}(QPScene);__reflect(UsernameScene.prototype,"UsernameScene");var UsernameState;!function(e){e[e.None=0]="None",e[e.TooShort=1]="TooShort",e[e.TooLong=2]="TooLong",e[e.AlreadyTaken=3]="AlreadyTaken",e[e.Ilegal=4]="Ilegal",e[e.Ok=5]="Ok"}(UsernameState||(UsernameState={}));var UsernameStateMachine=function(){function e(){this.state=UsernameState.None}return e.prototype.getCurrentState=function(){return this.state},e.prototype.isStateOk=function(){return this.state===UsernameState.Ok},e.prototype.handleInputText=function(e,t){switch(this.state=this.getStateByText(t.text),this.state){case UsernameState.None:e.text="";break;case UsernameState.TooShort:e.text="哎呀！用户名必须至少包含3个字符",e.textColor=Color.Red;break;case UsernameState.TooLong:e.text="哎呀！用户名必须至多包含15个字符",e.textColor=Color.Red;break;case UsernameState.Ilegal:e.text="用户名只能使用英文和数字",e.textColor=Color.Red;break;case UsernameState.Ok:e.text="此用户名可用",e.textColor=Color.TextGray,UserModel.sharedInstance().inputtedAttributeModel.setUsername(t.text)}},e.prototype.getStateByText=function(e){return e?3<=e.length&&e.length<=15?e.canBeUsername()?UsernameState.Ok:UsernameState.Ilegal:e.length<3?UsernameState.TooShort:e.length>15?UsernameState.TooLong:UsernameState.None:UsernameState.None},e}();__reflect(UsernameStateMachine.prototype,"UsernameStateMachine");var RequestVerificationCodeScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="RequestVerificationCodeSceneUI",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.phoneNumberInput.titleLabel.text="手机号码",this.phoneNumberInput.addEventListener(egret.Event.CHANGE,this.onPhoneNumberInputChanged,this),this.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressBack,this),this.continueButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressContinue,this)},t.prototype.onPressBack=function(){qp.SceneManager.sharedInstance().popScene()},t.prototype.onPressContinue=function(){this.requestVerificationCode(this.phoneNumberInput.text)},t.prototype.requestVerificationCode=function(e){var t=this;UserModel.sharedInstance().inputtedAttributeModel.setPhoneNumber(e);var n=UserModel.sharedInstance().actionDataFactory.makeSendVerificationCodeData();if(!n.isLegal)return this.showWarningTips("该手机号码无效!"),void egret.log("请求 验证码 提交的数据 不正确!");var a=new QPLoadingScene;a.show(),UserModel.sharedInstance().actionModel.sendVerificationCode(n,function(e){UserModel.sharedInstance().attributeModel.setHashDigest(e.hash_digest),UserModel.sharedInstance().attributeModel.setExpireISOTime(e.expire_iso_time),t.requestSuccess(),a.hide(),egret.log("验证码请求成功: "+e)
},function(e){a.hide(),t.showWarningTips(e.message),egret.log("验证码请求失败: "+e.message)})},t.prototype.requestSuccess=function(){qp.SceneManager.sharedInstance().pushScene(new SignUpScene)},t.prototype.showWarningTips=function(e){this.tipsLabel.text=e,this.tipsLabel.textColor=Color.Red},t.prototype.onPhoneNumberInputChanged=function(e){this.tipsLabel.text="我们将通过短信发送验证码。",this.tipsLabel.textColor=Color.Black;var t=e.target.text;t.isValidPhoneNumber()?this.continueButton.enabled=!0:this.continueButton.enabled=!1},t}(QPScene);__reflect(RequestVerificationCodeScene.prototype,"RequestVerificationCodeScene");var SignUpScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="SignUpSceneUI",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.phoneNumber=UserModel.sharedInstance().inputtedAttributeModel.getPhoneNumber(),this.verificationCodeInput.titleLabel.text="验证码",this.showVerificationInptTips(),this.verificationCodeInput.addEventListener(egret.Event.CHANGE,this.onVerificationCodeInputChanged,this),this.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressBack,this),this.continueButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressContinue,this)},t.prototype.showVerificationInptTips=function(){this.verificationInputTipsLabel.text="输入我们发送至 "+this.phoneNumber+" 的验证码"},t.prototype.onPressBack=function(){qp.SceneManager.sharedInstance().popScene()},t.prototype.onPressContinue=function(){this.signUp(this.verificationCodeInput.text)},t.prototype.signUp=function(e){var t=this;UserModel.sharedInstance().inputtedAttributeModel.setVerificationCode(e);var n=new QPLoadingScene;n.show();var a=UserModel.sharedInstance().actionDataFactory.makeSignUpData();UserModel.sharedInstance().actionModel.signUp(a,function(e){UserModel.sharedInstance().saveUserInformation(e),t.signUpSuccess(),n.hide(),egret.log("注册用户成功: "+e)},function(e){n.hide(),t.showWarningTips(e.message),egret.log("注册用户失败: "+e.message)})},t.prototype.signUpSuccess=function(){qp.SceneManager.sharedInstance().replaceScene(new FriendsSearchScene)},t.prototype.showWarningTips=function(e){this.warningLabel.text=e,this.warningLabel.visible=!0},t.prototype.onVerificationCodeInputChanged=function(e){this.warningLabel.visible=!1;var t=e.target.text;t.isValidVerificationCode()?this.continueButton.enabled=!0:this.continueButton.enabled=!1},t}(QPScene);__reflect(SignUpScene.prototype,"SignUpScene");var DDZStoreScene=function(e){function t(t){var n=e.call(this)||this;return n.storeType=t||0,n.skinName="DDZStoreSceneUI",n.storeModel=new DDZStoreModel,n.topToolbar.pressBackButtonHandler=n.goBack.bind(n),n}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this),DDZEventCenter.sharedInstance().addEventListener(DDZButtonEvent.PURCHASE_COIN,this.purchaseCoins,this)},t.prototype.onExit=function(){e.prototype.onExit.call(this),DDZEventCenter.sharedInstance().removeEventListener(DDZButtonEvent.PURCHASE_COIN,this.purchaseCoins,this)},t.prototype.createChildren=function(){var t=this;e.prototype.createChildren.call(this),this.tabBar.itemRenderer=DDZStoreTabbarItem,this.tabBar.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onTappedTabbarItem,this),this.storeModel.fetchStoreTypes(function(e){t.tabBar.dataProvider=new eui.ArrayCollection(e),0===t.storeType?(t.tabBar.selectedIndex=0,t.showCoinGoods()):1===t.storeType&&(t.tabBar.selectedIndex=1,t.showDiamondGoods())})},t.prototype.purchaseCoins=function(e){var t=this,n=new QPLoadingScene;n.show();var a={failed:function(e){n.hide(),QPAlert.sharedInstance().showAt(t,e.message)},purchasedSuccessfully:function(e){n.hide(),UserModel.sharedInstance().addBalance(1e4),QPAlert.sharedInstance().showAt(t,e.message),UserModel.sharedInstance().verifyIAPReceipt(e.receipt,function(e){return e?void egret.log(e.message):void egret.log("purchaseGoodsById purchasedSuccessfully ..................")})},purchasing:function(e){egret.log("purchasing goods...")}};this.storeModel.purchaseGoodsById(e.productId,a)},t.prototype.onTappedTabbarItem=function(e){switch(QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),e.itemIndex){case 0:this.showCoinGoods();break;case 1:this.showDiamondGoods();break;case 2:this.showExchangeGoods();break;case 3:this.showPropsGoods()}},t.prototype.goBack=function(){qp.SceneManager.sharedInstance().popScene()},t.prototype.showCoinGoods=function(){var e=this;this.storeModel.fetchCoinGoods(function(t){e.goodsListView.showGoodsListByType(0,t)})},t.prototype.showDiamondGoods=function(){var e=this;this.storeModel.fetchDiamondGoods(function(t){e.goodsListView.showGoodsListByType(1,t)})},t.prototype.showExchangeGoods=function(){egret.log("showExchangeGoods...")},t.prototype.showPropsGoods=function(){egret.log("showPropsGoods....")},t}(QPScene);__reflect(DDZStoreScene.prototype,"DDZStoreScene");var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),QPResource.LaunchGameGroup.sharedInstance().loadCompleteHandler=this.loadLaunchGameGroupFinish.bind(this),QPResource.HomeGroup.sharedInstance().loadCompleteHandler=this.loadHomeGroupFinish.bind(this),QPResource.HomeGroup.sharedInstance().loadProgressHandler=this.loadResourceProgress.bind(this),QPResource.CommonImagesGroup.sharedInstance().loadCompleteHandler=this.loadCommonImagesGroupFinish.bind(this),QPResource.UserAgreementGroup.sharedInstance().loadCompleteHandler=this.loadUserAgreementGroupFinish.bind(this),QPResource.CommonMusicGroup.sharedInstance().loadCompleteHandler=this.loadCommonMusicGroupFinish.bind(this);var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onLoadConfigFinish,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.startCreateScene=function(){Device.sharedInstance().setWidth(Math.min(this.stage.width,this.stage.height)),Device.sharedInstance().setHeight(Math.max(this.stage.width,this.stage.height)),this.stage.removeChild(this.gameLaunchScene),qp.SceneManager.sharedInstance().replaceScene(new DDZEntryScene)},t.prototype.onLoadConfigFinish=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onLoadConfigFinish,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onLoadThemeFinish,this)},t.prototype.onLoadThemeFinish=function(){egret.ExternalInterface.call("RuntimeInterface","load resource complete"),this.isThemeLoadEnd=!0,QPResource.LaunchGameGroup.sharedInstance().load()},t.prototype.loadLaunchGameGroupFinish=function(e){this.gameLaunchScene=new GameLaunchScene,this.stage.addChild(this.gameLaunchScene),QPResource.HomeGroup.sharedInstance().load()},t.prototype.loadHomeGroupFinish=function(e){QPResource.HomeGroup.sharedInstance().isLoaded=!0,this.createScene(),QPResource.CommonMusicGroup.sharedInstance().load()},t.prototype.loadCommonMusicGroupFinish=function(e){QPResource.CommonMusicGroup.sharedInstance().isLoaded=!0,this.createScene(),QPResource.CommonImagesGroup.sharedInstance().load()},t.prototype.loadCommonImagesGroupFinish=function(e){QPResource.CommonImagesGroup.sharedInstance().isLoaded=!0,this.createScene(),QPResource.UserAgreementGroup.sharedInstance().load()},t.prototype.loadUserAgreementGroupFinish=function(e){QPResource.UserAgreementGroup.sharedInstance().isLoaded=!0,this.createScene()},t.prototype.createScene=function(){this.canCreateScene()&&(qp.SceneManager.sharedInstance().addRootStage(this),this.startCreateScene())},t.prototype.canCreateScene=function(){return this.isThemeLoadEnd&&QPResource.HomeGroup.sharedInstance().isLoaded&&QPResource.CommonImagesGroup.sharedInstance().isLoaded&&QPResource.CommonMusicGroup.sharedInstance().isLoaded&&QPResource.UserAgreementGroup.sharedInstance().isLoaded?!0:!1},t.prototype.loadResourceProgress=function(e){this.gameLaunchScene.setProgress(e.itemsLoaded,e.itemsTotal)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DDZIAPResponseType;!function(e){e[e.Purchasing=0]="Purchasing",e[e.PurchasedSuccessfully=1]="PurchasedSuccessfully"}(DDZIAPResponseType||(DDZIAPResponseType={}));var DDZIAPResponse=function(){function e(e){this.type=e.type,this.message=e.message,this.receipt=e.receipt}return e}();__reflect(DDZIAPResponse.prototype,"DDZIAPResponse");var DDZProduct=function(){function e(e){this.id=e.product_id,this.image=e.product_image,this.price=e.product_price,this.quantity=e.product_quantity}return e}();__reflect(DDZProduct.prototype,"DDZProduct");var testDiamonds=[{portraitImageName:"img_store_diamonds_1@2x_png",price:6,productId:DDZAppleIAPModel.PRODUCT_10_DIAMONDS_ID,quantity:10},{portraitImageName:"img_store_diamonds_2@2x_png",price:12,productId:DDZAppleIAPModel.PRODUCT_20_DIAMONDS_ID,quantity:20},{portraitImageName:"img_store_diamonds_3@2x_png",price:18,productId:DDZAppleIAPModel.PRODUCT_30_DIAMONDS_ID,quantity:30},{portraitImageName:"img_store_diamonds_4@2x_png",price:24,productId:DDZAppleIAPModel.PRODUCT_40_DIAMONDS_ID,quantity:40},{portraitImageName:"img_store_diamonds_5@2x_png",price:30,productId:DDZAppleIAPModel.PRODUCT_50_DIAMONDS_ID,quantity:50}],testStoreTypes=[{upImageName:"btn_store_coin@2x_png",downImageName:"btn_store_coin_on@2x_png"}],DDZStoreModel=function(e){function t(){var t=e.call(this)||this,n=RES.getRes("iap_id_config_json"),a=n.coin;return t.createCoinProducts(a),t}return __extends(t,e),t.prototype.purchaseGoodsById=function(e,t){return Device.sharedInstance().isiOS()?void DDZAppleIAPModel.sharedInstance().purchaseDiamondByProductId(e,function(e){e.type===DDZIAPResponseType.Purchasing?t.purchasing&&t.purchasing(e):e.type===DDZIAPResponseType.PurchasedSuccessfully&&t.purchasedSuccessfully&&t.purchasedSuccessfully(e)},function(e){t.failed&&t.failed(e)}):void(t.failed&&t.failed(new Error("抱歉，此平台不支持购买，请下载App购买")))},t.prototype.fetchCoinGoods=function(e,t){e(this.coinProducts)},t.prototype.fetchDiamondGoods=function(e,t){e([])},t.prototype.fetchStoreTypes=function(e,t){e(testStoreTypes)},t.prototype.createCoinProducts=function(e){this.coinProducts=[];for(var t=0,n=e;t<n.length;t++){var a=n[t],r=new DDZProduct(a);this.coinProducts.push(r)}},t}(QPNetworkApi);__reflect(DDZStoreModel.prototype,"DDZStoreModel");var DDZStoreTypeName=function(){function e(){}return e.COIN="金币",e.DIAMOND="钻石",e.EXCHANGE="兑换",e.PROPS="道具",e}();__reflect(DDZStoreTypeName.prototype,"DDZStoreTypeName");var DDZStoreCoinGoodView=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.coinGroup.visible=!1},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.diamondPriceLabel.text=String(this.data.price)},t.prototype.onPurchaseButtonPressed=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZButtonEvent(DDZButtonEvent.PURCHASE_COIN);e.productQuantity=this.data.quantity,e.productId=this.data.id,DDZEventCenter.sharedInstance().dispatchEvent(e)},t}(DDZStoreGoodView);__reflect(DDZStoreCoinGoodView.prototype,"DDZStoreCoinGoodView");var DDZStoreDiamondGoodView=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.coinGroup.visible=!1},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.diamondPriceLabel.text=String(this.data.price)},t.prototype.onPurchaseButtonPressed=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZButtonEvent(DDZButtonEvent.PURCHASE_DIAMOND);e.productId=this.data.productId,e.productQuantity=this.data.quantity,DDZEventCenter.sharedInstance().dispatchEvent(e)},t}(DDZStoreGoodView);__reflect(DDZStoreDiamondGoodView.prototype,"DDZStoreDiamondGoodView");var DDZStoreGoodListView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZStoreGoodListUI",t}return __extends(t,e),t.prototype.showGoodsListByType=function(e,t){this.goodsList.dataProvider=new eui.ArrayCollection(t),0===e?this.goodsList.itemRenderer=DDZStoreCoinGoodView:1===e&&(this.goodsList.itemRenderer=DDZStoreDiamondGoodView)},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.goodsList.dataProvider=new eui.ArrayCollection([]),this.goodsList.itemRenderer=DDZStoreCoinGoodView},t}(QPLayer);__reflect(DDZStoreGoodListView.prototype,"DDZStoreGoodListView");var DDZCoinWareHouse=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(DDZBaseWarehouse);__reflect(DDZCoinWareHouse.prototype,"DDZCoinWareHouse");var DDZStoreTabbarItem=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.upImage.source=this.data.upImageName,this.downImage.source=this.data.downImageName},t}(eui.ItemRenderer);__reflect(DDZStoreTabbarItem.prototype,"DDZStoreTabbarItem");var DDZStoreTopToolbar=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZStoreTopToolbarUI",t.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressBackButton,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.coinWareHouse.setAmount(UserModel.sharedInstance().attributeModel.getBalanceAmount()),this.coinWareHouse.hideAddImage()},t.prototype.onPressBackButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressBackButtonHandler&&this.pressBackButtonHandler()},t}(QPLayer);__reflect(DDZStoreTopToolbar.prototype,"DDZStoreTopToolbar");var DDZTaskPopup=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZTaskPopupUI",t.taskActionModel=new DDZTaskActionModel,t}return __extends(t,e),t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.closeButton.pressHandler=this.onPressCloseButton.bind(this),this.emptyContentView.visible=!1,this.contentScroller.viewport=this.contentList,this.taskActionModel.fetchTasks(function(e){t.taskActionModel.createTasks(e.tasks),t.leftTabbar.dataProvider=new eui.ArrayCollection(t.taskActionModel.listAllTaskNames()),t.leftTabbar.itemRenderer=DDZTaskTabbarItem,t.leftTabbar.addEventListener(eui.ItemTapEvent.ITEM_TAP,t.onTapTaskTabbarAtIndex,t),t.leftTabbar.selectedIndex=0,t.showTaskContentAtIndex(0)},function(e){QPAlert.sharedInstance().showOKButtonAt(t.parent,e.message)})},t.prototype.onTapTaskTabbarAtIndex=function(e){this.showTaskContentAtIndex(e.itemIndex)},t.prototype.showTaskContentAtIndex=function(e){var t=this.taskActionModel.getTaskModelAtIndex(e);this.emptyContentView.visible=0===t.countSubTasks(),this.contentList.dataProvider=new eui.ArrayCollection(t.listSubTaskModels()),this.contentList.itemRenderer=DDZTaskItem,this.contentList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onPressTaskItem,this)},t.prototype.onPressTaskItem=function(e){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),QPAlert.sharedInstance().showAt(this.parent,"暂未开放此功能，敬请期待"),egret.log(e)},t.prototype.onPressCloseButton=function(){this.pressCloseButtonHandler&&this.pressCloseButtonHandler()},t}(QPPopupLayer);__reflect(DDZTaskPopup.prototype,"DDZTaskPopup");var DDZTaskScene=function(e){function t(t){var n=e.call(this)||this;return n.skinName="DDZTaskSceneUI",n.backgroundImage.source=t,n.popup.pressCloseButtonHandler=n.goBack.bind(n),n}return __extends(t,e),t.prototype.goBack=function(){qp.SceneManager.sharedInstance().popScene()},t}(QPScene);__reflect(DDZTaskScene.prototype,"DDZTaskScene");var TestDDZTaskActionModel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.startTest=function(){this.testFetchTasks()},t.prototype.testFetchTasks=function(){var e=this;this.taskActionModel=new DDZTaskActionModel,this.taskActionModel.fetchTasks(function(t){var n=t.tasks;e.taskActionModel.createTasks(n),e.assertEquals("tasks amount expect to "+n.length,n.length,e.taskActionModel.countTasks());var a=n[0],r=e.taskActionModel.getTaskModelAtIndex(0);e.assertEquals("task name expect to "+a.name,a.name,r.name),e.assertEquals("task description expect to "+a.description,a.description,r.description),e.assertEquals("task startAt expect to "+a.start_at,a.start_at,r.startAt),e.assertEquals("task endAt expect to "+a.end_at,a.end_at,r.endAt);var o=a.sub_tasks,s=o[0],i=r.getSubTaskModelAtIndex(0);e.assertEquals("subTask amount expect to "+o.length,o.length,r.countSubTasks()),e.assertEquals("subTask name expect to "+s.name,s.name,i.name),e.assertEquals("subTask finishedAmount expect to "+s.finished_amount,s.finished_amount,i.finishedAmount),e.assertEquals("subTask totalAmount expect to "+s.total_amount,s.total_amount,i.totalAmount);var d=s.award;e.assertEquals("subTask award type expect to "+d.type,d.type,i.awardType),e.assertEquals("subTask award type expect to "+d.quantity,d.quantity,i.awardQuantity),e.assertEquals("subTask award type expect to "+d.description,d.description,i.awardDescription)},function(e){throw new Error("testFetchTasks fetchTasks error : "+e.message)})},t}(QPTestCase);__reflect(TestDDZTaskActionModel.prototype,"TestDDZTaskActionModel");var TestDDZTaskRealtimeMessageModel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(QPTestCase);__reflect(TestDDZTaskRealtimeMessageModel.prototype,"TestDDZTaskRealtimeMessageModel");var DDZSubTaskModel=function(){function e(e){this.name=e.name,this.finishedAmount=e.finished_amount,this.totalAmount=e.total_amount,this.awardType=e.award.type,this.awardQuantity=e.award.quantity,this.awardDescription=e.award.description}return e}();__reflect(DDZSubTaskModel.prototype,"DDZSubTaskModel");var testTasks={tasks:[{name:"新手任务",description:"完成新手任务，有奖励哟，快去做任务吧",start_at:Date.now(),end_at:Date.now(),sub_tasks:[{name:"对局10次",finished_amount:0,total_amount:10,award:{type:"coin",quantity:2e3,description:""}},{name:"打出5个连对",finished_amount:3,total_amount:5,award:{type:"coin",quantity:3e3,description:""}}]},{name:"每天任务",description:"",start_at:Date.now(),end_at:Date.now(),sub_tasks:[{name:"当2次地主",finished_amount:1,total_amount:2,award:{type:"coin",quantity:200,description:""}},{name:"使用炸弹一次",finished_amount:0,total_amount:1,award:{type:"coin",quantity:200,description:""}},{name:"打两次飞机",finished_amount:2,total_amount:2,award:{type:"coin",quantity:600,description:""}}]}]},DDZTaskActionModel=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.fetchTasks=function(e,t){return void e(testTasks)},t.prototype.listAllTaskNames=function(){return this.tasks.map(function(e){return e.name})},t.prototype.createTasks=function(e){this.tasks=e.map(function(e){return new DDZTaskModel(e)})},t.prototype.countTasks=function(){return this.tasks.length},t.prototype.listTasks=function(){return this.tasks},t.prototype.getTaskModelAtIndex=function(e){return this.tasks[e]},t.prototype.mockTaskResponse=function(){var e=Mock.Random,t=Mock.mock({"ok|1":!0,result:{"tasks|4":[{name:e.email("task"),description:"我是任务介绍",start_at:e.datetime(),end_at:e.now(),"sub_tasks|1-3":[{name:"我是任务名字","finished_amount|0-3":0,"total_amount|3-5":5,award:{type:"coin","quantity|1000-100000":1e3,description:"我是奖励名字"}}]}]}});return t.result},t}(QPNetworkApi);__reflect(DDZTaskActionModel.prototype,"DDZTaskActionModel");var DDZTaskModel=function(){function e(e){this.name=e.name,this.description=e.description,this.startAt=e.start_at,this.endAt=e.end_at,this.subTaskModels=this.createSubTasks(e.sub_tasks)}return e.prototype.countSubTasks=function(){return this.subTaskModels.length},e.prototype.listSubTaskModels=function(){return this.subTaskModels},e.prototype.getSubTaskModelAtIndex=function(e){return this.subTaskModels[e]},e.prototype.createSubTasks=function(e){return e.map(function(e){return new DDZSubTaskModel(e)})},e}();__reflect(DDZTaskModel.prototype,"DDZTaskModel");var DDZTaskItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZTaskItemUI",t.getAwardButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressGetRewardButton,t),t.goButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressGoButton,t),t}return __extends(t,e),t.prototype.dataChanged=function(){this.titleLabel.text=this.data.name,this.awardQuantityLabel.text="x"+this.data.awardQuantity,egret.log("DDZTaskItem progressBar finished : "+this.data.finishedAmount+", total : "+this.data.totalAmount),this.progressBar.setProgress(this.data.finishedAmount,this.data.totalAmount)},t.prototype.onPressGetRewardButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1)},t.prototype.onPressGoButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1)},t}(eui.ItemRenderer);__reflect(DDZTaskItem.prototype,"DDZTaskItem");var DDZTaskProgressBar=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZTaskProgressBarUI",t}return __extends(t,e),t}(DDZBaseProgressBar);__reflect(DDZTaskProgressBar.prototype,"DDZTaskProgressBar");var DDZTaskTabbarItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZTaskTabbarItemUI",t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),egret.log("this.data is : "+this.data),this.titleLabel.text=this.data},t}(eui.ItemRenderer);__reflect(DDZTaskTabbarItem.prototype,"DDZTaskTabbarItem");var DDZUserAgreementScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZUserAgreementSceneUI",t.userAgreementCheckbox.addEventListener(egret.Event.CHANGE,t.checkBoxChanged,t),t.userAgreementButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressUserAgreementButton,t),t.touristSignInButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressTouristSignInButton,t),t.accountSignInButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressAccountSignInButton,t),t.becomeTouristUser(),UserModel.sharedInstance().setInputtedAttributeModel(new InputtedAttributeModel),t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),QPAudioManager.sharedInstance().playBackgroundMusic("ddz_not_play_game_music_mp3",-1),this.setUserAgreementCheckboxState(),this.popup.pressRefuseButtonHandler=this.refuseUserAgreement.bind(this),this.popup.pressAcceptButtonHandler=this.acceptUserAgreement.bind(this),this.popup.pressOkButtonHandler=this.readedUserAgreement.bind(this),UserModel.sharedInstance().actionModel.isAgreementReaded?this.hideUserAgreementPopup():this.showUserAgreementPopup(),this.setAppVersion()},t.prototype.becomeTouristUser=function(){UserModel.sharedInstance().setActionDataFactory(new TouristUserActionDataFactory),UserModel.sharedInstance().setAttributeModel(new TouristUserAttributeModel),UserModel.sharedInstance().attributeModel.getHasBindPhoneNumber()&&UserModel.sharedInstance().attributeModel.deleteAccount()},t.prototype.becomePhoneUser=function(){UserModel.sharedInstance().setActionDataFactory(new PhoneUserActionDataFactory),UserModel.sharedInstance().setAttributeModel(new PhoneUserAttributeModel)},t.prototype.setAppVersion=function(){var e=RES.getRes("app_version_json");this.versionLabel.text="v"+e.version},t.prototype.checkBoxChanged=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.userAgreementCheckbox.selected?UserModel.sharedInstance().actionModel.approveAgreement(!0):UserModel.sharedInstance().actionModel.approveAgreement(!1)},t.prototype.onPressUserAgreementButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.showUserAgreementPopup()},t.prototype.onPressTouristSignInButton=function(){return QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.becomeTouristUser(),UserModel.sharedInstance().actionModel.isAgreementApproved?void this.touristSignIn():void QPAlert.sharedInstance().showAt(this,"请勾选下面的服务协议，即可进入游戏哦")},t.prototype.onPressAccountSignInButton=function(){return QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.becomePhoneUser(),UserModel.sharedInstance().actionModel.isAgreementApproved?void qp.SceneManager.sharedInstance().replaceScene(new DDZAccountSignInScene):void QPAlert.sharedInstance().showAt(this,"请勾选下面的服务协议，即可进入游戏哦")},t.prototype.setUserAgreementCheckboxState=function(){this.userAgreementCheckbox.selected=UserModel.sharedInstance().actionModel.isAgreementApproved},t.prototype.refuseUserAgreement=function(){this.hideUserAgreementPopup(),UserModel.sharedInstance().actionModel.approveAgreement(!1)},t.prototype.acceptUserAgreement=function(){this.hideUserAgreementPopup(),UserModel.sharedInstance().actionModel.approveAgreement(!0),this.setUserAgreementCheckboxState(),this.touristSignIn()},t.prototype.readedUserAgreement=function(){this.hideUserAgreementPopup()},t.prototype.hideUserAgreementPopup=function(){this.popupGroup.visible=!1},t.prototype.showUserAgreementPopup=function(){this.popupGroup.visible=!0,this.popup.show()},t.prototype.touristSignIn=function(){var e=new QPLoadingScene;e.show(),UserModel.sharedInstance().attributeModel.getHasSignUp()?this.login(e):this.signUp(e)},t.prototype.signUp=function(e){var t=this,n=UserModel.sharedInstance().actionDataFactory.makeSignUpData();UserModel.sharedInstance().actionModel.signUp(n,function(n){UserModel.sharedInstance().attributeModel.setHasSignUp(!0),UserModel.sharedInstance().saveUserInformation(n),t.goHomeScene(e)},function(t){e.hide(),egret.log("register failed...."),egret.log(t)})},t.prototype.login=function(e){var t=this,n=UserModel.sharedInstance().actionDataFactory.makeSignInData();UserModel.sharedInstance().actionModel.signIn(n,function(n){UserModel.sharedInstance().saveUserInformation(n),t.goHomeScene(e)},function(n){e.hide(),QPAlert.sharedInstance().showAt(t,n.message),(n.type===QPNetworkErrorType.UserNotFound||"没有用户名"===n.message)&&UserModel.sharedInstance().attributeModel.deleteAccount()})},t.prototype.goHomeScene=function(e){var t=this;UserModel.sharedInstance().connectRealtimeGameService(function(n){return e.hide(),n?void QPAlert.sharedInstance().showOKButtonAt(t,n.message):void qp.SceneManager.sharedInstance().replaceScene(new DDZHomeScene)})},t}(QPScene);__reflect(DDZUserAgreementScene.prototype,"DDZUserAgreementScene");var DDZUserAgreementPopup=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZUserAgreementPopupUI",t.refuseButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressRefuseButton,t),t.acceptButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressAcceptButton,t),t.okButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressOkButton,t),t}return __extends(t,e),t.prototype.show=function(){UserModel.sharedInstance().actionModel.isAgreementReaded?(this.okGroup.visible=!0,this.refuseAndAcceptGroup.visible=!1):(this.okGroup.visible=!1,this.refuseAndAcceptGroup.visible=!0),UserModel.sharedInstance().actionModel.readAgreement()},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.contentLabel.lineSpacing=5,this.contentLabel.textFlow=[{text:"三秋科技许可及服务协议\n",style:{size:35,bold:!0}},{text:"《三秋科技许可及服务协议》（以下简称“本协议”）由您与成都三秋科技有限责任公司"},{text:"（以下简称“三秋科技”）提供方共同缔结，本协议具有合同效力。请您务必审慎阅读、"},{text:"充分理解各条款内容，特别是免除或者限制三秋科技责任的条款（以下称“免责条款”）、"},{text:"对用户权利进行限制的条款（以下称“限制条款”）、约定争议解决方式和司法管辖的条款，"},{text:"以及开通或使用某项服务的单独协议。前述免责、限制及争议解决方式和管辖条款可能以黑体"},{text:"加粗、颜色标记或其他合理方式提示您注意，包括但不限于本协议第二条、第三条、第四条、第六条"},{text:"、第九条等相关条款，您对该等条款的确认将可能导致您在特定情况下的被动、不便、损失，请您在确认"},{text:"同意本协议之前或在使用三秋科技游戏服务之前再次阅读前述条款。双方确认前述条款并非属于《合同法》"},{text:"第40条规定的“免除其责任、加重对方责任、排除对方主要权利的”的条款，并同意该条款的合法性及有效。"},{text:"除非您已阅读并接受本协议所有条款，否则您无权使用三秋科技游戏服务。如果您对本协议或三秋科技游戏服务"},{text:"有意见或建议，可与三秋科技客户服务部门联系，我们会给予您必要的帮助。您点击同意、接受或下一步，或您注册"},{text:"、使用三秋科技游戏服务均视为您已阅读并同意签署本协议。\n"},{text:"如果您未满18周岁，请在法定监护人的陪同下阅读本协议，并特别注意未成年人使用条款。如您为未成年人法定监护人，"},{text:"希望合理设定孩子娱乐时间，培养孩子健康游戏习惯的，可依据相关规则登录三秋科技家长监控平台"},{text:"（https://shafayouxi.com/jiazhang） 了解相关信息，您使用三秋科技成长守护平台的该项服务，"},{text:"应遵守该平台上的《家长监控许可及服务协议》。\n"},{text:"一、【定义】\n",style:{bold:!0}},{text:"      1.1 本协议：指本协议正文、《三秋科技游戏服务协议》、《三秋科技隐私政策》、游戏规则及其修订版本。"},{text:"上述内容一经正式发布，即为本协议不可分割的组成部分。本协议同时还包括文化部根据《网络游戏管理暂行办法》"},{text:"（文化部令第49号）制定的《网络游戏服务格式化协议必备条款》。\n"},{text:"      1.2 游戏规则：指三秋科技游戏服务提供方不时发布并修订的关于三秋科技的用户守则、玩家条例、游戏公告、提示及通知等内容。\n"},{text:"      1.3 三秋科技游戏服务提供方：指向您提供三秋科技及其服务的成都市三秋科技计算机系统有限公司，在本协议中简称为“三秋科技”。\n"},{text:"      1.4 三秋科技：指由三秋科技负责运营的游戏的统称，包括计算机客户端游戏、网页游戏、HTML5游戏（H5游戏）、移动终端游戏、"},{text:"电视端游戏以及其他形式的游戏；三秋科技可能以软件形式提供，这种情况下，三秋科技还包括该相关软件及相关文档。\n"},{text:"      1.5 三秋科技游戏服务：指三秋科技向您提供的与游戏相关的各项在线运营服务。\n"},{text:"      1.6 您：又称“玩家”或“用户”，指被授权使用三秋科技及其服务的自然人。\n"},{text:"      1.7 游戏数据：指您在使用三秋科技过程中产生的被服务器记录的各种数据，包括但不限于角色数据、"},{text:"虚拟物品数据、行为日志、购买日志等等数据。\n"},{text:"二、【游戏账号】\n",style:{bold:!0}},{text:"      2.1 您如果需要使用和享受三秋科技，则您需要将您享有使用权手机账号作为游戏账号，并按照"},{text:"《网络游戏管理暂行规定》及文化部《网络游戏服务格式化协议必备条款》的要求，登录实名注册系统并进行实名注册。"},{text:"您对三秋科技旗下游戏账号的申请、使用等行为应符合三秋科技不时修订并公布的《三秋科技游戏服务协议》、"},{text:"《三秋科技软件许可及服务协议》的规范。您进行实名注册时，应提供有关您本人真实、合法、准确、有效的身份信息及其他相关信息，"},{text:"且不得以他人身份资料进行实名注册。否则，三秋科技有权终止为您提供三秋科技游戏服务，并有权对您的游戏账号采取包括但不限于警告、"},{text:"限制或禁止使用游戏帐号全部或部分功能、删除游戏账号及游戏数据、删除相关信息、游戏账号封禁（以下有时简称“封号”）"},{text:"直至注销的处理措施（为描述方便，以下有时也将该等处理措施称为“处罚”），因此造成的一切后果由您自行承担。"},{text:"若您不进行实名注册的，或您提供的注册信息不完整的，则您可能无法使用三秋科技或在使用三秋科技过程中会受到相应限制。\n"},{text:"      2.2 您进一步知悉并同意，您在游客模式下可能无法进行游戏充值或消费。且一旦您卸载或重装三秋科技，或您更换手机、"},{text:"电脑等终端设备或该等终端设备损坏的，您在该游客模式下所有游戏相关数据可能都将会被清空，且无法查询和恢复。"},{text:"如因此造成您任何损失的，均由您自行承担。如您使用三秋科技认可的第三方帐号作为游戏账号使用和享受三秋科技的，"},{text:"您还应遵守有关该第三方帐号的协议、规则，且因该第三方帐号产生的相关问题包括但不限于被盗等，您应自行联系该第三方进行解决，"},{text:"三秋科技可视情况提供相应的协助。\n"},{text:"      2.3 您充分理解并同意：为判断或核实您提供的相关实名注册信息是否真实或有效，三秋科技有权将您提供的实名注册信息"},{text:"提供给第三方进行整理、保存及比对等处理。且三秋科技会按照国家相关要求将您的实名注册信息运用于防沉迷系统之中，"},{text:"即三秋科技可能会根据您的实名注册信息判断您是否年满18周岁、您提交的实名身份信息是否规范或实名验证是否通过等，"},{text:"从而决定是否对您的游戏账号予以防沉迷限制。\n"},{text:"      2.4 您充分理解并同意，三秋科技有权审查用户注册所提供的身份信息是否真实、有效，并应积极地采取技术与管理等合理"},{text:"措施保障用户账号的安全、有效；用户有义务妥善保管其账号及密码，并正确、安全地使用其账号及密码。任何一方未尽上述义务导致"},{text:"账号密码遗失、账号被盗等情形而给用户和他人的民事权利造成损害的，应当承担由此产生的法律责任。若您发现有他人冒用或盗用您的"},{text:"游戏账号及密码、或任何其他未经您合法授权使用的情形时，应立即以三秋科技要求的有效方式通知三秋科技并告知三秋科技需采取的措施。"},{text:"您通知三秋科技时，应提供与您注册身份信息相一致的个人有效身份信息，三秋科技收到您的有效请求并核实身份后，会根据您的要求或结合"},{text:"具体情况采取相应措施（包括但不限于暂停该账号的登录和使用等），三秋科技因根据您的请求采取相应措施而造成您及其他用户损失的，"},{text:"由您自行承担。若您没有提供有效身份信息或您提供的个人有效身份信息与所注册的身份信息不一致的，三秋科技有权拒绝您的请求，"},{text:"因此造成您损失的，由您自行承担。\n"},{text:"      2.5 您充分理解并同意，为高效利用服务器资源，如果您3年内未使用游戏账号登录三秋科技，三秋科技有权在提前通知的情况下，"},{text:"对该账号及其账号下的游戏数据及相关信息采取删除等处置措施。\n"},{text:"      2.6 您理解并同意，您不得将游戏账号以任何方式提供给他人使用，包括但不限于不得以转让、出租、借用等方式提供给他人作包括"},{text:"但不限于直播、录制、代打代练等商业性使用。否则，因此产生任何法律后果及责任均由您自行承担，且三秋科技有权对您的游戏账号采取包括"},{text:"但不限于警告、限制或禁止使用游戏帐号全部或部分功能、删除游戏账号及游戏数据及其他相关信息、封号直至注销的处理措施，"},{text:"因此造成的一切后果由您自行承担。\n"},{text:"三、【用户信息收集、使用及保护】\n",style:{bold:!0}},{text:"      3.1 您同意并授权三秋科技为履行本协议之目的收集您的用户信息，这些信息包括您在实名注册系统中注册的信息、"},{text:"您游戏账号下的游戏数据以及其他您在使用三秋科技游戏服务的过程中向三秋科技提供或三秋科技基于安全、用户体验优化等考虑"},{text:"而需收集的信息，三秋科技对您的用户信息的收集将遵循本协议及相关法律的规定。\n"},{text:"      3.2 您充分理解并同意：三秋科技或其合作的第三方可以根据您的用户信息，通过短信、电话、邮件等各种方式向您"},{text:"提供关于三秋科技的活动信息、推广信息等各类信息。\n"},{text:"      3.3 您理解并同意：为了更好地向您提供游戏服务，改善游戏体验，三秋科技可对您游戏账号中的昵称、头像以及在"},{text:"三秋科技中的相关操作信息、游戏信息等信息（以下称“该等信息”。该等信息具体包括但不限于您的登录状态、对战信息/状态、"},{text:"成就信息等）进行使用，并可向您本人或其他用户或好友展示该等信息。\n"},{text:"      3.4 您应对通过三秋科技及相关服务了解、接收或可接触到的包括但不限于其他用户在内的任何人的个人信息予以充分尊重，"},{text:"您不应以搜集、复制、存储、传播或以其他任何方式使用其他用户的个人信息，否则，由此产生的后果由您自行承担。\n"},{text:"      3.5 保护用户信息及隐私是三秋科技的一项基本原则。除本协议另有规定外，三秋科技游戏服务对用户信息收集、"},{text:"使用及保护等将遵循三秋科技统一公布的相关隐私政策"},{text:"（http://shafayouxi.com/privacy）。\n",style:{href:"http://shafayouxi.com/privacy"}},{text:"四、【三秋科技游戏服务】\n",style:{bold:!0}},{text:"      4.1 在您遵守本协议及相关法律法规的前提下，三秋科技给予您一项个人的、不可转让及非排他性的许可，以使用三秋科技游戏服务。"},{text:"您仅可为非商业目的使用三秋科技游戏服务，包括：\n"},{text:"         （1）接收、下载、安装、启动、升级、登录、显示、运行和/或截屏三秋科技；\n"},{text:"         （2）创建游戏角色，设置网名，查阅游戏规则、用户个人资料、游戏对局结果，开设游戏房间、设置游戏参数，在游戏中购买、"},{text:"使用游戏道具、游戏装备、游戏币等，使用聊天功能、社交分享功能；\n"},{text:"         （3）使用三秋科技支持并允许的其他某一项或几项功能。\n"},{text:"      4.2 您在使用三秋科技游戏服务过程中不得未经三秋科技许可以任何方式录制、直播或向他人传播三秋科技内容，"},{text:"包括但不限于不得利用任何第三方软件进行网络直播、传播等。\n"},{text:"      4.3 在三秋科技以软件形式提供的情况下，您在使用三秋科技及三秋科技游戏服务时还应符合本协议第五条关于软件许可的规定。\n"},{text:"      4.4 本条及本协议其他条款未明示授权的其他一切权利仍由三秋科技保留，您在行使这些权利时须另外取得三秋科技的书面许可。\n"},{text:"      4.5 如果您违反本协议约定的，三秋科技有权采取相应的措施进行处理，该措施包括但不限于：不经通知随时对相关内容进行删除，"},{text:"并视行为情节对违规游戏账号处以包括但不限于警告、限制或禁止使用全部或部分功能、游戏账号封禁直至注销的处罚，并公告处理结果，"},{text:"要求您赔偿因您从事违约行为而给三秋科技造成的损失等。\n"},{text:"      4.6 您充分理解并同意，三秋科技有权依合理判断对违反有关法律法规或本协议规定的行为进行处理，对违法违规的任何用户采取适当"},{text:"的法律行动，并依据法律法规保存有关信息向有关部门报告等，用户应独自承担由此而产生的一切法律责任。\n"},{text:"      4.7 您充分理解并同意，因您违反本协议或相关服务条款的规定，导致或产生第三方主张的任何索赔、要求或损失，您应当独立"},{text:"承担责任；三秋科技因此遭受损失的，您也应当一并赔偿。\n"},{text:"      4.8 您充分理解并同意：游戏道具、游戏装备、游戏币等是三秋科技游戏服务的一部分，三秋科技在此许可您依本协议而获得其"},{text:"使用权。您购买、使用游戏道具、游戏装备、游戏币等应遵循本协议、游戏具体规则的要求；同时，游戏道具、游戏装备、游戏币等可能受"},{text:"到一定有效期限的限制，即使您在规定的有效期内未使用，除不可抗力或可归责于三秋科技的原因外，一旦有效期届满，将会自动失效。您充"},{text:"分理解并同意：为更好地向用户提供三秋科技游戏服务，三秋科技有权对游戏中的任何内容或构成元素等作出调整、更新或优化（包括但不限"},{text:"于您购买或正在使用的角色、游戏装备及其他游戏道具的美术设计、性能及相关数值设置等作出调整、更新或优化等）。且如三秋科技做出相应"},{text:"调整、更新或优化的，您同意不会因此追究三秋科技的任何法律责任。\n"},{text:"      4.9 您充分理解并同意：为保障您游戏账号安全，为营造公平、健康及安全的游戏环境，在您使用三秋科技游戏服务的过程中，"},{text:"在不违反相关法律规定情况下，三秋科技可以通过技术手段了解您终端设备的随机存储内存以及与三秋科技同时运行的相关程序。一经发现有"},{text:"任何未经授权的、危害三秋科技游戏服务正常运营的相关程序，三秋科技可以收集所有与此有关的信息并采取合理措施予以打击。\n"},{text:"      4.10 您充分理解并同意：为了保证您及其他用户的游戏体验，三秋科技有权转移或者清除三秋科技游戏服务器上存储的一些过往的游戏数据。\n"},{text:"      4.11 三秋科技将按照相关法律法规和本协议的规定，采取切实有效的措施保护未成年人在使用三秋科技游戏服务过程中的合法权益，包括可能"},{text:"采取技术措施、禁止未成年人接触不适宜的游戏或者游戏功能、限制未成年人的游戏时间、预防未成年人沉迷网络。作为游戏规则的一部分，三秋科技"},{text:"还将在适当位置发布三秋科技用户指引和警示说明，包括游戏内容介绍、正确使用游戏的方法以及防止危害发生的方法。所有未成年人用户都应在法定"},{text:"监护人的指导下仔细阅读并遵照执行这些指引和说明；其他玩家在使用三秋科技游戏服务的过程中应避免发布、产生任何有损未成年人"},{text:"身心健康的内容，共同营造健康游戏环境。\n"},{text:"      4.12 如果您未满18周岁的，为保障您的合法权益，三秋科技有权依据国家有关法律法规及政策规定、本协议其他条款规定、三秋科技运营"},{text:"策略或根据您法定监护人的合理要求采取以下一种或多种措施：\n"},{text:"         （1）将与您游戏相关的信息（包括但不限于您游戏帐号的登录信息、充值流水信息等）提供给您的法定监护人，"},{text:"使得您法定监护人可及时或同步了解您游戏情况；\n"},{text:"         （2）限制您游戏账号的消费额度；\n"},{text:"         （3）采取技术措施屏蔽某些游戏或游戏的某些功能，或限定您游戏时间或游戏时长；\n"},{text:"         （4）注销或删除您游戏账号及游戏数据等相关信息；\n"},{text:"         （5）您法定监护人要求采取的，或三秋科技认为可采取的其他合理措施，以限制或禁止您使用三秋科技。\n"},{text:"      4.13 三秋科技向用户提供游戏服务本身属于商业行为，用户有权自主决定是否根据三秋科技自行确定的收费项目（包括但不限于购买"},{text:"游戏内的虚拟道具的使用权以及接受其他增值服务等各类收费项目）及收费标准支付相应的费用，以获得相应的游戏服务。如您不按相应标准"},{text:"支付相应费用的，您将无法获得相应的游戏服务。您知悉并同意：收费项目或收费标准的改变、调整是一种正常的商业行为，您不得因为收费项目"},{text:"或收费标准的改变、调整而要求三秋科技进行赔偿或补偿。\n"},{text:"      4.14 在任何情况下，三秋科技不对因不可抗力导致的您在使用三秋科技游戏服务过程中遭受的损失承担责任。该等不可抗力事件包括但不限于"},{text:"国家法律、法规、政策及国家机关的命令及其他政府行为或者其它的诸如地震、水灾、雪灾、火灾、海啸、台风、罢工、战争等不可预测、不可避免且不可克服的事件。\n"},{text:"      4.15 三秋科技可能因游戏软件BUG、版本更新缺陷、第三方病毒攻击或其他任何因素导致您的游戏角色、游戏道具、游戏装备及游戏币等账号数据发生异常。"},{text:"在数据异常的原因未得到查明前，三秋科技有权暂时冻结该游戏账号；若查明数据异常为非正常游戏行为所致，三秋科技有权恢复游戏账号数据至异常发生前的原始状态"},{text:"（包括向第三方追回被转移数据），且三秋科技无须向您承担任何责任。\n"},{text:"      4.16 三秋科技未授权您从任何第三方通过购买、接受赠与或者其他的方式获得游戏账号、游戏道具、游戏装备、游戏币等，三秋科技不对第三方交易"},{text:"的行为负责，并且不受理因任何第三方交易发生纠纷而带来的申诉。\n"},{text:"      4.17 您充分理解到：不同操作系统之间存在不互通的客观情况，该客观情况并非三秋科技造成，由此可能导致您在某一操作系统中的充值和游戏数据不能"},{text:"顺利转移到另一操作系统中。由于您在不同系统进行切换造成的充值损失和游戏数据丢失风险应由您自行承担，三秋科技对此不承担任何责任。\n"},{text:"      4.18 您充分理解到：三秋科技中可能会设置强制对战区域或玩法，如果您不同意强制对战，请您不要进入该游戏或"},{text:"游戏区域；您的进入，将被视为同意该玩法并接受相应后果。\n"},{text:"      4.19 三秋科技自行决定终止运营三秋科技时或三秋科技因其他任何原因终止运营时，三秋科技会按照文化部有关网络游戏终止"},{text:"运营的相关规定处理游戏终止运营相关事宜，以保障用户合法权益。\n"},{text:"五、【软件许可】\n",style:{bold:!0}},{text:"      5.1 使用三秋科技游戏服务可能需要下载并安装相关软件，您可以直接从三秋科技的相关网站上获取该软件，也可以从得到三秋科技授权的"},{text:"第三方获取。如果您从未经三秋科技授权的第三方获取三秋科技或与三秋科技名称相同的游戏，将视为您未获得三秋科技授权，三秋科技无法保证该"},{text:"游戏能够正常使用，并对因此给您造成的损失不予负责。\n"},{text:"      5.2 三秋科技可能为不同的终端设备或操作系统开发了不同的软件版本，包括但不限于windows、ios、android、windows phone、"},{text:"symbian、blackberry等多个应用版本，您应当根据实际情况选择下载合适的版本进行安装，下载安装程序后，您需要按照该程序提示的步骤正确安装。\n"},{text:"      5.3 若三秋科技以软件形式提供，三秋科技给予您一项个人的、不可转让及非排他性的许可。您仅可为非商业目的在单一台终端设备"},{text:"上下载、安装、登录、使用该三秋科技。\n"},{text:"      5.4 为提供更加优质、安全的服务，在软件安装时三秋科技可能推荐您安装其他软件，您可以选择安装或不安装。\n"},{text:"      5.5 如果您不再需要使用该软件或者需要安装新版，可以自行卸载。如果您愿意帮助三秋科技改进产品服务，请告知卸载的原因。\n"},{text:"      5.6 为了保证三秋科技游戏服务的安全性和功能的一致性，三秋科技有权对软件进行更新，或者对软件的部分功能效果进行改变或限制。\n"},{text:"      5.7 软件新版本发布后，旧版本的软件可能无法使用。三秋科技不保证旧版本软件继续可用及相应的客户服务，请您随时核对并下载最新版本。\n"},{text:"六、【用户行为规范】\n",style:{bold:!0}},{text:"      6.1 您充分了解并同意，您必须为自己游戏账号下的一切行为负责，包括您所发表的任何内容以及由此产生的任何后果。\n"},{text:"      6.2 您除了可以按照本协议的约定使用三秋科技游戏服务之外，不得进行任何侵犯三秋科技的知识产权的行为，或者进行其他的有损于三秋科技"},{text:"或其他第三方合法权益的行为。\n"},{text:"      6.3 您在使用三秋科技或三秋科技游戏服务时须遵守法律法规，不得利用三秋科技或三秋科技游戏服务从事违法违规行为，包括但不限于以下行为：\n"},{text:"         （一）违反宪法确定的基本原则的；\n"},{text:"         （二）危害国家统一、主权和领土完整的；\n"},{text:"         （三）泄露国家秘密、危害国家安全或者损害国家荣誉和利益的；\n"},{text:"         （四）煽动民族仇恨、民族歧视，破坏民族团结，或者侵害民族风俗、习惯的；\n"},{text:"         （五）宣扬邪教、迷信的；\n"},{text:"         （六）散布谣言，扰乱社会秩序，破坏社会稳定的；\n"},{text:"         （七）宣扬淫秽、色情、赌博、暴力，或者教唆犯罪的；\n"},{text:"         （八）侮辱、诽谤他人，侵害他人合法权益的；\n"},{text:"         （九）违背社会公德的；\n"},{text:"         （十）有法律、行政法规和国家规定禁止的其他内容的。\n"},{text:"      6.4 除非法律允许或三秋科技书面许可，您不得从事下列行为：\n"},{text:"         （1）删除游戏软件及其副本上关于著作权的信息；\n"},{text:"         （2）对游戏软件进行反向工程、反向汇编、反向编译或者以其他方式尝试发现软件的源代码；\n"},{text:"         （3）对游戏软件进行扫描、探查、测试，以检测、发现、查找其中可能存在的BUG或弱点；\n"},{text:"         （4）对游戏软件或者软件运行过程中释放到任何终端内存中的数据、软件运行过程中客户端与服务器端的交互数据，以及软件运行所必需的系统数据，"},{text:"进行复制、修改、增加、删除、挂接运行或创作任何衍生作品，形式包括但不限于使用插件、外挂或非经合法授权的第三方工具/服务接入软件和相关系统；\n"},{text:"         （5）修改或伪造软件运行中的指令、数据，增加、删减、变动软件的功能或运行效果，或者将用于上述用途的软件、方法进行运营或向公众传播，"},{text:"无论上述行为是否为商业目的；\n"},{text:"         （6）通过非三秋科技开发、授权的第三方软件、插件、外挂、系统，使用三秋科技及三秋科技游戏服务，或制作、发布、传播非三秋科技开发、"},{text:"授权的第三方软件、插件、外挂、系统；\n"},{text:"         （7）对游戏中三秋科技拥有知识产权的内容进行使用、出租、出借、复制、修改、链接、转载、汇编、发表、出版、建立镜像站点等；\n"},{text:"         （8）建立有关三秋科技的镜像站点，或者进行网页（络）快照，或者利用架设服务器等方式，为他人提供与三秋科技游戏服务完全相同或者类似的服务；\n"},{text:"         （9）将三秋科技的任意部分分离出来单独使用，或者进行其他的不符合本协议的使用；\n"},{text:"         （10）使用、修改或遮盖三秋科技的名称、商标或其它知识产权；\n"},{text:"         （11）其他未经三秋科技明示授权的行为。\n"},{text:"     6.5 您在使用三秋科技游戏服务过程中有如下任何行为的，三秋科技有权视情节严重程度，依据本协议及相关游戏规则的规定，对您做出暂时"},{text:"或永久性地禁止登录（即封号）、删除游戏账号及游戏数据、删除相关信息等处理措施，情节严重的将移交有关行政管理机关给予行政处罚，或者追究您的刑事责任：\n"},{text:"         （1）以某种方式暗示或伪称三秋科技内部员工或某种特殊身份，企图得到不正当利益或影响其他用户权益的行为；\n"},{text:"         （2）在三秋科技中使用非法或不当词语、字符等，包括用于角色命名；\n"},{text:"         （3）以任何方式破坏三秋科技或影响三秋科技游戏服务的正常进行；\n"},{text:"         （4）各种非法外挂行为；\n"},{text:"         （5）传播非法言论或不当信息；\n"},{text:"         （6）盗取他人游戏账号、游戏物品；\n"},{text:"         （7）私自进行游戏账号交易；\n"},{text:"         （8）私自进行游戏虚拟货币、游戏装备、游戏币及其他游戏道具等交易；\n"},{text:"         （9）违反本协议任何约定的；\n"},{text:"         （10）其他在行业内被广泛认可的不当行为，无论是否已经被本协议或游戏规则明确列明。\n"},{text:"         您知悉并同意，由于外挂具有隐蔽性或用完后即消失等特点，三秋科技有权根据您的游戏数据和表现异常判断您有无使用非法外挂等行为。\n"},{text:"     6.6 您知悉并同意，如三秋科技依据本协议对您的游戏账号采取封号处理措施的，具体封号期间由三秋科技根据您违规行为情节而定。您知悉并同意：\n"},{text:"         （1）在封号期间，您游戏账号中的游戏虚拟货币、游戏装备、游戏币及其他游戏道具可能都将无法使用；\n"},{text:"         （2）如前述游戏虚拟货币、游戏装备、游戏币及其他游戏道具存在一定有效期，该有效期可能会在封号期间过期，您游戏账号解封后，"},{text:"您将无法使用该等已过期的游戏虚拟货币、游戏装备、游戏币及其他游戏道具。\n"},{text:"         据此，您也同意不会因发生前述第（1）和（或）第（2）点规定的情形而追究三秋科技任何法律责任。\n"},{text:"七、【知识产权】\n",style:{bold:!0}},{text:"     7.1 三秋科技是三秋科技的知识产权权利人。三秋科技（包括三秋科技整体及三秋科技涉及的所有内容、组成部分或构成要素 ）的一切著作权、"},{text:"商标权、专利权、商业秘密等知识产权及其他合法权益，以及与三秋科技相关的所有信息内容（包括文字、图片、音频、视频、图表、界面设计、版面框架、"},{text:"有关数据或电子文档等）均受中华人民共和国法律法规和相应的国际条约保护，三秋科技享有上述知识产权和合法权益，但相关权利人依照法律规定应享有的权利"},{text:"除外。未经三秋科技事先书面同意，您不得以任何方式将三秋科技（包括三秋科技整体及三秋科技涉及的所有内容、组成部分或构成要素 ）进行商业性使用。\n"},{text:"     7.2 尽管本协议有其他规定，您在使用三秋科技游戏服务中产生的游戏数据的所有权和知识产权归三秋科技所有，三秋科技有权保存、处置该游戏数据。"},{text:"其中，三秋科技对用户购买游戏虚拟货币的购买记录的保存期限将遵守文化部《网络游戏管理暂行办法》有关规定。对其他游戏数据的保存期限由三秋科技自行"},{text:"决定，但国家法律法规另有规定的从其规定。\n"},{text:"     7.3 三秋科技可能涉及第三方知识产权，而该等第三方对您基于本协议在三秋科技中使用该等知识产权有要求的，三秋科技将以适当方式向您告知该要求，"},{text:"您应当一并遵守。\n"},{text:"八、【遵守当地法律监管】\n",style:{bold:!0}},{text:"     8.1 您在使用三秋科技游戏服务过程中应当遵守当地相关的法律法规，并尊重当地的道德和风俗习惯。如果您的行为违反了当地法律法规或道德风俗，"},{text:"您应当为此独立承担责任。\n"},{text:"     8.2 您应避免因使用三秋科技游戏服务而使三秋科技卷入政治和公共事件，否则三秋科技有权暂停或终止对您的服务。\n"},{text:"九、【管辖与法律适用】\n",style:{bold:!0}},{text:"     9.1 本协议签订地为中华人民共和国四川省成都市高新区。\n"},{text:"     9.2 本协议的成立、生效、履行、解释及纠纷解决，适用中华人民共和国大陆地区法律（不包括冲突法）。\n"},{text:"     9.3 若您和三秋科技之间因本协议发生任何纠纷或争议，首先应友好协商解决；协商不成的，您同意将纠纷或争议提交至本协议签订地有管辖权的人民法院管辖。\n"},{text:"     9.4 本协议所有条款的标题仅为阅读方便，本身并无实际涵义，不能作为本协议涵义解释的依据。\n"},{text:"     9.5 本协议条款无论因何种原因部分无效，其余条款仍有效，对各方具有约束力。\n"},{text:"十、【其他】\n",style:{bold:!0}},{text:"     10.1 三秋科技有权在必要时变更本协议条款，您可以在三秋科技的相关页面查阅最新版本的协议条款。本协议条款变更后，如果您继续使用"},{text:"三秋科技游戏服务，即视为您已接受变更后的协议。\n"},{text:"     10.2 根据国家新闻出版总署关于健康游戏的忠告，三秋科技提醒您：抵制不良游戏，拒绝盗版游戏；注意自我保护，"},{text:"谨防受骗上当；适度游戏益脑，沉迷游戏伤身。\n"}]
},t.prototype.onPressRefuseButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressRefuseButtonHandler&&this.pressRefuseButtonHandler()},t.prototype.onPressAcceptButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressAcceptButtonHandler&&this.pressAcceptButtonHandler()},t.prototype.onPressOkButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressOkButtonHandler&&this.pressOkButtonHandler()},t}(QPPopupLayer);__reflect(DDZUserAgreementPopup.prototype,"DDZUserAgreementPopup");var DDZUserInfoScene=function(e){function t(t,n){var a=e.call(this)||this;return a.skinName="DDZUserInfoSceneUI",a.userAttribute=n,a.backgroundImage.source=t,a.popup.pressCloseButtonHandler=a.goBack.bind(a),a.popup.pressSwitchAccountButtonHandler=a.switchAccount.bind(a),a.popup.pressSignOutButtonHandler=a.signOut.bind(a),a.popup.pressBindPhoneButtonHandler=a.bindPhone.bind(a),a}return __extends(t,e),t.prototype.adjustAsPlayGameMode=function(){this.popup.adjustAsPlayGameMode()},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.popup.setUserInfo(this.userAttribute)},t.prototype.goBack=function(){qp.SceneManager.sharedInstance().popScene()},t.prototype.switchAccount=function(){},t.prototype.signOut=function(){UserModel.sharedInstance().signOut({},function(e){qp.SceneManager.sharedInstance().popScene(),qp.SceneManager.sharedInstance().replaceScene(new DDZUserAgreementScene)})},t.prototype.bindPhone=function(){qp.SceneManager.sharedInstance().pushScene(new DDZBindAccountScene)},t}(QPScene);__reflect(DDZUserInfoScene.prototype,"DDZUserInfoScene");var DDZBindAccountScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZBindAccountSceneUI",t.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressBackButton,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.bindPhonePopup.pressBindHandler=this.bindAccount.bind(this),this.bindPhonePopup.pressGetVerificationCodeButtonHandler=this.getVerificationCode.bind(this)},t.prototype.getVerificationCode=function(e){var t=this;UserModel.sharedInstance().inputtedAttributeModel.setPhoneNumber(e);var n=UserModel.sharedInstance().actionDataFactory.makeSendVerificationCodeData();n.isLegal&&this.bindPhonePopup.disableSendVerificationCodeButton(),UserModel.sharedInstance().actionModel.sendVerificationCode(n,function(e){UserModel.sharedInstance().inputtedAttributeModel.setCountryCode("86"),UserModel.sharedInstance().attributeModel.setHashDigest(e.hash_digest),UserModel.sharedInstance().attributeModel.setExpireISOTime(e.expire_iso_time)},function(e){QPAlert.sharedInstance().showOKButtonAt(t,e.message)})},t.prototype.bindAccount=function(e,t,n){var a=this;UserModel.sharedInstance().inputtedAttributeModel.setPhoneNumber(e),UserModel.sharedInstance().inputtedAttributeModel.setPassword(t),UserModel.sharedInstance().inputtedAttributeModel.setVerificationCode(n);var r=new QPLoadingScene;r.show("正在发送请求");var o=UserModel.sharedInstance().actionDataFactory.makeBindPhoneData();UserModel.sharedInstance().actionModel.bindPhone(o,function(e){r.hide(),UserModel.sharedInstance().attributeModel.setIsAnonymous(!1),UserModel.sharedInstance().attributeModel.setHasBindPhoneNumber(!0),QPAlert.sharedInstance().showOKButtonAt(a,"手机号绑定成功"),QPAlert.sharedInstance().pressedOKHandler=function(){a.onPressBackButton()};var t=new DDZDataEvent(DDZDataEvent.UPDATE);DDZEventCenter.sharedInstance().dispatchEvent(t)},function(e){r.hide(),QPAlert.sharedInstance().showOKButtonAt(a,e.message)})},t.prototype.onPressBackButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),qp.SceneManager.sharedInstance().popScene()},t}(QPScene);__reflect(DDZBindAccountScene.prototype,"DDZBindAccountScene");var DDZBindAccountTextInput=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(eui.TextInput);__reflect(DDZBindAccountTextInput.prototype,"DDZBindAccountTextInput");var DDZBindPhonePopup=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZBindPhonePopupUI",t.getVerificationCodeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressGetVerificationCodeButton,t),t.bindButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressBindButton,t),t}return __extends(t,e),t.prototype.onExit=function(){e.prototype.onExit.call(this),this.getVerificationCodeButton.stopCountDown()},t.prototype.disableSendVerificationCodeButton=function(){this.getVerificationCodeButton.disable()},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.phoneInput.prompt="请输入电话号码",this.passwordInput.prompt="请输入长度为6-50位的密码",this.passwordInput.displayAsPassword=!0,this.verificationCodeInput.prompt="请输入验证码",this.descriptionLabel.text="为账号"+UserModel.sharedInstance().attributeModel.name+"绑定手机号"},t.prototype.onPressGetVerificationCodeButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressGetVerificationCodeButtonHandler(this.phoneInput.text)},t.prototype.onPressBindButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressBindHandler(this.phoneInput.text,this.passwordInput.text,this.verificationCodeInput.text)},t}(QPPopupLayer);__reflect(DDZBindPhonePopup.prototype,"DDZBindPhonePopup");var DDZGetVerificationCodeButton=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.disable=function(){this.enabled=!1,this.labelDisplay.text="60s 重新获取",this.startCountDown()},t.prototype.stopCountDown=function(){this.stopwatch&&(this.labelDisplay.text="",this.stopwatch.stop(),this.stopwatch=void 0,this.enabled=!0)},t.prototype.startCountDown=function(){this.stopwatch||(this.stopwatch=new egret.Timer(1e3,0),this.stopwatch.addEventListener(egret.TimerEvent.TIMER,this.stopwatchFunction,this),this.remainStopwatchValue=t.STOP_WATCH_VALUE,this.stopwatch.start())},t.prototype.stopwatchFunction=function(){return this.remainStopwatchValue-=1,this.remainStopwatchValue<1?void this.stopCountDown():void(this.labelDisplay.text=this.remainStopwatchValue+"s 重新获取")},t.STOP_WATCH_VALUE=60,t}(eui.Button);__reflect(DDZGetVerificationCodeButton.prototype,"DDZGetVerificationCodeButton");var DDZUserInfoAvatar=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZUserInfoAvatarUI",t}return __extends(t,e),t.prototype.setAvatar=function(e){this.avatarImage.source=e},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.avatarButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressedAvatarButton,this)},t.prototype.onPressedAvatarButton=function(){this.onPressedHandler&&this.onPressedHandler()},t}(QPLayer);__reflect(DDZUserInfoAvatar.prototype,"DDZUserInfoAvatar");var DDZUserInfoEditPopup=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZUserInfoEditPopupUI",t}return __extends(t,e),t.prototype.setCurrentUserInfo=function(e){this.nameInput.text=e.name,this.maleRadioButton.selected=e.gender.isMale(),this.femaleRadioButton.selected=!e.gender.isMale()},t.prototype.getNameValue=function(){return this.nameInput.text},t.prototype.getGenderValue=function(){return this.maleRadioButton.selected?new GenderMale:this.femaleRadioButton.selected?new GenderFeMale:void 0},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.cancelButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressCancelButton,this),this.saveButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressSaveButton,this);var t=new eui.RadioButtonGroup;t.addEventListener(eui.UIEvent.CHANGE,this.radioChangedHandler,this),this.maleRadioButton.group=t,this.femaleRadioButton.group=t},t.prototype.radioChangedHandler=function(e){var t=e.target;egret.log(t.selectedValue)},t.prototype.onPressCancelButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressedCancelHandler()},t.prototype.onPressSaveButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressedSaveHandler()},t}(QPPopupLayer);__reflect(DDZUserInfoEditPopup.prototype,"DDZUserInfoEditPopup");var DDZUserInfoEditScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZUserInfoEditSceneUI",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.popup.pressedCancelHandler=this.cancelEditUserInfo.bind(this),this.popup.pressedSaveHandler=this.saveEditUserInfo.bind(this),this.popup.setCurrentUserInfo(UserModel.sharedInstance().attributeModel)},t.prototype.cancelEditUserInfo=function(){qp.SceneManager.sharedInstance().removeChildLayer(this)},t.prototype.saveEditUserInfo=function(){var e=this,t={nickname:this.popup.getNameValue(),gender:this.popup.getGenderValue().name},n=new QPLoadingScene;n.show("正在修改信息"),UserModel.sharedInstance().modifyUserInformation(t,function(t){if(n.hide(),t)return void QPAlert.sharedInstance().showOKButtonAt(e,t.message);var a=new DDZDataEvent(DDZDataEvent.UPDATE);a.userAttribute=UserModel.sharedInstance().attributeModel,DDZEventCenter.sharedInstance().dispatchEvent(a),QPAlert.sharedInstance().showOKButtonAt(e,"您的信息已经成功更新。"),QPAlert.sharedInstance().pressedOKHandler=function(){qp.SceneManager.sharedInstance().removeChildLayer(e)}})},t}(QPLayer);__reflect(DDZUserInfoEditScene.prototype,"DDZUserInfoEditScene");var DDZUserInfoGameDataView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZUserInfoGameDataViewUI",t}return __extends(t,e),t.prototype.setTitleText=function(e){this.titleLabel.text=e+"："},t.prototype.setValueText=function(e){this.valueLabel.text=e},t}(QPLayer);__reflect(DDZUserInfoGameDataView.prototype,"DDZUserInfoGameDataView");var DDZUserInfoGenderView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZUserInfoGenderUI",t}return __extends(t,e),t.prototype.setGenderIcon=function(e){this.genderImage.source=e},t}(QPLayer);__reflect(DDZUserInfoGenderView.prototype,"DDZUserInfoGenderView");var DDZUserInfoNameInput=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZUserInfoNameInputUI",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.addEventListener(egret.Event.CHANGE,this.onValueChanged,this),this.cleanButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressCleanButton,this),this.cleanButton.visible=this.text&&""!==this.text},t.prototype.onValueChanged=function(e){this.cleanButton.visible=e.target.text&&""!==e.target.text},t.prototype.onPressCleanButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.text=""},t}(eui.TextInput);__reflect(DDZUserInfoNameInput.prototype,"DDZUserInfoNameInput");var DDZUserInfoPopup=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZUserInfoPopupUI",t.editUsernameButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressEditUsernameButton,t),t.switchAccountButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressSwitchAccountButton,t),t.signOutButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressSignOutButton,t),t.bindPhoneButton.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onPressBindPhoneButton,t),t}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this),DDZEventCenter.sharedInstance().addEventListener(DDZDataEvent.UPDATE,this.receiveUserDataChangedEvent,this),this.bindPhoneButton.visible=UserModel.sharedInstance().attributeModel.getIsAnonymous()},t.prototype.onExit=function(){e.prototype.onExit.call(this),DDZEventCenter.sharedInstance().removeEventListener(DDZDataEvent.UPDATE,this.receiveUserDataChangedEvent,this)},t.prototype.setUserInfo=function(e){this.nameLabel.text=e.name,this.genderView.setGenderIcon(e.gender.iconSource),this.idLabel.text="ID: "+e.getDisplayId(),this.coinInfoView.setCoin(e.getBalanceAmount()),this.totalGame.setValueText(String(e.totalGameAmount)),this.winningRate.setValueText(String(e.winningRate)),this.escapeRate.setValueText(String(e.escapeRate)),this.winningAmount.setValueText(String(e.winningGameAmount)),this.continueWinningAmount.setValueText(String(e.continuousWinningAmount))},t.prototype.adjustAsPlayGameMode=function(){this.signOutButton.visible=!1,this.editUsernameButton.visible=!1,this.bindPhoneButton.visible=!1},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.closeButton.pressHandler=this.onPressCloseButton.bind(this),this.totalGame.setTitleText("总局数"),this.winningRate.setTitleText("胜率"),this.escapeRate.setTitleText("逃跑率"),this.winningAmount.setTitleText("胜利场"),this.continueWinningAmount.setTitleText("连胜")},t.prototype.receiveUserDataChangedEvent=function(e){e.userAttribute&&this.setUserInfo(e.userAttribute),this.bindPhoneButton.visible=UserModel.sharedInstance().attributeModel.getIsAnonymous()},t.prototype.onPressCloseButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressCloseButtonHandler&&this.pressCloseButtonHandler()},t.prototype.onPressEditUsernameButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1);var e=new DDZUserInfoEditScene;qp.SceneManager.sharedInstance().addChildLayer(e)},t.prototype.onPressSwitchAccountButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressSwitchAccountButtonHandler&&this.pressSwitchAccountButtonHandler()},t.prototype.onPressBindPhoneButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressBindPhoneButtonHandler&&this.pressBindPhoneButtonHandler()},t.prototype.onPressSignOutButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressSignOutButtonHandler&&this.pressSignOutButtonHandler()},t}(QPPopupLayer);__reflect(DDZUserInfoPopup.prototype,"DDZUserInfoPopup");var ApplicationUtil=function(){function e(){}return e.switchToOtherApp=function(e,t,n){egret.ExternalInterface.call("switchToOtherApp",e),egret.ExternalInterface.addCallback("switchSuccess",function(){t()}),egret.ExternalInterface.addCallback("switchError",function(e){n(new Error(e))})},e}();__reflect(ApplicationUtil.prototype,"ApplicationUtil");var Color=function(){function e(){}return e.TextGray=9868950,e.Red=15018281,e.Black=1513239,e}();__reflect(Color.prototype,"Color");var DDZPopupCloseButton=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressCloseButton,this)},t.prototype.onPressCloseButton=function(){QPAudioManager.sharedInstance().playEffectSound(QPAudioSouce.CLICK_BUTTON,1),this.pressHandler&&this.pressHandler()},t}(eui.Component);__reflect(DDZPopupCloseButton.prototype,"DDZPopupCloseButton");var DEVICE_ID_KEY="user.device.id.local.save.key",DEVICE_IF_RUN_APP_KEY="user.device.if.run.app.save.key",Device=function(){function e(){var e=DDZCacheModel.sharedInstance().stringForKey(DEVICE_ID_KEY);e?this.id=e:(this.id=UUID.generate(),DDZCacheModel.sharedInstance().setString(DEVICE_ID_KEY,this.id));var t=DDZCacheModel.sharedInstance().booleanForKey(DEVICE_IF_RUN_APP_KEY);this.isLaunchedApp=t,t||DDZCacheModel.sharedInstance().setBoolean(DEVICE_IF_RUN_APP_KEY,!0)}return e.sharedInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getWidth=function(){return this.width},e.prototype.setWidth=function(e){this.width=e},e.prototype.getHeight=function(){return this.height},e.prototype.setHeight=function(e){this.height=e},e.prototype.screenShoot=function(t){var n=new egret.RenderTexture,a=new egret.Rectangle(0,0,e.sharedInstance().width,e.sharedInstance().height);return egret.log("Device.width = "+e.sharedInstance().width+", Device.height = "+e.sharedInstance().height),n.drawToTexture(t,a),n},e.prototype.isNative=function(){return egret.Capabilities.runtimeType===egret.RuntimeType.NATIVE},e.prototype.isiOS=function(){return"iOS"===egret.Capabilities.os},e.prototype.isWeb=function(){return egret.Capabilities.runtimeType===egret.RuntimeType.WEB},e.instance=void 0,e}();__reflect(Device.prototype,"Device");var PasteBoard=function(){function e(){}return e.write=function(e){egret.ExternalInterface.call("saveToPasteBoard",e)},e.getContent=function(e){egret.ExternalInterface.call("getPasteBoardContent",""),egret.ExternalInterface.addCallback("getPasteBoardContent",function(t){e(t)})},e}();__reflect(PasteBoard.prototype,"PasteBoard");var QPAlert=function(e){function t(){var t=e.call(this)||this;return t.skinName="QPAlertUI",t}return __extends(t,e),t.sharedInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.showAt=function(e,t){this.showOKButtonAt(e,t)},t.prototype.showOKButtonAt=function(e,t){this.okGroup.visible=!0,this.messageLabel.text=t,qp.SceneManager.sharedInstance().addChildLayer(this)},t.prototype.showCancelAndOkButtonAt=function(e,t){this.cancelAndOkGroup.visible=!0,this.messageLabel.text=t,qp.SceneManager.sharedInstance().addChildLayer(this)},t.prototype.showCancelAndQuitButtonAt=function(e,t){this.cancelAndQuitGroup.visible=!0,this.messageLabel.text=t,qp.SceneManager.sharedInstance().addChildLayer(this)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addListeners()},t.prototype.addListeners=function(){this.cancelButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressCancelButton,this),this.quitButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressQuitButton,this),this.okButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressOkButton,this),this.cancelAndOkGroupCancelButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressCancelButton,this),this.cancelAndOkGroupOkButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPressOkButton,this)},t.prototype.onPressCancelButton=function(){this.hide()},t.prototype.onPressQuitButton=function(){this.pressedQuitHandler&&this.pressedQuitHandler(),this.hide()},t.prototype.onPressOkButton=function(){this.pressedOKHandler&&this.pressedOKHandler(),this.hide()},t.prototype.hide=function(){this.hideAllButtonGroups(),this.pressedQuitHandler=void 0,this.pressedOKHandler=void 0,qp.SceneManager.sharedInstance().removeChildLayer(this)},t.prototype.hideAllButtonGroups=function(){this.okGroup.visible=!1,this.cancelAndQuitGroup.visible=!1,this.cancelAndOkGroup.visible=!1},t.instance=void 0,t}(QPLayer);__reflect(QPAlert.prototype,"QPAlert");var DEFAULT_VOLUME="0.5",QPAudioManager=function(){function e(){this.MUSIC_START_TIME=0,this.backgroundMusics={},this.isBackgroundMusicPlaying=!1,this.backgroundSoundChannels={},this.soundEffects={},this.soundEffectChannels={},this.backgroundMusicVolume=-1,this.soundEffectVolume=-1}return e.sharedInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setBackgroundMusicVolume=function(e){this.backgroundMusicVolume=e/100;for(var t in this.backgroundSoundChannels)t&&(this.backgroundSoundChannels[t].volume=this.backgroundMusicVolume)},e.prototype.setSoundEffectVolume=function(e){this.soundEffectVolume=e/100;for(var t in this.soundEffectChannels)t&&(this.soundEffectChannels[t].volume=this.soundEffectVolume)},e.prototype.playBackgroundMusic=function(e,t){if(void 0===t&&(t=0),DDZSettingsModel.sharedInstance().isMusicOn&&e!==this.currentSoundFileSource){this.isBackgroundMusicPlaying&&this.stopPlayBackgroundMusic(),this.currentSoundFileSource=e;var n=RES.getRes(e);if(!n)return void egret.log("糟糕！！！！！ 资源文件"+e+"，读取失败，音乐不能播放");this.backgroundMusics[e]=n;var a=n.play(this.MUSIC_START_TIME,t);a.volume=this.backgroundMusicVolume<0?DEFAULT_VOLUME:this.backgroundMusicVolume,this.backgroundSoundChannels[n.hashCode.toString()]=a,this.isBackgroundMusicPlaying=!0}},e.prototype.getPlayingSoundFileSource=function(){return this.currentSoundFileSource},e.prototype.stopPlayBackgroundMusic=function(){for(var e in this.backgroundSoundChannels)e&&(this.backgroundSoundChannels[e].stop(),delete this.backgroundSoundChannels[e]);for(var t in this.backgroundMusics)t&&delete this.backgroundMusics[t];this.currentSoundFileSource=void 0,this.isBackgroundMusicPlaying=!1},e.prototype.playEffectSound=function(e,t){if(void 0===t&&(t=1),DDZSettingsModel.sharedInstance().isSoundOn){var n=RES.getRes(e);if(!n)return void egret.log("糟糕，音效文件"+e+"，读取失败，未能播放");this.soundEffects[e]=n;var a=n.play(this.MUSIC_START_TIME,t);a.volume=this.soundEffectVolume<0?DEFAULT_VOLUME:this.soundEffectVolume,this.soundEffectChannels[n.hashCode.toString()]=a}},e.prototype.stopPlayEffectSound=function(e){var t=this.soundEffects[e];if(t){var n=this.soundEffectChannels[t.hashCode.toString()];n.stop(),delete this.soundEffects[e],delete this.soundEffectChannels[t.hashCode.toString()]}},e}();__reflect(QPAudioManager.prototype,"QPAudioManager");var QPAudioSouce=function(){function e(){}return e.getRandomBuYao=function(){return Math.random()>.5?"voice_bu_yao_mp3":"voice_guo_mp3"},e.CLICK_BUTTON="btn_click_mp3",e.BU_JIAO="grab_bu_jiao_mp3",e.JIAO_DI_ZHU="grab_jiao_di_zhu_mp3",e.SEND_CARD="ddz_send_card_mp3",e.CHOOSE_CARD="ddz_choose_card_mp3",e}();__reflect(QPAudioSouce.prototype,"QPAudioSouce");var QPLoadingScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="QPLoadingUI",t}return __extends(t,e),t.prototype.show=function(e){this.messageLabel.text=e?e+"...":"努力加载中...",this.parent||(qp.SceneManager.sharedInstance().addChildLayer(this),this.startAnimation())},t.prototype.hide=function(){this.parent&&(this.loadingAnimationGroup.stop(),qp.SceneManager.sharedInstance().removeChildLayer(this))},t.prototype.createChildren=function(){e.prototype.createChildren.call(this);for(var t in this.loadingAnimationGroup.items)if(t){var n=this.loadingAnimationGroup.items[t];n&&(n.props={loop:!0})}},t.prototype.startAnimation=function(){this.parent&&this.loadingAnimationGroup.play()},t}(QPLayer);__reflect(QPLoadingScene.prototype,"QPLoadingScene");var DDZDiamondWareHouse=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(DDZBaseWarehouse);__reflect(DDZDiamondWareHouse.prototype,"DDZDiamondWareHouse");var QPToast=function(e){function t(){var t=e.call(this)||this;return t.skinName="QPToastUI",t}return __extends(t,e),t.sharedInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.showAt=function(e,t){this.messageLabel.text=t,this.messageBackground.width=this.messageLabel.width+60,this.messageBackground.height=this.messageLabel.height+50,this.parent||e.addChild(this)},t.prototype.hide=function(){this.parent&&this.parent.removeChild(this)},t.instance=void 0,t}(eui.Component);__reflect(QPToast.prototype,"QPToast");var UnderLineTextInput=function(e){function t(){var t=e.call(this)||this;return t.skinName="UnderLineTextInputUI",t}return __extends(t,e),t}(eui.TextInput);__reflect(UnderLineTextInput.prototype,"UnderLineTextInput");var DDZEmptyContentView=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZEmptyContentViewUI",t}return __extends(t,e),t}(QPLayer);__reflect(DDZEmptyContentView.prototype,"DDZEmptyContentView");var DDZTabbar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setItems=function(e){this.tabbar.dataProvider=new eui.ArrayCollection(e)},t.prototype.setSelectedIndex=function(e){this.tabbar.selectedIndex=e},t}(QPLayer);__reflect(DDZTabbar.prototype,"DDZTabbar");var DDZTabbarItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZTabbarItemUI",t}return __extends(t,e),t.prototype.dataChanged=function(){this.normalTitleLabel.text=this.data.title,this.selectedTitleLabel.text=this.data.title},t}(eui.ItemRenderer);__reflect(DDZTabbarItem.prototype,"DDZTabbarItem");var DDZTransparentCover=function(e){function t(){var t=e.call(this)||this;return t.skinName="DDZTransparentCoverUI",t}return __extends(t,e),t}(QPLayer);__reflect(DDZTransparentCover.prototype,"DDZTransparentCover");var qp;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.sceneStack=new eui.ViewStack,t.scenes=[],t}return __extends(t,e),t.sharedInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.addRootStage=function(e){this.rootStage=e,this.rootStage.addChild(this.sceneStack)},t.prototype.addChildLayer=function(e){if(!e)throw new Error("无法添加不存在的layer");this.rootStage.addChild(e),e.onEnter()},t.prototype.removeChildLayer=function(e){if(!e)throw new Error("无法移出不存在的scene");e.parent&&(e.onExit(),this.rootStage.removeChild(e),e=void 0)},t.prototype.pushScene=function(e){if(!e)throw new Error("你不能push一个不存在的scene");this.sceneStack.addChild(e),e.onEnter(),this.scenes.push(e),this.sceneStack.selectedIndex=this.sceneStack.length-1},t.prototype.popScene=function(){if(1<=this.scenes.length){var e=this.scenes.pop();e.onExit();var t=this.sceneStack.removeChild(e);this.sceneStack.selectedIndex=this.sceneStack.length-1,this.sceneStack.selectedIndex<0&&(this.sceneStack.selectedIndex=0),t=void 0}},t.prototype.replaceScene=function(e){if(!e)throw new Error("你不能replace一个不存在的scene");this.popScene(),this.pushScene(e)},t.instance=void 0,t}(egret.DisplayObjectContainer);e.SceneManager=t,__reflect(t.prototype,"qp.SceneManager")}(qp||(qp={})),String.prototype.countByte=function(){for(var e=0,t=0;t<this.length;t+=1){var n=this.charCodeAt(t);e+=128>n?1:2048>n?2:65536>n?3:1<<21>n?4:1<<26>n?5:1<<31>n?6:Number.NaN}return e},String.prototype.canBeUsername=function(){var e=/^[a-zA-Z0-9]+$/;return e.test(this)?!0:!1},String.prototype.isValidDate=function(){var e=/((^((1[8-9]\d{2})|([2-9]\d{3}))([-])(10|12|0?[13578])([-])(3[01]|[12][0-9]|0?[1-9])$)|(^((1[8-9]\d{2})|([2-9]\d{3}))([-])(11|0?[469])([-])(30|[12][0-9]|0?[1-9])$)|(^((1[8-9]\d{2})|([2-9]\d{3}))([-])(0?2)([-])(2[0-8]|1[0-9]|0?[1-9])$)|(^([2468][048]00)([-])(0?2)([-])(29)$)|(^([3579][26]00)([-])(0?2)([-])(29)$)|(^([1][89][0][48])([-])(0?2)([-])(29)$)|(^([2-9][0-9][0][48])([-])(0?2)([-])(29)$)|(^([1][89][2468][048])([-])(0?2)([-])(29)$)|(^([2-9][0-9][2468][048])([-])(0?2)([-])(29)$)|(^([1][89][13579][26])([-])(0?2)([-])(29)$)|(^([2-9][0-9][13579][26])([-])(0?2)([-])(29)$))/;return e.test(this)},String.prototype.canBePassword=function(){return this.length>=8},String.prototype.isValidPhoneNumber=function(){var e=/^[0-9]+$/;return e.test(this)&&this.length>=8?!0:!1},String.prototype.isValidVerificationCode=function(){var e=/^[0-9]+$/;return e.test(this)&&6===this.length?!0:!1};var QPResource;!function(e){var t=function(){function e(){}return e.LAUNCH_GAME="ddz_launch_game",e.USER_AGREEMENT="ddz_user_agreement_image",e.HOME="ddz_home",e.COMMON_MUSIC="ddz_common_music",e.COMMON_IMAGE="ddz_common_image",e.OTHER_MUSIC="ddz_other_music",e.GAME_OVER="ddz_game_over_image",e.MAIL="ddz_mail_image",e.PACKAGE="ddz_package_image",e.PLAY_GAME="ddz_play_game_image",e.ROOM="ddz_room_image",e.SETTINGS="ddz_settings_image",e.STORE="ddz_store_image",e.ACTIVITY="ddz_activity_image",e.TASK="ddz_task_image",e.USER_INFO="ddz_user_info_image",e}();e.GroupName=t,__reflect(t.prototype,"QPResource.GroupName");var n=function(){function e(){this.isLoaded=!1}return e.prototype.load=function(e){if(!e)throw new Error("不能加载不存在的Group");return this.isLoaded?void this.loadCompleteHandler(new RES.ResourceEvent(RES.ResourceEvent.GROUP_COMPLETE)):(this.addLoadGroupEvent(),void RES.loadGroup(e))},e.prototype.addLoadGroupEvent=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onGroupLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onGroupLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onGroupProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this)},e.prototype.removeLoadGroupEvent=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onGroupLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onGroupLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onGroupProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this)},e.prototype.onGroupLoadComplete=function(e){this.isLoaded=!0,this.removeLoadGroupEvent(),this.loadCompleteHandler&&this.loadCompleteHandler(e)},e.prototype.onGroupLoadError=function(e){this.isLoaded=!1,this.removeLoadGroupEvent(),this.loadCompleteHandler&&this.loadCompleteHandler(e)},e.prototype.onGroupProgress=function(e){this.loadProgressHandler&&this.loadProgressHandler(e)},e.prototype.onItemLoadError=function(e){throw new Error(e.resItem.url+"加载失败")},e}();e.GroupModel=n,__reflect(n.prototype,"QPResource.GroupModel");var a=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.LAUNCH_GAME)},n}(n);e.LaunchGameGroup=a,__reflect(a.prototype,"QPResource.LaunchGameGroup");var r=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.USER_AGREEMENT)},n}(n);e.UserAgreementGroup=r,__reflect(r.prototype,"QPResource.UserAgreementGroup");var o=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.HOME)},n}(n);e.HomeGroup=o,__reflect(o.prototype,"QPResource.HomeGroup");var s=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.COMMON_MUSIC)},n}(n);e.CommonMusicGroup=s,__reflect(s.prototype,"QPResource.CommonMusicGroup");var i=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.OTHER_MUSIC)},n}(n);e.OtherMusicGroup=i,__reflect(i.prototype,"QPResource.OtherMusicGroup");var d=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.COMMON_IMAGE)},n}(n);e.CommonImagesGroup=d,__reflect(d.prototype,"QPResource.CommonImagesGroup");var l=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.GAME_OVER)},n}(n);e.GameOverGroup=l,__reflect(l.prototype,"QPResource.GameOverGroup");var c=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.MAIL)},n}(n);e.MailGroup=c,__reflect(c.prototype,"QPResource.MailGroup");var u=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.PACKAGE)},n}(n);e.PackageGroup=u,__reflect(u.prototype,"QPResource.PackageGroup");var h=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.PLAY_GAME)
},n}(n);e.PlayGameGroup=h,__reflect(h.prototype,"QPResource.PlayGameGroup");var p=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.ROOM)},n}(n);e.RoomGroup=p,__reflect(p.prototype,"QPResource.RoomGroup");var y=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.SETTINGS)},n}(n);e.SettingsGroup=y,__reflect(y.prototype,"QPResource.SettingsGroup");var f=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.STORE)},n}(n);e.StoreGroup=f,__reflect(f.prototype,"QPResource.StoreGroup");var g=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.STORE)},n}(n);e.ActivityGroup=g,__reflect(g.prototype,"QPResource.ActivityGroup");var m=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.TASK)},n}(n);e.TaskGroup=m,__reflect(m.prototype,"QPResource.TaskGroup");var D=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.sharedInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.load=function(){e.prototype.load.call(this,t.USER_INFO)},n}(n);e.UserInfoGroup=D,__reflect(D.prototype,"QPResource.UserInfoGroup")}(QPResource||(QPResource={}));var QPResource;!function(e){var t=function(){function t(){}return t.sharedInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.isLoadedSuccessful?[2]:this.isLoading?[2]:(this.isLoading=!0,[4,this.loadOtherMusics()]);case 1:return e.sent(),[4,this.loadGameOverImages()];case 2:return e.sent(),[4,this.loadMailImages()];case 3:return e.sent(),[4,this.loadPackageImages()];case 4:return e.sent(),[4,this.loadPlayGameImages()];case 5:return e.sent(),[4,this.loadRoomImages()];case 6:return e.sent(),[4,this.loadSettingsImages()];case 7:return e.sent(),[4,this.loadStoreImages()];case 8:return e.sent(),[4,this.loadActivityImages()];case 9:return e.sent(),[4,this.loadTaskImages()];case 10:return e.sent(),[4,this.loadUserInfoImages()];case 11:return e.sent(),[4,function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.isLoading=!1,this.isLoadedSuccessful=!0,[2]})})}];case 12:return e.sent(),[2]}})})},t.prototype.getLoadGroupFailedError=function(){return new Error("游戏资源加载失败")},t.prototype.loadOtherMusics=function(){var t=this;return new Promise(function(n,a){e.OtherMusicGroup.sharedInstance().loadCompleteHandler=function(e){n(e)},e.OtherMusicGroup.sharedInstance().loadFailedHandler=function(e){a(t.getLoadGroupFailedError())},e.OtherMusicGroup.sharedInstance().load()})},t.prototype.loadGameOverImages=function(){var t=this;return new Promise(function(n,a){e.GameOverGroup.sharedInstance().loadCompleteHandler=function(e){n(e)},e.GameOverGroup.sharedInstance().loadFailedHandler=function(e){a(t.getLoadGroupFailedError())},e.GameOverGroup.sharedInstance().load()})},t.prototype.loadMailImages=function(){var t=this;return new Promise(function(n,a){e.MailGroup.sharedInstance().loadCompleteHandler=function(e){n(e)},e.MailGroup.sharedInstance().loadFailedHandler=function(e){a(t.getLoadGroupFailedError())},e.MailGroup.sharedInstance().load()})},t.prototype.loadPackageImages=function(){var t=this;return new Promise(function(n,a){e.PackageGroup.sharedInstance().loadCompleteHandler=function(e){n(e)},e.PackageGroup.sharedInstance().loadFailedHandler=function(e){a(t.getLoadGroupFailedError())},e.PackageGroup.sharedInstance().load()})},t.prototype.loadPlayGameImages=function(){var t=this;return new Promise(function(n,a){e.PlayGameGroup.sharedInstance().loadCompleteHandler=function(e){n(e)},e.PlayGameGroup.sharedInstance().loadFailedHandler=function(e){a(t.getLoadGroupFailedError())},e.PlayGameGroup.sharedInstance().load()})},t.prototype.loadRoomImages=function(){var t=this;return new Promise(function(n,a){e.RoomGroup.sharedInstance().loadCompleteHandler=function(e){n(e)},e.RoomGroup.sharedInstance().loadFailedHandler=function(e){a(t.getLoadGroupFailedError())},e.RoomGroup.sharedInstance().load()})},t.prototype.loadSettingsImages=function(){var t=this;return new Promise(function(n,a){e.SettingsGroup.sharedInstance().loadCompleteHandler=function(e){n(e)},e.SettingsGroup.sharedInstance().loadFailedHandler=function(e){a(t.getLoadGroupFailedError())},e.SettingsGroup.sharedInstance().load()})},t.prototype.loadStoreImages=function(){var t=this;return new Promise(function(n,a){e.StoreGroup.sharedInstance().loadCompleteHandler=function(e){n(e)},e.StoreGroup.sharedInstance().loadFailedHandler=function(e){a(t.getLoadGroupFailedError())},e.StoreGroup.sharedInstance().load()})},t.prototype.loadActivityImages=function(){var t=this;return new Promise(function(n,a){e.ActivityGroup.sharedInstance().loadCompleteHandler=function(e){n(e)},e.ActivityGroup.sharedInstance().loadFailedHandler=function(e){a(t.getLoadGroupFailedError())},e.ActivityGroup.sharedInstance().load()})},t.prototype.loadTaskImages=function(){var t=this;return new Promise(function(n,a){e.TaskGroup.sharedInstance().loadCompleteHandler=function(e){n(e)},e.TaskGroup.sharedInstance().loadFailedHandler=function(e){a(t.getLoadGroupFailedError())},e.TaskGroup.sharedInstance().load()})},t.prototype.loadUserInfoImages=function(){var t=this;return new Promise(function(n,a){e.UserInfoGroup.sharedInstance().loadCompleteHandler=function(e){n(e)},e.UserInfoGroup.sharedInstance().loadFailedHandler=function(e){a(t.getLoadGroupFailedError())},e.UserInfoGroup.sharedInstance().load()})},t}();e.AsyncLoader=t,__reflect(t.prototype,"QPResource.AsyncLoader")}(QPResource||(QPResource={}));